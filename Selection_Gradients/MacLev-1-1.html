<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Adaptive Geometry and Resource Competition: One Species, One Resource</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Lee Worden prototype research website" />
        <link rel="canonical" href="/Selection_Gradients/MacLev-1-1.html/" />

        <!-- Custom CSS -->
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/main.css">
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/auto-generated-from-ww.css">
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/wmd.css">
        <script type="text/x-mathjax-config">MathJax.Hub.Config({ jax: ["input/MathML", "output/HTML-CSS"] });</script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script>

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/adaptive-dynamics-research/">Lee Worden research prototype website</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/adaptive-dynamics-research/about">About</a>
	<a class="page-link" href="/adaptive-dynamics-research/projects">Projects</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Adaptive Geometry and Resource Competition: One Species, One Resource</h1>
  </header>

  <article class="post-content">
  <p>This page investigates the adaptive dynamics of <a href="MacLev.html">the Macarthur-Levins resource competition model</a> in the special case of one species and one resource.</p>

<ul>
  <li>See <a href="MacLev.html">Selection Gradients/MacLev.html</a> for the general model, and the adaptive dynamics formulation we’re using here, including the specific questions about the <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> and <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> of the Lotka-Volterra framework.</li>
</ul>

<p>Before we do evolution, we start by defining the basic population dynamics.  Here I’m just going to consider one population and one resource.  This configuration is well suited to visualizing in two-dimensional plots.</p>

<p><!-- maclev-1-1.sage.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclev-1-1.sage.step</span></legend><div class="ww-collapsible-content"><pre># requires: maclevmodels.py $(SageDynamics)/dynamicalsystems.py
# requires: $(SageAdaptiveDynamics)/adaptivedynamics.py
# requires: $(SageUtils)/latex_output.py
# produces: maclev-1-1.sobj maclev-1-1.sage.out.tex
from sage.all import * 
from sage.misc.latex import _latex_file_

import os
import sys
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
from maclevmodels import *
from latex_output import *

ltx = latex_output( 'maclev-1-1.sage.out.tex' )

# now that I've defined the general resource-competition model, let's
# create a 1-resource, 1-population instantiation to work with
rescomp = ResourceCompetitionModel(x_indices=[0], r_indices=[0])

ltx.write( 'The original resource competition system:' )
ltx.write_block( rescomp )

#print 'rescomp bindings:', rescomp._bindings

# now, we make the reduced system by putting the resources on a fast timescale
maclev = MacArthurLevinsModel(rescomp)

ltx.write( &quot;And the Mac-Lev system derived from it: &quot; )
ltx.write_block( maclev )

ltx.close()

save_session('maclev-1-1')
</pre></div></fieldset></p>

<p>The model equations, according to Sage:
<!-- maclev-1-1.sage.out.html --><div class="latexml">

<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<div id="p1" class="ltx_para">
<p class="ltx_p">The original resource competition system:</p>
<table id="S0.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tr id="S0.Ex1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1X.m2" class="ltx_Math" alttext="\displaystyle\frac{dR_{0}}{dt}" display="inline"><mstyle displaystyle="true"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mstyle></math>
            </td>
<td class="ltx_td ltx_align_left ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1X.m3" class="ltx_Math" alttext="\displaystyle=-X_{0}{c}_{00}+{\left(K_{0}-R_{0}\right)}r_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>-</mo><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub></mrow></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>-</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>r</mi><mn>0</mn></msub></mrow></mrow></mrow></math>
            </td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S0.Ex1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1Xa.m2" class="ltx_Math" alttext="\displaystyle\frac{dX_{0}}{dt}" display="inline"><mstyle displaystyle="true"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mstyle></math>
            </td>
<td class="ltx_td ltx_align_left ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1Xa.m3" class="ltx_Math" alttext="\displaystyle={\left(R_{0}{c}_{00}w_{0}-m_{0}\right)}X_{0}b_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><mo>-</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mn>0</mn></msub></mrow></mrow></math>
            </td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
<p class="ltx_p">And the Mac-Lev system derived from it:</p>
<table id="S0.Ex2" class="ltx_equationgroup ltx_eqn_table">

<tr id="S0.Ex2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex2X.m2" class="ltx_Math" alttext="\displaystyle\frac{dX_{0}}{dt}" display="inline"><mstyle displaystyle="true"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mstyle></math>
            </td>
<td class="ltx_td ltx_align_left ltx_eqn_cell">
              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex2X.m3" class="ltx_Math" alttext="\displaystyle=-{\left(\frac{{\left(X_{0}{c}_{00}-K_{0}r_{0}\right)}{c}_{00}w_{%
0}}{r_{0}}+m_{0}\right)}X_{0}b_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><mrow><mo>(</mo><mrow><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub></mrow><mo>-</mo><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>r</mi><mn>0</mn></msub></mrow></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mstyle><mo>+</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mn>0</mn></msub></mrow></mrow></mrow></math>
            </td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 16 15:31:38 2015 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

</div>
</p>

<h2 id="adaptive-dynamics-of-uniq-ww-650899434-qinu">Adaptive dynamics of <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span></h2>

<p><!-- maclev-1-1-adap.sage.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclev-1-1-adap.sage.step</span></legend><div class="ww-collapsible-content"><pre># requires: maclevmodels.py $(SageAdaptiveDynamics)/adaptivedynamics.py maclev-1-1.sobj
# requires: $(SageUtils)/latex_output.py
# produces: maclev-1-1-adap.sage.out.tex maclev-1-1-adap.sobj
# produces: maclev-1-1-c.png maclev-1-1-X.png maclev-1-1-ak.png
# produces: maclev-1-1-R.png maclev-1-1-a.png maclev-1-1-k.png
# produces: maclev-1-1-R.svg maclev-1-1-a.svg maclev-1-1-k.svg maclev-1-1-c.svg
from sage.all import *
from sage.misc.latex import _latex_file_
from sage.misc.latex import latex
latex.add_to_preamble('\\usepackage{amsmath}')

import os
import sys
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
sys.path.append( os.environ['SageAdaptiveDynamics'] )
from maclevmodels import *
from adaptivedynamics import *
from latex_output import *

# create variables with custom latex names because load_session
# creates them wrong
# http://trac.sagemath.org/ticket/17559
for x in ('X_0', 'X_i', 'R_0'): hat(SR.symbol(x))
SR.symbol( 'c_0_0', latex_name='c_{00}' )
SR.symbol( 'c_i_0', latex_name='c_{i0}' )

load_session('maclev-1-1')

ltx = latex_output( 'maclev-1-1-adap.sage.out.tex' )

u_indexer = indexer('u')
u_0 = u_indexer[0]

evol_c_bindings = Bindings( reduce( operator.add, (
    [ ( rescomp._indexers['c'][i][0], u_indexer[i] ),
      ( rescomp._indexers['b'][i], 1 ),
      ( rescomp._indexers['m'][i], 1 )
    ] for i in (0,1) ) ) )

maclev_adap = AdaptiveDynamicsModel(maclev,
    [ indexer('u') ], early_bindings=evol_c_bindings )

print 'when c_00 == u, the adaptive dynamics is ', maclev_adap

ltx.write( 'Adaptive dynamics of the Mac-Lev model with $b_i=m_i=1$ and $c_{i0} = u_i$:' )
ltx.write_block( maclev_adap )

numeric_params = Bindings(
  { SR.var('r_0'): 1, SR.var('w_0'): 1,
    SR.var('K_0'): 2, SR.var('gamma'): 1 } )
maclev_adap_bound = maclev_adap.bind( numeric_params )

ltx.write( 'and the bound adaptive dynamics is:', latex( maclev_adap_bound ) )

ltx.write( 'its bindings:', latex(maclev_adap_bound._bindings) )
initial_u = 2/3
c_evolution = maclev_adap_bound.solve( [initial_u], end_time=10 )

# and plot. 
t = maclev_adap.time_variable()
c_evolution.plot( t, u_indexer[0], 'maclev-1-1-c.png', ymin=0, ylabel='$c_{00}$', figsize=(4,4) )
c_evolution.plot( t, u_indexer[0], 'maclev-1-1-c.svg', ymin=0, ylabel='$c_{11}$', figsize=(2,2) )
# Xhat increases.
Xhat = hat( maclev_adap_bound._popdyn_model._population_indexer[0] )
c_evolution.plot( t, evol_c_bindings( maclev_adap_bound._bindings( Xhat ) ), &quot;maclev-1-1-X.png&quot;, ylabel=Xhat, figsize=(4,4) )
Rhat = hat( maclev_adap_bound._popdyn_model._rescomp_model._indexers['R'][0] )
c_evolution.plot( t, evol_c_bindings( maclev_adap_bound._bindings( Rhat ) ), &quot;maclev-1-1-R.svg&quot;, figsize=(2,2), ymin=0, ylabel='$\hat{R}_1$' )
c_evolution.plot( t, evol_c_bindings( maclev_adap_bound._bindings( Rhat ) ), &quot;maclev-1-1-R.png&quot;, figsize=(4,4), ymin=0, ylabel=Rhat )
# and let's also plot k_0 vs. a_00.
# these are the coefficients if you rewrite the maclev dynamics
# as dX_0/dt = X_0(k_0 + a_00 X_0)
# and why not get sage to do that, rather than type in the definitions
X_0 = maclev._population_indexer[0]
rhsc = maclev._flow[X_0].collect(X_0)
k_0 = rhsc.coeff(X_0,1)
a_00 = rhsc.coeff(X_0,2)
ltx.write( 'With and without these bindings, the Lotka-Volterra coefficients $k_0$ and $a_{00}$ are:' )
ltx.write_equality( SR.var('k_0'), k_0, numeric_params( maclev_adap_bound._early_bindings(k_0)) )
ltx.write_equality( SR.var('a_0_0', latex_name='a_{00}' ), a_00, numeric_params( maclev_adap_bound._early_bindings(a_00) ) )

ltx.write( 'And the equilibrium values $\\hat X$ and $\\hat R$:',
    '\\begin{align*}\n  \\hat X_0 &amp;\\to ',
    latex( maclev_adap_bound._equilibrium( Xhat ).expand() ), ' = ',
    latex( maclev_adap_bound._bindings( Xhat ).expand() ), '\\\\\n',
    '  \\hat R_0 &amp;\\to ',
    latex( maclev_adap_bound._equilibrium( maclev_adap_bound._popdyn_model._bindings( Rhat ) ).expand() ), ' = ',
    latex( maclev_adap_bound._bindings( Rhat ).expand() ), '\n',
    '\\end{align*}\n' )

c_evolution.plot( t, maclev_adap_bound._early_bindings( k_0 ), &quot;maclev-1-1-k.svg&quot;,
  ymin=0, ylabel='$k_1$', figsize=(2,2) )
c_evolution.plot( t, maclev_adap_bound._early_bindings( k_0 ), &quot;maclev-1-1-k.png&quot;,
  figsize=(4,4) )

c_evolution.plot( t, maclev_adap_bound._early_bindings( a_00 ), &quot;maclev-1-1-a.svg&quot;,
  ymax=0, ylabel='$a_{11}$', figsize=(2,2) )
c_evolution.plot( t, maclev_adap_bound._early_bindings( a_00 ), &quot;maclev-1-1-a.png&quot;,
  ymax=0, ylabel='$a_{11}$', figsize=(4,4) )

c_evolution.plot( maclev_adap_bound._early_bindings( a_00 ), maclev_adap_bound._early_bindings( k_0 ), &quot;maclev-1-1-ak.png&quot;,
  xlabel = SR.var('a_00'), ylabel = SR.var('k_0'), figsize=(4,4) )

ltx.close()

save_session('maclev-1-1-adap')
</pre></div></fieldset></p>

<p>Here we derive the adaptive dynamics equations when it is the uptake rate <!-- 2dc91e5ea1cbefaa8b6bd0283740e409.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}" display="inline"><msub><mi>c</mi><mn>00</mn></msub></math></span> that is evolving – that is, when <!-- 85c55c2c9819efb5a66ffafad5606797.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}(u)=u" display="inline"><mrow><mrow><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi>u</mi></mrow></math></span>, <!-- 4d8a4767fa9713181473bbc7e6dfdfe7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{0}=1" display="inline"><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow></math></span>, and <!-- 295d1f86eb1d5ac5826608957e7e0287.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{0}=1" display="inline"><mrow><msub><mi>m</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow></math></span>; and then we bind the remaining parameters to get a realization of the system that we can integrate and plot.</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Selection_Gradients › maclev-1-1-adap.sage.out.html</p>
</fieldset>
<!-- maclev-1-1-adap.sage.out.html --></p>

<p>With these parameters, the uptake rate <!-- 2dc91e5ea1cbefaa8b6bd0283740e409.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}" display="inline"><msub><mi>c</mi><mn>00</mn></msub></math></span> (<!-- d4654b9516ea31be9cd95943df29de65.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=u_{0}" display="inline"><mrow><mi/><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub></mrow></math></span>) increases as long as it starts above <!-- 3f1c9116ba5757f453c1fbcc794dba5b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{1}{2}" display="inline"><mfrac><mn>1</mn><mn>2</mn></mfrac></math></span>.  This is the only relevant range, because it has to be above <!-- 3f1c9116ba5757f453c1fbcc794dba5b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{1}{2}" display="inline"><mfrac><mn>1</mn><mn>2</mn></mfrac></math></span> in order for the population to be viable (<!-- 99e05329778a22be8c75e911ef51a466.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{X}_{0}&gt;0" display="inline"><mrow><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub><mo>&gt;</mo><mn>0</mn></mrow></math></span>).</p>

<p><!-- maclev-1-1-c.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-c.png" alt="(maclev-1-1-c.png)"/></p>

<p>The equilibrium population size <!-- 531ed82f16b552615cbeff4cf2aed200.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{X}_{0}" display="inline"><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></math></span> increases to 1 and then decreases.</p>

<p><!-- maclev-1-1-X.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-X.png" alt="(maclev-1-1-X.png)"/></p>

<p>The availability of the resource <!-- a1d6f1f309c3acc66d588a4f71c7c586.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{R}_{0}" display="inline"><msub><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></math></span> decreases.</p>

<p><!-- maclev-1-1-R.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-R.png" alt="(maclev-1-1-R.png)"/></p>

<p>And the Lotka-Volterra coefficients <!-- 3a3a31c01221cd0fa25152cb1c38f56c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{0}" display="inline"><msub><mi>k</mi><mn>0</mn></msub></math></span>, <!-- 21499c607b0bf430a565a95753cf9158.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{00}" display="inline"><msub><mi>a</mi><mn>00</mn></msub></math></span> both move away from zero.  Since <!-- 21499c607b0bf430a565a95753cf9158.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{00}" display="inline"><msub><mi>a</mi><mn>00</mn></msub></math></span> is negative, this indicates an intensification of competition.</p>

<p><!-- maclev-1-1-k.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-k.png" alt="(maclev-1-1-k.png)"/></p>

<p><!-- maclev-1-1-a.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-a.png" alt="(maclev-1-1-a.png)"/></p>

<p><!-- maclev-1-1-ak.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-ak.png" alt="(maclev-1-1-ak.png)"/></p>

<h2 id="adaptive-dynamics-of-uniq-ww-1141935900-qinu-and-uniq-ww-1886977640-qinu">Adaptive dynamics of <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> and <!-- 6f8f57715090da2632453988d9a1501b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m" display="inline"><mi>m</mi></math></span></h2>

<p><!-- maclev-1-1-mc-adap-geom.sage.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclev-1-1-mc-adap-geom.sage.step</span></legend><div class="ww-collapsible-content"><pre># requires: maclevmodels.py $(SageAdaptiveDynamics)/adaptivedynamics.py maclev-1-1-adap.sobj
# requires: $(SageUtils)/latex_output.py
# produces: maclev-1-1-mc-adap-geom.sobj maclev-1-1-mc.png maclev-1-1-mc-adap-geom.sage.out.tex
from sage.all import *

import os
import sys
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
sys.path.append( os.environ['SageAdaptiveDynamics'] )

from maclevmodels import *
from adaptivedynamics import *
from latex_output import *

from sage.symbolic.function_factory import function

load_session(&quot;maclev-1-1-adap&quot;)

# Notes: whoo, boy, I need to abstract out more of this and make this
# file simpler!

ltx = latex_output( 'maclev-1-1-mc-adap-geom.sage.out.tex' )

# Now: project the p vector into two dimensions, for the 1-species
# model (e.g. plot b_1 and c_11).  Plot the curve defined by p(u) (for
# one-dimensional u), together with S(p) and the projection of S(p) onto
# the curve.

# This is the adaptive dynamics of unconstrained p, and its rhs is gamma X S(p)
maclev_p = MacArthurLevinsModel( x_indices = [0], r_indices = [0] )

maclev_adap_p = AdaptiveDynamicsModel( maclev_p,
    [ indexer('b'), indexer('m'), indexer(lambda i:'c_%s_0'%i) ])

b_0, m_0, c_0_0 = SR.var('b_0 m_0 c_0_0')
p = vector( (b_0, m_0, c_0_0) )

p_symb = SR.var( 'p', latex_name='\mathbf p' )
S_symb = function( 'S', print_latex_func=lambda f, v : r'\mathbf S(%s)' % latex(v) )

# now we recast b_0, m_0, c_0_0 to be functions of u_0, the phenotype

change_p_to_functions = Bindings( { 'c_0_0':function('c_0')(u_0), 'm_0':function('m')(u_0), 'b_0':function('b')(u_0) } )

flow_p_func = vector( change_p_to_functions(maclev_adap_p._flow[v]) for v in p )
p_func = vector( change_p_to_functions(v) for v in p )
#dp_du = diff(p_func, u_0)
#print 'dp/du =', dp_du

pf_symb = function( 'p', print_latex_func=lambda f, v : r'\mathbf p(%s)' % latex(v) )
#ltx.write( 'Now we change these 3 characters to be functions of $u$:\n\\[ ',
#  latex( pf_symb( u_0 ) ), ' = ',
#  latex( column_vector( p_func ) ), ', \\]\n',
#  '\\[ ', latex( S_symb( pf_symb( u_0 ) ) ), ' = ',
#  latex( column_vector( flow_p_func ) ), ' \\]\n' )

#print 'S(u) =', (S_p_func.dot_product(dp_du))

# Now the version with p constrained to (0, 0, u)
#identity(x) = x
#const_one(x) = 1
maclev_c00 = MacArthurLevinsModel( x_indices = [0], r_indices = [0],
       b = indexer(lambda i: 1),
       m = indexer(lambda i: 1),
       c = indexer(lambda i: indexer(lambda l: 'u_%s'%i)) )

#ltx.write( 'maclev_c00:' )
#ltx.write_block( maclev_c00 )

maclev_adap_c00 = AdaptiveDynamicsModel(maclev_c00, 
    [ indexer('u') ])

#ltx.write( 'Returning to the adaptive dynamics, with $c_0(u_0)=u_0$, $b(u_0) = m(u_0) = 1$:' )
#ltx.write_block( maclev_adap_c00 )

maclev_adap_c00_bound = maclev_adap_c00.bind( Bindings( 
  { SR.var('r_0'): 1, SR.var('w_0'): 1,
    SR.var('K_0'): 2, SR.var('gamma'): 1 } ) )

#ltx.write( 'And with parameters bound:' )
#ltx.write_block( maclev_adap_c00_bound )

c00_evolution = maclev_adap_c00_bound.solve( [2] )

c00_bindings = c00_evolution._system._bindings.merge( FunctionBindings( {
    function('c_0'):u_0.function(u_0), function('m'):SR('1').function(u_0), function('b'):SR('1').function(u_0) } ) )

flow_p_bound = vector( (c00_bindings(s_i) for s_i in flow_p_func) )

S_p = vector( maclev_adap_p._S[ pi ] for pi in p )

#ltx.write( 'c00_bindings is ', latex( c00_bindings ) )

ltx.write( 'With $c_{00}=u_0$, the vector $\mathbf p$ is ' )
ltx.write_equality(  p_symb, column_vector( p ),
  column_vector( c00_bindings( change_p_to_functions( pi ) ) for pi in p ) )
ltx.write( 'And the selection gradient of $\mathbf p$ is ' )
ltx.write_equality( S_symb( p_symb ),
  column_vector( S_p ),
  column_vector( c00_bindings( change_p_to_functions( si ) ) for si in S_p ) )

#ltx.write( 'And with these bindings,\n\\[ ',
#  latex( S_symb( pf_symb( u_0 ) ) ),
#  ' = ', latex( column_vector( flow_p_bound ) ), ' \\]\n' )

dp_du_bound = vector( (diff(c00_bindings(p_i),u_0) for p_i in p_func) )

ltx.write( 'The derivative of $\mathbf p$ is \n\\[\n  ',
  '\\frac{d%s}{d%s}' % ( latex( p_symb ), latex( u_0 ) ), ' = ',
  latex( column_vector( dp_du_bound ) ), ', \\]\n' )
ltx.write( 'and we can recover the motion of $u_0$: \n\\[ ',
  latex( S_symb( u_0 ) ),
  ' = \\frac{d%s}{d%s}^\mathrm{T} %s = ' % ( latex(p_symb), latex(u_0), latex( S_symb( pf_symb( u_0 ) ) ) ),
  latex( c00_bindings( change_p_to_functions( dp_du_bound.dot_product( S_p ) ) ) ), ' \\]\n' )
ltx.write_equality( wrap_latex( '\\frac{du_0}{dt}' ),
  wrap_latex( '\\gamma\\hat X_0 %s' %  latex( S_symb( u_0 ) ) ),
  latex( c00_bindings( change_p_to_functions( SR('gamma') * X_0 * dp_du_bound.dot_product( S_p ) ) ) ) )

ltx.write( 'and the motion of $\\mathbf p(u_0)$:' )
ltx.write_equality( wrap_latex( '\\frac{d\\mathbf p(u_0)}{dt}' ),
  wrap_latex( '\\gamma\\hat X_0 \\frac{d\\mathbf p}{du_0} \\frac{d\\mathbf p}{du_0}^\\mathrm{T} %s' %  latex( S_symb( pf_symb( u_0 ) ) ) ),
  latex( column_vector( c00_bindings( change_p_to_functions( z ) ) for z in SR('gamma') * X_0 * dp_du_bound * dp_du_bound.dot_product( S_p ) ) ) );

# OK, so that seems to be right, so we ought to be able to plot S(p)
# and the actual motion of p on the constraint curve defined by p(u),
# on the b-c plane (letting m be fixed).
 
#mc_points = c00_evolution.plot( c00_bindings(p_func[1]), c00_bindings(p_func[2]),
#  xlabel='m_0', ylabel='c_{00}' )
initcond_bindings = Bindings( {u_0: initial_u} )
p_0 = vector( (initcond_bindings(c00_bindings(p_i)) for p_i in p_func) )
flow_p_0 = vector( (initcond_bindings(f_i) for f_i in flow_p_bound) )

ltx.write( 'So now we can get a look at the geometry of $%s$.' % latex( p_symb ),
  '  At $u_0=', latex(initial_u), '$,\n\\[ ',
  latex( p_symb ), ' = ', latex( column_vector( p_0 ) ), ', \\]\n\\[ ',
  latex( S_symb( p_symb ) ), ' = ', latex( column_vector( initcond_bindings( c00_bindings( change_p_to_functions( si ) ) ) for si in S_p ) ), ' \\]\n' )

if 1:
    flow_p_arrow = arrow( (p_0[1], p_0[2]), (p_0[1]+flow_p_0[1], p_0[2]+flow_p_0[2]),
      color=(1,0,0), width=1 )
    p_func_bound = vector( (c00_bindings(f) for f in p_func) )
    ltx.write( 'The constraint curve for $%s$:' % latex( pf_symb( u_0 ) ),
      ' is \n\\[ ', latex( column_vector( p_func ) ), ' = ',
       latex( column_vector( p_func_bound ) ), ' \\]\n' )
    mc_constraint = parametric_plot( (p_func_bound[1], p_func_bound[2]),
      (u_0, initial_u - 0.25, initial_u + 1.5) )
    dp_du_0 = vector( (initcond_bindings(d_i) for d_i in dp_du_bound) )
    du_dt_0 = initcond_bindings(c00_bindings( maclev_adap_c00._flow[u_0] ) )
    dp_dt_0 = vector( (initcond_bindings(c00_bindings(
      d_i*du_dt_0 )) for d_i in dp_du_0) )
    ltx.write( 'And on that curve, \n\\[ ',
      '\\left.\\frac{d%s}{dt}\\right|_{u_0=%s} = ' % ( latex( pf_symb( u_0 ) ), latex( initial_u ) ),
      latex( column_vector( dp_dt_0 ) ), ' \\]\n' )
    dp_dt_arrow = arrow( (p_0[1], p_0[2]), (p_0[1]+dp_dt_0[1], p_0[2]+dp_dt_0[2]),
      width=1 )
    # The arrow heads may not look like they're at the same y position but they are
    mc_geom = flow_p_arrow + mc_constraint + dp_dt_arrow # + mc_points
    mc_geom.set_axes_range( 0, 2, initial_u - 0.25, initial_u + 1.75 )
    mc_geom.axes_labels( ['$m_0$', '$c_{00}$'] )
    save(mc_geom, filename=&quot;maclev-1-1-mc.png&quot;, figsize=(4,4))

ltx.close()

save_session(&quot;maclev-1-1-mc-adap-geom&quot;)
</pre></div></fieldset></p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Selection_Gradients › maclev-1-1-mc-adap-geom.sage.out.html</p>
</fieldset>
<!-- maclev-1-1-mc-adap-geom.sage.out.html --></p>

<p>And here in the graphics is the part I really care about: the geometry of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> and <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span>.  Starting with <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span>.</p>

<p>Here we see the evolution of <!-- 2dc91e5ea1cbefaa8b6bd0283740e409.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}" display="inline"><msub><mi>c</mi><mn>00</mn></msub></math></span>, which gets smaller, and <!-- fed1e4775925bd3f7af0c5d8fc47e4e6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{0}" display="inline"><msub><mi>m</mi><mn>0</mn></msub></math></span>, which is constant.  Sticking to two dimensions, we don’t plot <!-- 2e426000b92cfbc7286b0e2cc2a37482.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{0}" display="inline"><msub><mi>b</mi><mn>0</mn></msub></math></span>, which is also constant.  We already knew what these three things do when we only allow <!-- 2dc91e5ea1cbefaa8b6bd0283740e409.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}" display="inline"><msub><mi>c</mi><mn>00</mn></msub></math></span> to change, which is what we’re doing here.  But here we can see it in a different way.  The red arrow is the relevant two dimensions of <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐩</mi><mo stretchy="false">)</mo></mrow></mrow></math></span>, and the blue arrow is the same view of <!-- 927bccc708f571e64f37a409ea0b8b5c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{p}}{dt}=\frac{\partial\mathbf{p}}{\partial u}\frac{du}{dt}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>𝐩</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐩</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>u</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></mrow></math></span>.</p>

<p>The red arrow shows how <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> “would like to evolve” if all its components were allowed to change, and the blue arrow how it actually does evolve when constrained to the vertical line <!-- 295d1f86eb1d5ac5826608957e7e0287.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{0}=1" display="inline"><mrow><msub><mi>m</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow></math></span>.  The red arrow is equal to the blue arrow plus another vector (not shown) perpendicular to the blue one.  That is, the blue arrow is the ‘‘projection’’ of the red one onto the vertical line that is the constraint curve defined by the mapping <!-- da109c3726736f5ab63a1798c610b316.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}=\mathbf{p}(u)" display="inline"><mrow><mi>𝐩</mi><mo>=</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span>.</p>

<p><!-- maclev-1-1-mc.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-mc.png" alt="(maclev-1-1-mc.png)"/></p>

<h2 id="adaptive-dynamics-of-uniq-ww-206797433-qinu-and-uniq-ww-2006972429-qinu">Adaptive dynamics of <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> and <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span></h2>

<p><!-- maclev-1-1-ak-adap-geom.sage.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclev-1-1-ak-adap-geom.sage.step</span></legend><div class="ww-collapsible-content"><pre># requires: maclevmodels.py maclev-1-1-mc-adap-geom.sobj
# requires: $(SageUtils)/latex_output.py
# produces: maclev-1-1-ak-adap-geom.png maclev-1-1-ak-adap-geom.sage.out.tex
from sage.all import *
from sage.misc.latex import _latex_file_
from sage.misc.latex import latex

import os
import sys
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
sys.path.append( os.environ['SageAdaptiveDynamics'] )

from maclevmodels import *
from adaptivedynamics import *
from lotkavolterra import *
from latex_output import *

# create variables with custom latex names because load_session
# creates them wrong
# http://trac.sagemath.org/ticket/17559
for x in ('X_0', 'X_i', 'R_0'): hat(SR.symbol(x))
SR.symbol( 'c_0_0', latex_name='c_{00}' )
SR.symbol( 'c_i_0', latex_name='c_{i0}' )

load_session(&quot;maclev-1-1-mc-adap-geom&quot;)

ltx = latex_output( 'maclev-1-1-ak-adap-geom.sage.out.tex' )

# and now: do the same for the A vector.  For this, plot S(A), the projection
# of S(A) onto the curve, the indirect effect of evolution, and the resultant
# motion, which is not generally restricted to the curve because of the
# indirect component.

maclev_adap_lv = LotkaVolterraAdaptiveDynamics( maclev_adap_bound, r_name='k' )

ltx.write( 'As before, the adaptive dynamics of $u$ is' )
ltx.write_equality( wrap_latex('\\mathbf S' + latex( maclev_adap_lv.A(0) )),
    maclev_adap_lv.S( maclev_adap_lv.A(0) ),
    maclev_adap_lv._lv_model.interior_equilibrium_bindings()( maclev_adap_lv.S( maclev_adap_lv.A(0) ) ) )
ltx.write_block( maclev_adap_lv._adaptivedynamics )

save_session( 'maclev-1-1-ak-adap-geom' )
ltx.close()
exit()

# Here is the Lotka-Volterra population model we will use, with one population,
# with simple parameters a_ij, k_i
maclev_lv = GeneralizedLotkaVolterraModel( [0], r = indexer('k') )

ltx.write( &quot;Abstract Lotka-Volterra model corresponding to the 1-population Mac-Lev model:&quot; )
ltx.write_block( maclev_adap_lv )

# Here is the adaptive dynamics of the Lotka-Volterra model
# We get the general S(A) using this unparametrized lv system; we'll add
# the dependence on u later
maclev_adap_lv = AdaptiveDynamicsModel( maclev_lv,
  [ indexer('k'), indexer(lambda i: 'a_%s_0'%i) ] )

A = cvector( ( SR.var('a_0_0'), SR.var('k_0') ) )
S_A = A.apply_map( lambda a: maclev_adap_lv._S[a] )

#print 'adaptive dynamics of %s:\n' % A, maclev_adap_lv
#print 'S_A:', S_A

#ltx.write( 'Generating the adaptive dynamics of $a$ and $k$:\n\\begin{quote}\n',
#    maclev_adap_lv._debug_output._output._str, '\n\\end{quote}\n' )

# now we derive the values of the L-V coefficients k_i and a_ij 
# from the mac-lev dynamics.

# this only works for a single variable - it would have to be more
# sophisticated to find the coefficients of multiple X's.  but it works
# fine with just X_0 and X_0^2.

def get_coeff( expr, vars, power ):
    for c, p in expr.coefficients( vars ):
        if p == power:
            return c

# Here is the population dynamics, with parameters as a function of u.
maclev_p_ij = MacArthurLevinsModel( x_indices = ['i','j'], r_indices = [0],
  b = indexer(lambda i:'b(u_%s)'%i),
  m = indexer(lambda i:'m(u_%s)'%i),
  c = indexer(lambda i: indexer(lambda l: function('c_%s'%l)(SR('u_%s'%i)) ) ) )

lvi = maclev_p_ij._flow[SR('X_i')].expand()
#ltx.write( 'In the $i,j$ LV system\n\\[ \\frac{dX_i}{dt} = ', latex(lvi), ' \\]\n\n' );

from sage.symbolic.function_factory import function
af = function('a')
kf = function ('k')
A_bindings = FunctionBindings(
  { af: get_coeff( get_coeff( lvi, SR('X_i'), 1), SR('X_j'), 1).function(SR('u_i'), SR('u_j')),
    kf: get_coeff( get_coeff( lvi, SR('X_i'), 1), SR('X_j'), 0).function(SR('u_i')) } )

# now do the adaptive dynamics with a, k bound to
# specific functions of u

# first make a L.V. model with a, k as functions of u
maclev_lv_u = GeneralizedLotkaVolterraModel( [0],
  r = indexer(lambda i: kf(SR('u_%s'%i))),
  a = indexer(lambda i: indexer(lambda j: af(SR('u_%s'%i),SR('u_%s'%j)))) )

#ltx.write( 'now with $a$ and $k$ as functions of $u$:' )
#ltx.write_block( maclev_lv_u )

#ltx.write( 'with coefficients:' )
#ltx.write_block( A_bindings )

# then bind a, k to specific functions of u, to be precise, with
# c_0i = u_i, b_i = m_1 = 1
maclev_lv = maclev_lv_u.bind( A_bindings )
#ltx.write( 'becomes:' )
#ltx.write_block( maclev_lv )

#ltx.write( '(a 2-variable system would be ' )
#ltx.write_block( GeneralizedLotkaVolterraModel( [0, 1],
#  k = indexer(lambda i:'k(u_%s)'%i),
#  a = indexer(lambda i: indexer(lambda j: 'a(u_%s,u_%s)'%(i,j))),
#  bindings = A_bindings ) )
#ltx.write( ')... ' )

maclev_lv_c00 = maclev_lv.bind( FunctionBindings( {
    function('c_0'): u_0.function(u_0),
    function('b'): symbolic_expression('1').function(u_0),
    function('m'): symbolic_expression('1').function(u_0) } ) )

ltx.write( 'Now we bind $c, m, b$:' )
ltx.write_block( maclev_lv_c00 )
ltx.write( 'maclev_lv_c00._bindings:' )
ltx.write_block( maclev_lv_c00._bindings )

# assign constant values to the rest of the parameters
maclev_lv_c00_bound = maclev_lv_c00.bind( Bindings( 
  { SR.var('r_0'): 1, SR.var('w_0'): 1,
    SR.var('K_0'): 2, SR.var('gamma'): 1 } ) )

ltx.write( 'With all the bindings works out to:' )
ltx.write_block( maclev_lv_c00_bound )

# and derive the adaptive dynamics of u_0 under those assumptions,
# i.e. the adaptive dynamics of c_00 with all else held fixed.
maclev_adap_lv_c00_bound = AdaptiveDynamicsModel( maclev_lv_c00_bound,
  [ indexer('u') ], bindings = Bindings( gamma=1 ) )

#ltx.write( 'Generating the adaptive dynamics of $u$:\n\\begin{quote}\n',
#    maclev_adap_lv_c00_bound._debug_output._output._str, '\n\\end{quote}\n' )

ltx.write( 'As before, the adaptive dynamics of $u$ is' )
ltx.write_equality( wrap_latex('\\mathbf S' + latex( cvector( [ u_j for u_j in maclev_adap_lv_c00_bound._S.keys() ] ) ) ),
            cvector( [ dI_duj for dI_duj in maclev_adap_lv_c00_bound._S.values() ] ) )
ltx.write_block( maclev_adap_lv_c00_bound )

ltx.write( 'and' )
ltx.write_equality( X_0, maclev_adap_lv_c00_bound._bindings( X_0 ) )

# Initial condition for the adaptive dynamics of u_0
initcond_bindings = Bindings({u_0: initial_u})

# integrate the adaptive dynamics and get a numeric trajectory
lv_c00_evolution = maclev_adap_lv_c00_bound.solve( [initcond_bindings(u_0)] )

c00_bindings = maclev_adap_lv_c00_bound._bindings
#print 'c00_bindings:', c00_bindings

A_u = cvector( [ symbolic_expression('a(u_0,u_0)'), symbolic_expression('k(u_0)') ] )
A_u_binding = Bindings( a_0_0 = 'a(u_0,u_0)', k_0 = 'k(u_0)' )
S_A_u = S_A.apply_map( lambda s : A_u_binding(s) )
A_bound = A_u.apply_map( lambda a : c00_bindings(a) )
S_A_bound = S_A_u.apply_map( lambda s : c00_bindings(s) )
ltx.write( 'And now we can compare the different vector derivatives...' )
ltx.write_equality( SR('A'), A_u, A_bound )
ltx.write_equality( SR('S(A)'), S_A_u, S_A_bound )

A_0 = A_u.apply_map( lambda a : initcond_bindings(c00_bindings(a)) )
S_A_0 = S_A_u.apply_map( lambda s : initcond_bindings(c00_bindings(s)) )

A_c00 = c00_bindings(A_u)
#ltx.write_equality( SR('A(u_0,u_0)'), A_c00 )

# dA/du is different from the projection of S(A) into the first variable.
dA_du_bound = diff(A_c00,u_0)
dA_du_0 = initcond_bindings(dA_du_bound)

# now the direct and indirect parts.
# until I improve the AdaptiveDynamicsModel class, I have to redo some of
# what it does here.
maclev_u_ij = MacArthurLevinsModel(
  x_indices=['i','j'], r_indices=[0],
  b = indexer(lambda i:'b(u_%s)'%i),
  m = indexer(lambda i:'m(u_%s)'%i),
  c = indexer(lambda i: indexer(lambda l: function('c_%s'%l)(SR('u_%s'%i)))) )
X_i = SR.var('X_i')
X_j = SR.var('X_j')
f_j = maclev_u_ij._flow[X_j].collect(X_i)
#print 'f_i:', f_i
# there are better ways to do this, involving multivariate coefficients
f_over = limit((f_j/X_j).collect(X_i), X_j=0)
#print 'f_i/X_i:', f_over
A_j = cvector( [ f_over.coeff(X_i,1), f_over.coeff(X_i,0) ] )
A_j = c00_bindings( A_j )
#v = SR.var('v')
#A_i = A_i.apply_map( lambda a : a.substitute( { SR.var('u_i') : v } ) )
u_0 = SR.var('u_0')
u_i = SR.var('u_i')
u_j = SR.var('u_j')

ltx.write_equality( SR('A_j(u_i,u_j)'), A_j )

#ltx.write_equality( SR('A_0(u_0,u_0)'), A_j.substitute( { u_i: u_0, u_j: u_0 } ) )

# So that's A.  Now we can plot its derivatives.

# first d1A = first partial of A
d1A = diff(A_j,u_j).substitute( { u_i: u_0, u_j: u_0 } )
ltx.write( 'So' )
ltx.write_equality( wrap_latex('\\partial_1\mathbf A(u_i,u_j)'), d1A )

# now d2A = second partial
d2A = diff(A_j,u_i).substitute( { u_i: u_0, u_j: u_0 } )
ltx.write_equality( wrap_latex('\\partial_2\mathbf A(u_i,u_j)'), d2A )

#ltx.write_equality( wrap_latex('\\partial_1\mathbf A \\partial_1\mathbf A^T'), (dAdv * dAdv.transpose()) )

d1ATS = ( d1A.transpose() * S_A_bound ).apply_map( lambda i : i.rational_simplify() )
ltx.write_equality( wrap_latex('\\partial_1\mathbf A^T S(A)'), d1ATS )

ltx.write( 'so' )

ltx.write_equality( wrap_latex('\\partial_1\mathbf A\\partial_1\mathbf A^T S(\mathbf A)'), d1A * d1ATS )

d1A_curve = A_j.substitute( { u_j : initial_u } )
#ltx.write( 'and the mysterious curve (for $v\in[%s,%s]$) is' %(initial_u-2,initial_u+2) )
#ltx.write_block( d1A_curve )
 
d1A_constraint = parametric_plot( (d1A_curve[0], d1A_curve[1]),
  (u_i, initial_u-2, initial_u+2), color='green' )
#dAdv   = dAdv.substitute({u_0: initial_u, v: initial_u})
#dAdu_0 = dAdu_0.substitute({u_0: initial_u, v: initial_u})

#ltx.write( 'dA(v,u_0)/dv:\n' )
#ltx.write_block( dAdv )
#ltx.write( 'dA(v,u_0)/du_0:\n' )
#ltx.write_block( dAdu_0 )

dAdt_unconstrained = A.apply_map( lambda a :  c00_bindings(maclev_adap_lv._flow[a].substitute({SR.var('a_0_0'):A_0[0][0], SR.var('k_0'):A_0[1][0]})) )

gX = c00_bindings(SR('gamma * X_0'))
D = gX * d1A * d1ATS
D = D.apply_map( lambda d : d.rational_simplify() )

ltx.write( 'thus' )
ltx.write_equality( wrap_latex('\\gamma \hat X_0'), gX )
ltx.write_equality( SR('D'), wrap_latex('\\gamma X_0 \\partial_1 \mathbf A \\partial_1 \mathbf A^T S(\mathbf A)'), D )

#I_circle = gX * dAdv * dAdu_0.transpose() * S_A_bound

#ltx.write( 'I_circle(%g) ='%initial_u )
#ltx.write_equality( wrap_latex('I^\circ'), wrap_latex('\\gamma X_0 \\frac{\\partial A}{\\partial v}\\frac{\\partial A}{\\partial u_0}^T S(A)'), I_circle )

I = gX * d2A * d1ATS
I = I.apply_map( lambda i : i.rational_simplify() )

ltx.write_equality( SR.var('I'), wrap_latex('\\gamma X_0 \\partial_2 \mathbf A \\partial_1 \mathbf A^T S(\\mathbf A)'), I )

ltx.write_equality( wrap_latex('D + I'), (D+I).apply_map( lambda di : di.rational_simplify() ) )
ltx.write( &quot;and to check, &quot; )
ltx.write( 'the total derivative of $A$ is ' )
ltx.write_equality( wrap_latex('\\frac{dA(u_0,u_0)}{du_0}'), dA_du_bound )

dudt = maclev_adap_c00_bound._flow[u_0]

ltx.write( 'and' )
ltx.write_equality( wrap_latex('\\frac{du_0}{dt}'), dudt )
ltx.write( 'so that' )
ltx.write_equality( wrap_latex('\\frac{dA}{dt}'),
  wrap_latex('\\frac{dA(u_0,u_0)}{du_0}\\frac{du_0}{dt}'),
  dA_du_bound * dudt )

dudt_0 = initcond_bindings(maclev_adap_c00_bound._flow[u_0])
dA_du_0c = dA_du_0.transpose()
#ltx.write( 'dudt_0 =' )
#ltx.write_block( dudt_0 )
#ltx.write( 'dA_du_0 =' )
#ltx.write_block( dA_du_0c )

dAdt_constrained = dA_du_0c * dudt_0
#ltx.write( 'and dAdt_constrained =' )
#ltx.write_block( dAdt_constrained )

def arrow_from_cvectors(tail, length, **kargs):
    return arrow( (tail[0][0], tail[1][0]),
        (tail[0][0] + length[0][0], tail[1][0] + length[1][0]), **kargs)

if 1:
    ak_points = lv_c00_evolution.plot( c00_bindings(A_u[0][0]), c00_bindings(A_u[1][0]),
      xlabel='a_{00}', ylabel='k_0', color='black' )
    S_A_arrow = arrow_from_cvectors( A_0, dAdt_unconstrained,
      color='red', width=1 )
    ak_constraint = plot( (A_c00[0][0], A_c00[1][0]),
      (u_0,initial_u-0.5,initial_u+0.5), color='light blue' )
    D_arrow = arrow_from_cvectors( initcond_bindings( c00_bindings( A_0 ) ), initcond_bindings( c00_bindings( D ) ), color='green', width=1 )
    I_arrow = arrow_from_cvectors( initcond_bindings( c00_bindings( A_0 + D ) ), initcond_bindings( c00_bindings( I ) ), color='purple', width=1 )
    dA_du_arrow = arrow_from_cvectors( A_0, initcond_bindings( c00_bindings( dA_du_bound * dudt ) ), color='blue', width=1 )
    ak_geom = ak_points + dA_du_arrow + S_A_arrow + d1A_constraint + D_arrow + I_arrow
    # + ak_constraint
    ak_geom.set_axes_range( -8, 3, -2, 7 )
    ak_geom.axes_labels( ['$a_{00}$', '$k_0$'] )
    save(ak_geom, filename=&quot;maclev-1-1-ak-adap-geom.png&quot;, figsize=(4,4))

ltx.close()

</pre></div></fieldset></p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Selection_Gradients › maclev-1-1-ak-adap-geom.sage.out.html</p>
</fieldset>
<!-- maclev-1-1-ak-adap-geom.sage.out.html --></p>

<p>This is a work in progress.</p>

<p>This figure includes <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> (red) and <!-- 2ffe8c4753de6a9c633cec0d781be686.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dA}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>A</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span> (blue), but also the projection of <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> onto the constraint curve <!-- f80c4501d8be08264d3c1970fbd23dbe.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="A(u,u_{0})" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><msub><mi>u</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> – the “direct effect”, that is (green) – and the “indirect effect”, which is the terms (purple) that combine with the direct effect to give <!-- 2ffe8c4753de6a9c633cec0d781be686.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dA}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>A</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>.  The direct effect expresses how the population is “tempted” to change, and the indirect effect expresses the “unintended consequences” of that change.</p>

<p><!-- maclev-1-1-ak-adap-geom.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-ak-adap-geom.png" alt="(maclev-1-1-ak-adap-geom.png)"/></p>

<h2 id="biological-meaning-of-these-quantities">Biological meaning of these quantities</h2>

<h3 id="the-interaction-terms-uniq-ww-912768311-qinu">The interaction terms, <!-- 7fc56270e7a70fa81a5935b72eacbe29.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="A" display="inline"><mi>A</mi></math></span></h3>

<p>We made this model by using an equilibrium resource quantity</p>

<p><!-- 828760954161a6cd83b7f8c118793c9a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\hat{R}_{0}={\color{%&#10;orange}K_{0}}-{\color{green}\frac{c_{00}X_{0}}{r_{0}}}" display="inline"><mrow><msub><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub><mo>=</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo>-</mo><mfrac mathcolor="#00FF00"><mrow><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><mo mathcolor="#00FF00">⁢</mo><msub><mi mathcolor="#00FF00">X</mi><mn mathcolor="#00FF00">0</mn></msub></mrow><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mrow></mrow></math></span></p>

<p>given population size <!-- 7204a8dfdb61b3496295b04c057e337d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{0}" display="inline"><msub><mi>X</mi><mn>0</mn></msub></math></span>.</p>

<p>Here <!-- 1d645e9e415a68c792848c1b14343766.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\color{orange}K_{0}" display="inline"><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub></math></span> is the resource “set point” - the level it’ll return to if consumption stops - and <!-- 2cf49cc0949700b6187a5bd3e8cbfd58.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\color{green}\frac{c_{0%&#10;0}X_{0}}{r_{0}}" display="inline"><mfrac mathcolor="#00FF00"><mrow><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><mo mathcolor="#00FF00">⁢</mo><msub><mi mathcolor="#00FF00">X</mi><mn mathcolor="#00FF00">0</mn></msub></mrow><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></math></span> is the “draw-down” of the resource - the amount removed to bring <!-- e1e1d3d40573127e9ee0480caf1283d6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R" display="inline"><mi>R</mi></math></span> to the level where replacement and consumption balance.</p>

<p>The population dynamics is</p>

<p><!-- 7ef0bc6ca18355cf4cede3b429b6e656.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{0}}{dt}=(b_{0}c_{00}w_{0}R_{0}-b_{0}m_{0})X_{0}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>-</mo><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow></mrow></math></span>,</p>

<p>with a growth term driven by resource availability and a constant per-capita mortality term.</p>

<p>So after we substitute <!-- 1220c92303040391dee4a5e620a69608.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{0}\to\hat{R}_{0}" display="inline"><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>→</mo><msub><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></mrow></math></span> and partition out the linear and quadratic terms to make <!-- 21499c607b0bf430a565a95753cf9158.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{00}" display="inline"><msub><mi>a</mi><mn>00</mn></msub></math></span> and <!-- 3a3a31c01221cd0fa25152cb1c38f56c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{0}" display="inline"><msub><mi>k</mi><mn>0</mn></msub></math></span>, we have</p>

<p><!-- 7941c774bf43d1a2f7174a8f4d987a67.tex-inline.latexml.html --><!-- 1 matches --><span class="latexml latexml-inline"><div id="p1" class="ltx_para"><table id="S0.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table"><tr id="S0.Ex1" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1.m1" class="ltx_Math" alttext="\displaystyle\frac{dX_{0}}{dt}" display="inline"><mstyle displaystyle="true"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mstyle></math>            </td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1.m2" class="ltx_Math" alttext="\displaystyle=({\color{purple}b_{0}c_{00}w_{0}}R_{0}-{\color{red}b_{0}m_{0}})X%_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi>R</mi><mn>0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr><tr id="S0.Ex2" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell"></td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex2.m2" class="ltx_Math" alttext="\displaystyle=({\color{purple}b_{0}c_{00}w_{0}}({\color{orange}K_{0}}-{\color{%green}\frac{c_{00}X_{0}}{r_{0}}})-{\color{red}b_{0}m_{0}})X_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo>-</mo><mstyle displaystyle="true"><mfrac mathcolor="#00FF00"><mrow><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><mo mathcolor="#00FF00">⁢</mo><msub><mi mathcolor="#00FF00">X</mi><mn mathcolor="#00FF00">0</mn></msub></mrow><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mstyle></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr><tr id="S0.Ex3" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell"></td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex3.m2" class="ltx_Math" alttext="\displaystyle={\color{purple}b_{0}c_{00}w_{0}\color{orange}K_{0}}X_{0}-{\color%{red}b_{0}m_{0}}X_{0}-{\color{purple}b_{0}c_{00}w_{0}\color{green}\frac{c_{00}%}{r_{0}}}X_{0}^{2}." display="inline"><mrow><mrow><mi></mi><mo>=</mo><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi>X</mi><mn>0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><mstyle displaystyle="true"><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mstyle><mo>⁢</mo><msubsup><mi>X</mi><mn>0</mn><mn>2</mn></msubsup></mrow></mrow></mrow><mo>.</mo></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr></table></div></span></p>

<p>So in a nutshell,</p>

<p><!-- 08c2b562334035b0842f2d43139c50a4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}k_{0}={\color{purple}b_%&#10;{0}c_{00}w_{0}\color{orange}K_{0}}-{\color{red}b_{0}m_{0}}" display="inline"><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub></mrow></mrow></mrow></math></span></p>

<p>is what the net reproduction rate ‘‘would be’’ if <!-- e1e1d3d40573127e9ee0480caf1283d6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R" display="inline"><mi>R</mi></math></span> were at its set point, and</p>

<p><!-- 28a66eeebc4cdd6a0ff5fdd6beb85cb1.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}a_{00}=-{\color{purple}%&#10;b_{0}c_{00}w_{0}\color{green}\frac{c_{00}}{r_{0}}}" display="inline"><mrow><msub><mi>a</mi><mn>00</mn></msub><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mrow></mrow></mrow></math></span></p>

<p>encompasses the loss of reproduction due to draw-down of <!-- e1e1d3d40573127e9ee0480caf1283d6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R" display="inline"><mi>R</mi></math></span>.</p>

<p>The agent-patient distinction is that we consider the fitness of population 0 (as patient) in the environment created by population 0 (as agent).  Adaptive dynamics is driven by the difference of fitness as the patient population varies while the agent population stays fixed.  So the green <!-- 0b6dd3847a64d1b154169a3ca11e4c81.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\color{green}c_{00}" display="inline"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub></math></span> in the  expression for <!-- b4e777192af4fc8d8d8e472a5ade47e9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{R}" display="inline"><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover></math></span> is the agent population’s consumption rate - it shows up in <!-- 21499c607b0bf430a565a95753cf9158.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{00}" display="inline"><msub><mi>a</mi><mn>00</mn></msub></math></span> - and the purple <!-- 55d136fbe96265458e316b1be40a5f72.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\color{purple}b_{0}c_{00}" display="inline"><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub></mrow></math></span> and red <!-- d0c2443d7c1aba56cab64aabd884dcf8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\color{red}b_{0}m_{0}" display="inline"><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub></mrow></math></span> in the <!-- 02129bb861061d1a052c592e2dc6b383.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X" display="inline"><mi>X</mi></math></span> equation - the other population parameters in <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> and <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> - are the patient population’s characteristics.</p>

<p>To summarize: the interaction vector <!-- 7fc56270e7a70fa81a5935b72eacbe29.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="A" display="inline"><mi>A</mi></math></span> is</p>

<p><!-- 9df77b61902af1c30b595fba01d8bd6d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}A=\left(\begin{array}[]%&#10;{c}a_{00}\\&#10;k_{0}\end{array}\right)=\left(\begin{array}[]{c}-{\color{purple}b_{0}c_{00}w_{%&#10;0}\color{green}\frac{c_{00}}{r_{0}}}\\&#10;{\color{purple}b_{0}c_{00}w_{0}\color{orange}K_{0}}-{\color{red}b_{0}m_{0}}%&#10;\end{array}\right)." display="inline"><mrow><mrow><mi>A</mi><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><msub><mi>a</mi><mn>00</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><msub><mi>k</mi><mn>0</mn></msub></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mn mathcolor="#FF0000">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math></span></p>

<h3 id="the-selection-gradient-uniq-ww-236491576-qinu">The selection gradient <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span></h3>

<p>Any evolvable traits of this population must be expressed in its ecological parameters <!-- 2e426000b92cfbc7286b0e2cc2a37482.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{0}" display="inline"><msub><mi>b</mi><mn>0</mn></msub></math></span>, <!-- 2dc91e5ea1cbefaa8b6bd0283740e409.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{00}" display="inline"><msub><mi>c</mi><mn>00</mn></msub></math></span>, and <!-- fed1e4775925bd3f7af0c5d8fc47e4e6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{0}" display="inline"><msub><mi>m</mi><mn>0</mn></msub></math></span>.  Under the adaptive dynamics assumptions, selection occurs through the marginal reproductive fitness of a variant invader population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> in the resident population <!-- cfcd208495d565ef66e7dff9f98764da.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="0" display="inline"><mn>0</mn></math></span>’s environment.  That works out to mean the fitness conferred by the variant’s <!-- 92eb5ffee6ae2fec3ad71c777531578f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b" display="inline"><mi>b</mi></math></span>, <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span>, and <!-- 6f8f57715090da2632453988d9a1501b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m" display="inline"><mi>m</mi></math></span>, when <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> is the ‘‘patient’’ in the environment of ‘‘agent’’ <!-- cfcd208495d565ef66e7dff9f98764da.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="0" display="inline"><mn>0</mn></math></span>: the derivative of</p>

<p><!-- 17191916d1e7284999a6e18028778901.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}=k_{i}+a_{i0}\hat{X}_{0}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">ℐ</mi><mo>=</mo><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>+</mo><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></mrow></mrow></mrow></math></span></p>

<p><!-- fc03f8a6bdbf60b2685263f80e495bc7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}=({\color{purple}b_{i}c%&#10;_{i0}w_{0}\color{orange}K_{0}}-{\color{red}b_{i}m_{i}})-{\color{purple}b_{i}c_%&#10;{i0}w_{0}\color{green}\frac{c_{00}}{r_{0}}}\hat{X}_{0}" display="inline"><mrow><mi/><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi mathcolor="#BF0040">b</mi><mi mathcolor="#BF0040">i</mi></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mrow><mi mathcolor="#BF0040">i</mi><mo mathcolor="#BF0040">⁢</mo><mn mathcolor="#BF0040">0</mn></mrow></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub></mrow><mo>-</mo><mrow><msub><mi mathcolor="#FF0000">b</mi><mi mathcolor="#FF0000">i</mi></msub><mo>⁢</mo><msub><mi mathcolor="#FF0000">m</mi><mi mathcolor="#FF0000">i</mi></msub></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>-</mo><mrow><msub><mi mathcolor="#BF0040">b</mi><mi mathcolor="#BF0040">i</mi></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">c</mi><mrow><mi mathcolor="#BF0040">i</mi><mo mathcolor="#BF0040">⁢</mo><mn mathcolor="#BF0040">0</mn></mrow></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub><mo>⁢</mo><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></mrow></mrow></mrow></math></span></p>

<p>with respect to the characteristics of population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>.</p>

<p>Because we want to keep track of <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> and <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span>, we take that (partial) derivative in two steps: the derivative of <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic">ℐ</mi></math></span> with respect to <!-- bb1ba35bb2ff22641f8a89b5b849e34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{i0}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub></math></span> and <!-- 34c1d173d638ceb8fb5bec184c055549.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}" display="inline"><msub><mi>k</mi><mi>i</mi></msub></math></span>, and then the derivative of those with respect to <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e5cc57cec95cd03f3683e540fe76b1d3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i0}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub></math></span> and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span>.</p>

<p>The derivatives of <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic">ℐ</mi></math></span> with respect to <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> and <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> is the interaction selection gradient <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span>, and its value is simple and depends not at all on the specifics of the model:</p>

<p><!-- 521403104c0ce315d854aaad34dbb274.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)=\left(\begin{array}[]{c}\frac{\partial\mathcal{I}}{\partial a_{i0}}\\&#10;\frac{\partial\mathcal{I}}{\partial k_{i}}\end{array}\right)=\left(\begin{%&#10;array}[]{c}\hat{X}_{0}\\&#10;1\end{array}\right)." display="inline"><mrow><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></mtd></mtr><mtr><mtd columnalign="center"><mn>1</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>.</mo></mrow></math></span></p>

<p>Actually we can write the equilibrium population size directly without regard to what <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> and <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> are:</p>

<p><!-- 4546342c872feb39814e1902e7149835.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{X}_{0}=-\frac{k_{0}}{a_{00}}" display="inline"><mrow><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub><mo>=</mo><mrow><mo>-</mo><mfrac><msub><mi>k</mi><mn>0</mn></msub><msub><mi>a</mi><mn>00</mn></msub></mfrac></mrow></mrow></math></span>.</p>

<ul>
  <li>Let’s digress for a moment: it follows from this that the vector field <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> in a one-population LV model is always the same, no matter what the model is.  It looks like this:</li>
</ul>

<p><!-- S-A-vector-field.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/S-A-vector-field.png" alt="(S-A-vector-field.png)"/></p>

<p>But maybe it’s helpful to expand out the value of <!-- 7b8fdbd005969fe03d91103943b26b63.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{X}_{0}" display="inline"><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></math></span>?</p>

<p><!-- 13ce85117e947e7339930cfd2d7abd77.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}\hat{X}_{0}=(\color{%&#10;orange}K_{0}-\frac{\color{red}m_{0}}{\color{purple}c_{00}w_{0}})\color{green}%&#10;\frac{r_{0}}{c_{00}}" display="inline"><mrow><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub><mo>=</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo mathcolor="#FF8000">-</mo><mfrac mathcolor="#FF8000"><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub><mrow><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo mathcolor="#FF8000">⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub></mrow></mfrac></mrow><mo mathcolor="#FF8000" stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub></mfrac></mrow></mrow></math></span>.</p>

<p>Anyway, it’s directly proportional to the population’s growth rate in a sterile world, and inversely proportional to the drawdown: the more <!-- 02129bb861061d1a052c592e2dc6b383.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X" display="inline"><mi>X</mi></math></span> draws down the resource at equilibrium, the smaller <!-- 02129bb861061d1a052c592e2dc6b383.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X" display="inline"><mi>X</mi></math></span> is.</p>

<p>[And while we’re at it:</p>

<p><!-- df82c6244a054934d1092226e74c6d52.tex-inline.latexml.html --><!-- 1 matches --><span class="latexml latexml-inline"><div id="p1" class="ltx_para"><table id="S0.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table"><tr id="S0.Ex1" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1.m1" class="ltx_Math" alttext="\displaystyle\hat{R}_{0}" display="inline"><msub><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></math>            </td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex1.m2" class="ltx_Math" alttext="\displaystyle={\color{orange}K_{0}}-{\color{green}\frac{c_{00}}{r_{0}}}\hat{X}%_{0}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo>-</mo><mrow><mstyle displaystyle="true"><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mstyle><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub></mrow></mrow></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr><tr id="S0.Ex2" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell"></td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex2.m2" class="ltx_Math" alttext="\displaystyle={\color{orange}K_{0}}-{\color{green}\frac{c_{00}}{r_{0}}}(\color%{orange}K_{0}-\frac{\color{red}m_{0}}{\color{purple}c_{00}w_{0}})\color{green}%\frac{r_{0}}{c_{00}}" display="inline"><mrow><mi></mi><mo>=</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo>-</mo><mrow><mstyle displaystyle="true"><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub></mfrac></mstyle><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi mathcolor="#FF8000">K</mi><mn mathcolor="#FF8000">0</mn></msub><mo mathcolor="#FF8000">-</mo><mstyle displaystyle="true"><mfrac mathcolor="#FF8000"><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub><mrow><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo mathcolor="#FF8000">⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub></mrow></mfrac></mstyle></mrow><mo mathcolor="#FF8000" stretchy="false">)</mo></mrow><mo>⁢</mo><mstyle displaystyle="true"><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub></mfrac></mstyle></mrow></mrow></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr><tr id="S0.Ex3" class="ltx_equation ltx_eqn_row ltx_align_baseline"><td class="ltx_eqn_cell ltx_eqn_center_padleft"></td><td class="ltx_td ltx_align_right ltx_eqn_cell"></td><td class="ltx_td ltx_align_left ltx_eqn_cell">              <math xmlns="http://www.w3.org/1998/Math/MathML" id="S0.Ex3.m2" class="ltx_Math" alttext="\displaystyle=\frac{\color{red}m_{0}}{\color{purple}c_{00}w_{0}}.]" display="inline"><mrow><mo>=</mo><mstyle displaystyle="true"><mfrac><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub><mrow><msub><mi mathcolor="#BF0040">c</mi><mn mathcolor="#BF0040">00</mn></msub><mo>⁢</mo><msub><mi mathcolor="#BF0040">w</mi><mn mathcolor="#BF0040">0</mn></msub></mrow></mfrac></mstyle><mo>.</mo><mo stretchy="false">]</mo></mrow></math>            </td><td class="ltx_eqn_cell ltx_eqn_center_padright"></td></tr></table></div></span></p>

<p>For reference, the expanded-out value of the gradient is</p>

<p><!-- 9525c1e171d1361fe567c0eda1a7f90e.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)=\left(\begin{array}[]{c}(\color{orange}K_{0}-\frac{\color{red}m_{0}}{%&#10;\color{purple}c_{00}w_{0}})\color{green}\frac{r_{0}}{c_{00}}\\&#10;1\end{array}\right)" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi mathcolor="#000000">K</mi><mn mathcolor="#000000">0</mn></msub><mo mathcolor="#000000">-</mo><mfrac mathcolor="#000000"><msub><mi mathcolor="#FF0000">m</mi><mn mathcolor="#FF0000">0</mn></msub><mrow><msub><mi mathcolor="#000000">c</mi><mn mathcolor="#000000">00</mn></msub><mo mathcolor="#000000">⁢</mo><msub><mi mathcolor="#000000">w</mi><mn mathcolor="#000000">0</mn></msub></mrow></mfrac></mrow><mo mathcolor="#000000" stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac mathcolor="#00FF00"><msub><mi mathcolor="#00FF00">r</mi><mn mathcolor="#00FF00">0</mn></msub><msub><mi mathcolor="#00FF00">c</mi><mn mathcolor="#00FF00">00</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>1</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>.</p>

<h3 id="the-direct-effect">The direct effect</h3>

<p>The direct effect,</p>

<p><!-- 4d25220f04c366e0141ef9521c450c4b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D=\gamma\hat{X}_{i}\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})\partial_{1}%&#10;\mathbf{A}_{i}(\mathbf{u}_{i})^{T}S(\mathbf{A}_{i})" display="inline"><mrow><mi>D</mi><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span>,</p>

<p>is the selection gradient vector projected on to the constrained available direction of motion.  Since <!-- 1aa10bbbd7d32221f9c0ae3847505823.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})^{T}S(\mathbf{A}_{i})" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> is a scalar (it’s the dot product of <!-- c52240dc05470f0e0f9657b2c4b87cee.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> and <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>), the vector <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> is a multiple of <!-- c52240dc05470f0e0f9657b2c4b87cee.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>, which is the direction that <!-- 7fc56270e7a70fa81a5935b72eacbe29.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="A" display="inline"><mi>A</mi></math></span> can change by varying the invading population (the patient) and holding the resident (agent) fixed.</p>

<p>[Mathematical note: Since <!-- 062dacdd01eb1c0545792ec0112a4120.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})^{T}" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></math></span> isn’t necessarily unit-length, this isn’t necessarily the exactly the projection of <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> onto the line generated by <!-- c52240dc05470f0e0f9657b2c4b87cee.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi>𝐀</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>, but it’s a multiple of it.  This reflects the relationship between <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> and <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span>.  The selection gradient is a description of how <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span> would move if it were mutating directly, and the projection is a description of how it moves when it’s <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> that mutates.  If <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span> changes a lot in response to a small change in <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span>, the projected vector <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> will be longer, and if it only changes a little per change in <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span>, <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> will be shorter.]</p>

<p>Let’s examine <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> more closely in the Mac-Lev model.</p>

<p>To review, the interaction vector (or whatever we call it) is
<fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Selection_Gradients › avec.sage.out.html</p>
</fieldset>
<!-- avec.sage.out.html -->
but to get the adaptive dynamics right we have to distinguish agents from patients: the terms of this are
<fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Selection_Gradients › a-careful.sage.out.html</p>
</fieldset>
<!-- a-careful.sage.out.html -->
and indexes <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and <!-- 363b122c528f54df4a0446b6bab05515.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline"><mi>j</mi></math></span> are the patient and agent, respectively, even if they’re both 0 in this simple example, and we need to keep them straight in order to get the first and second partial derivatives.</p>

<p>Here we only need the first partial, the derivative with respect to the patient.</p>

<p>The derivatives with respect to <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e5cc57cec95cd03f3683e540fe76b1d3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i0}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub></math></span>, and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span> are</p>

<p><!-- 5917a85cdf4111b33029ed3b01956b2b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1b}A=\left(\begin{array}[]{c}-\frac{c_{i0}c_{j0}w_{0}}{r_{0}}\\&#10;K_{0}c_{i0}w_{0}-m_{i}\end{array}\right)=\left(\begin{array}[]{c}-\frac{c_{00}%&#10;^{2}w_{0}}{r_{0}}\\&#10;K_{0}c_{00}w_{0}-m_{0}\end{array}\right)" display="inline"><mrow><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>b</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub><mo>⁢</mo><msub><mi>c</mi><mrow><mi>j</mi><mo>⁢</mo><mn>0</mn></mrow></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mn>0</mn></mrow></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><mo>-</mo><msub><mi>m</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mrow><msubsup><mi>c</mi><mn>00</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><mo>-</mo><msub><mi>m</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>,</p>

<p><!-- 0e2aabee8ed6f95c3a12d0a0d7d31b63.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1c}A=\left(\begin{array}[]{c}-\frac{b_{i}c_{j0}w_{0}}{r_{0}}\\&#10;K_{0}b_{i}w_{0}\end{array}\right)=\left(\begin{array}[]{c}-\frac{b_{0}c_{00}w_%&#10;{0}}{r_{0}}\\&#10;K_{0}b_{0}w_{0}\end{array}\right)" display="inline"><mrow><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>c</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>c</mi><mrow><mi>j</mi><mo>⁢</mo><mn>0</mn></mrow></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>,</p>

<p><!-- 56a844daa6b192aa5b4d2208c55d340f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1m}A=\left(\begin{array}[]{c}0\\&#10;-b_{i}\end{array}\right)=\left(\begin{array}[]{c}0\\&#10;-b_{0}\end{array}\right)" display="inline"><mrow><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>m</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center"><mrow><mo>-</mo><msub><mi>b</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center"><mrow><mo>-</mo><msub><mi>b</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>.</p>

<p>We’ve been focusing on varying only <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span>, so let’s keep working with that for now.  From these equations we can see that the partial derivative vector <!-- 89f1bf1c7ee41738fa81c6645e6bc751.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1c}A" display="inline"><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>c</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow></math></span> always points up and to the left (as does <!-- cc8690b38839c2e2813d3bef7135e314.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1b}A" display="inline"><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>b</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow></math></span>, while <!-- 93dda1b601715a70407db4b541306f53.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1m}A" display="inline"><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>m</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow></math></span> points straight down).</p>

<p>For the fixed values of <!-- 92eb5ffee6ae2fec3ad71c777531578f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b" display="inline"><mi>b</mi></math></span>, <!-- 6f8f57715090da2632453988d9a1501b.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m" display="inline"><mi>m</mi></math></span>, etc. that we’ve been using, the vector field <!-- ca7a4523b9d0525865ef902bc1fdefd8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1c}A" display="inline"><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>c</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow></math></span> looks like this:</p>

<p><!-- maclev-1-1-d1A-vector-field.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-d1A-vector-field.png" alt="(maclev-1-1-d1A-vector-field.png)"/></p>

<p>But actually those vectors are only meaningful at <!-- 695cb80256ba27c6020e5fb73d74acc3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="(a,k)" display="inline"><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></math></span> combinations that can actually be achieved for some value of <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span>.  Here’s <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> and <!-- 89f1bf1c7ee41738fa81c6645e6bc751.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1c}A" display="inline"><mrow><msub><mo>∂</mo><mrow><mn>1</mn><mo>⁢</mo><mi>c</mi></mrow></msub><mo>⁡</mo><mi>A</mi></mrow></math></span> on that subset of <!-- 695cb80256ba27c6020e5fb73d74acc3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="(a,k)" display="inline"><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></math></span>:</p>

<p>[ making of this disabled due to code needing to be redone ]</p>

<p><!-- maclev-1-1-S-and-d1A-on-curve.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-S-and-d1A-on-curve.png" alt="(maclev-1-1-S-and-d1A-on-curve.png)"/></p>

<p></p>

<p>The main part of <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> is</p>

<p><!-- 197cdc491ce44587d340b33a48a32338.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}A\partial_{1}A^{T}S(A)" display="inline"><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi>A</mi></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mrow><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>S</mi></mrow></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span>,</p>

<p>which is a scalar product times that green vector <!-- 6d036c820a842a281755153fea68e8c7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}A" display="inline"><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi>A</mi></mrow></math></span>.  The scalar product, for the varying-<!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> model, is</p>

<p><!-- 771f3f2726975da5790c1833e8635473.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}A^{T}S(A)=-\frac{b_{0}c_{00}w_{0}}{r_{0}}\cdot(K_{0}-\frac{m_{0}}{%&#10;c_{00}w_{0}})\frac{r_{0}}{c_{00}}+K_{0}b_{0}w_{0}\cdot 1" display="inline"><mrow><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mrow><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>S</mi></mrow></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>-</mo><mrow><mrow><mfrac><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>-</mo><mfrac><msub><mi>m</mi><mn>0</mn></msub><mrow><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mfrac><msub><mi>r</mi><mn>0</mn></msub><msub><mi>c</mi><mn>00</mn></msub></mfrac></mrow></mrow><mo>+</mo><mrow><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><mo>⋅</mo><mn>1</mn></mrow></mrow></mrow></math></span></p>

<p><!-- da5d52d7ed2c8bce33cf1da470264998.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\frac{b_{0}m_{0}}{c_{00}}" display="inline"><mrow><mi/><mo>=</mo><mfrac><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><msub><mi>c</mi><mn>00</mn></msub></mfrac></mrow></math></span>.</p>

<p>Without going too far into interpreting this quantity, we can note that it’s always positive.  Thus the projection will always be in the direction of <!-- 6d036c820a842a281755153fea68e8c7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}A" display="inline"><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi>A</mi></mrow></math></span>, not its negative.</p>

<p>So the “main part” is</p>

<p><!-- 6c68de6e7be7f5fa14183a6ae3154807.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}A\partial_{1}A^{T}S(A)=\frac{b_{0}m_{0}}{c_{00}}\left(\begin{array%&#10;}[]{c}-\frac{b_{0}c_{00}w_{0}}{r_{0}}\\&#10;K_{0}b_{0}w_{0}\end{array}\right)=b_{0}^{2}m_{0}w_{0}\left(\begin{array}[]{c}-%&#10;\frac{1}{r_{0}}\\&#10;\frac{K_{0}}{c_{00}}\end{array}\right)" display="inline"><mrow><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi>A</mi></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mrow><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>S</mi></mrow></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><msub><mi>c</mi><mn>00</mn></msub></mfrac><mo>⁢</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mrow><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>b</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>=</mo><mrow><msubsup><mi>b</mi><mn>0</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mn>1</mn><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mfrac><msub><mi>K</mi><mn>0</mn></msub><msub><mi>c</mi><mn>00</mn></msub></mfrac></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></math></span>,</p>

<p>and the full value of <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> is</p>

<p><!-- 626200c681c5ba22456ffb304d5bea47.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D=\gamma\hat{X}_{0}\partial_{1}A\partial_{1}A^{T}S(A)=\gamma(K_{0}-\frac{m_{0}%&#10;}{c_{00}w_{0}})\frac{r_{0}}{c_{00}}b_{0}^{2}m_{0}w_{0}\left(\begin{array}[]{c}%&#10;-\frac{1}{r_{0}}\\&#10;\frac{K_{0}}{c_{00}}\end{array}\right)" display="inline"><mrow><mi>D</mi><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mn>0</mn></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi>A</mi></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mrow><msup><mi>A</mi><mi>T</mi></msup><mo>⁢</mo><mi>S</mi></mrow></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>-</mo><mfrac><msub><mi>m</mi><mn>0</mn></msub><mrow><msub><mi>c</mi><mn>00</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><msub><mi>r</mi><mn>0</mn></msub><msub><mi>c</mi><mn>00</mn></msub></mfrac><mo>⁢</mo><msubsup><mi>b</mi><mn>0</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub><mo>⁢</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mfrac><mn>1</mn><msub><mi>r</mi><mn>0</mn></msub></mfrac></mrow></mtd></mtr><mtr><mtd columnalign="center"><mfrac><msub><mi>K</mi><mn>0</mn></msub><msub><mi>c</mi><mn>00</mn></msub></mfrac></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></math></span></p>

<p><!-- aaeca473912382d825813a20e4df2ba9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma(K_{0}w_{0}-\frac{m_{0}}{c_{00}})\frac{b_{0}^{2}m_{0}}{c_{00}}\left(%&#10;\begin{array}[]{c}-1\\&#10;\frac{r_{0}K_{0}}{c_{00}}\end{array}\right)" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><msub><mi>K</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><mo>-</mo><mfrac><msub><mi>m</mi><mn>0</mn></msub><msub><mi>c</mi><mn>00</mn></msub></mfrac></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><mrow><msubsup><mi>b</mi><mn>0</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><msub><mi>c</mi><mn>00</mn></msub></mfrac><mo>⁢</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><mo>-</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd columnalign="center"><mfrac><mrow><msub><mi>r</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>K</mi><mn>0</mn></msub></mrow><msub><mi>c</mi><mn>00</mn></msub></mfrac></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></math></span></p>

<p>So we know that the ‘‘direct effect’’ <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> is a vector up and to the left.</p>

<p>Big questions of interest to me are</p>

<ul>
  <li>What makes <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> - a projection of <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> - point in the direction of increasing competition: to the left, while <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> points to the right?</li>
  <li>What makes <!-- dd7536794b63bf90eccfd37f9b147d7f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="I" display="inline"><mi>I</mi></math></span> contribute more competition to what <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> is already piling on?</li>
</ul>

<p>Here are <!-- 78ef167d21d0998c6685959c2f76a780.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(A)" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> and <!-- f623e75af30e62bbd73d6df5b50bb7b5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D" display="inline"><mi>D</mi></math></span> on the <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> curve:</p>

<p><!-- maclev-1-1-S-and-D-on-curve.png --><img src="/adaptive-dynamics-research/wmd_files/Selection_Gradients/maclev-1-1-S-and-D-on-curve.png" alt="(maclev-1-1-S-and-D-on-curve.png)"/></p>

<p>I’d like to have more perspective on this, but I don’t want to get too bogged down.  Here’s what I see here at present:</p>

<ul>
  <li>Separating <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> from <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> breaks the population dynamics into 3 parts:
    <ul>
      <li>in <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span>: growth that would obtain at the maximum resource availability, and death (density-independent); and</li>
      <li>in <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span>: reduction in growth due to drawdown of the resource by the population(s).</li>
    </ul>
  </li>
  <li>Both growth terms vary directly with the consumption parameter <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span>, so that:
    <ul>
      <li>Selection increases <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> because the net growth is positive</li>
      <li>Increasing <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> increases the magnitude of <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span>.</li>
    </ul>
  </li>
  <li>This is why <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> increases, and why <!-- 8ce4b16b22b58894aa86c421e8759df3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline"><mi>k</mi></math></span> becomes more positive and <!-- 0cc175b9c0f1b6a831c399e269772661.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a" display="inline"><mi>a</mi></math></span> becomes more negative as <!-- 4a8a08f09d37b73795649038408b5f33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline"><mi>c</mi></math></span> increases.</li>
</ul>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Lee Worden</h2>

    <div class="footer-col-1 column">
      <ul>
        <li><a href="mailto:worden.lee@gmail.com">worden.lee@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/worden-lee">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">worden-lee</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/leeworden">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">leeworden</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
	    <p class="text"><!-- Any additional text --></p>
    </div>

  </div>

</footer>


    </body>
</html>
