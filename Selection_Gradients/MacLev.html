<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Adaptive Geometry of Resource Competition</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Lee Worden prototype research website" />
        <link rel="canonical" href="/Selection_Gradients/MacLev/" />

        <!-- Custom CSS -->
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/main.css">
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/auto-generated-from-ww.css">
	<link rel="stylesheet" href="/adaptive-dynamics-research/css/wmd.css">
        <script type="text/x-mathjax-config">MathJax.Hub.Config({ jax: ["input/MathML", "output/HTML-CSS"] });</script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script>

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/adaptive-dynamics-research/">Lee Worden research prototype website</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/adaptive-dynamics-research/about">About</a>
	<a class="page-link" href="/adaptive-dynamics-research/projects">Projects</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Adaptive Geometry of Resource Competition</h1>
  </header>

  <article class="post-content">
  <p>On these pages I am investigating the evolution of interactions in the MacArthur/Levins resource competition model.</p>

<p>This page explains the adaptive dynamics concepts and questions I’m using, and includes Sage source code for the models.</p>

<p>Child pages use this theory and code to investigate specific cases of the models:</p>

<ul>
  <li><a href="MacLev-1-1.html">Adaptive Geometry of Resource Competition: One Species, One Resource</a></li>
  <li><a href="MacLev-2-2.html">Adaptive Geometry of Resource Competition: Two Species, Two Resources</a></li>
</ul>

<h2 id="macarthur-levins-population-dynamics">MacArthur-Levins population dynamics</h2>

<p>We start with a population-resource model:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?e18f659f2b7ab26af53889458b6b76c3.tex-inline › e18f659f2b7ab26af53889458b6b76c3.tex-inline.latexml.html</p>
</fieldset>
<!-- e18f659f2b7ab26af53889458b6b76c3.tex-inline.latexml.html --></p>

<p>where <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span> is the density of population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>, <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> is the abundance of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span> and the parameters are <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, an intrinsic population growth rate, <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span>, mortality rate, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span>, the rate at which population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> captures resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span>, <!-- 1235855f8799d6d05eb99f4107d753b8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{\ell}" display="inline"><msub><mi>w</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, the amount a unit of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span> contributes to population growth, <!-- 2c957c70d4812dfa9765865177ed2dfd.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="r_{\ell}" display="inline"><msub><mi>r</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, the resupply rate of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span>, and <!-- 72addfe74695b542ed83e06a81124f5a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="K_{\ell}" display="inline"><msub><mi>K</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> its maximum possible abundance.</p>

<p>This is a fine model on its own, but I am interested in Lotka-Volterra models, which are models in which there is a simple number <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> describing how populations <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and <!-- 363b122c528f54df4a0446b6bab05515.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline"><mi>j</mi></math></span> interact with each other.  Using a Lotka-Volterra model will let us look at how these interaction terms <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> change, telling us how evolution drives these populations to become more competitive, antagonistic, or mutualistic.</p>

<p>In the above model the populations <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> interact indirectly by taking resources from each other, but we can make the interactions direct by making simplifying assumptions, and this is what MacArthur and Levins did.</p>

<p>We do this by assuming that the resources come to equilibrium very quickly compared to the populations.  Under this assumption, we can hold the population sizes <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span> fixed and solve the second equation above for <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> when <fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?cee469ed164f44c56672921d9feaf719.tex-math › cee469ed164f44c56672921d9feaf719.tex-math.latexml.html</p>
</fieldset>
<!-- cee469ed164f44c56672921d9feaf719.tex-math.latexml.html -->:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?5c5d91d6bfe8ac02545096c8d7540eb9.tex-inline › 5c5d91d6bfe8ac02545096c8d7540eb9.tex-inline.latexml.html</p>
</fieldset>
<!-- 5c5d91d6bfe8ac02545096c8d7540eb9.tex-inline.latexml.html --></p>

<p>Then we simply use that value of <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> in the first equation, and we have a system of population sizes only:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?022b983a7841e976921e2b4dd0bf5c01.tex-inline › 022b983a7841e976921e2b4dd0bf5c01.tex-inline.latexml.html</p>
</fieldset>
<!-- 022b983a7841e976921e2b4dd0bf5c01.tex-inline.latexml.html --></p>

<p>We can rearrange the terms of this to have the standard Lotka-Volterra form:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?d93fc6dee62c20910284cb0313a8da03.tex-inline › d93fc6dee62c20910284cb0313a8da03.tex-inline.latexml.html</p>
</fieldset>
<!-- d93fc6dee62c20910284cb0313a8da03.tex-inline.latexml.html --></p>

<p>where</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?af786bf2d330ef4a36ac504de2c48d38.tex-inline › af786bf2d330ef4a36ac504de2c48d38.tex-inline.latexml.html</p>
</fieldset>
<!-- af786bf2d330ef4a36ac504de2c48d38.tex-inline.latexml.html --></p>

<p>I’ll be interested in how the interaction terms <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> change as the populations coevolve, because this expresses whether competition becomes stronger or weaker.  When two coevolving populations compete for resources, we expect them to differentiate from each other and lessen the competition, but I’d like to look at both that and other cases, and do some detailed analysis about when it lessens and when it greatens.</p>

<h2 id="adaptive-dynamics-in-the-macarthur-levins-model">Adaptive dynamics in the Macarthur-Levins model</h2>

<p>And now here’s where we look at how that single population “evolves” in the Mac-Lev model.  I won’t review the details of how <a href="http://en.wikipedia.org/w/Evolutionary_invation_analysis">adaptive dynamics</a> is done, but in summary: suppose that certain aspects of the population dynamics depend on the characteristics of the population, and those characteristics are able to mutate.  Then over time, mutants will arise, and if they are better able to thrive in the environment they encounter than their forefathers, they will gradually replace them, and the characteristics of the population will slowly change.</p>

<p>In this model, it’s <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span>, and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span> that have to do with the populations, so we introduce a ‘‘phenotype’’ variable <!-- eb00a04135562ae6f74786f084f54327.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u_{i}" display="inline"><msub><mi>u</mi><mi>i</mi></msub></math></span> representing the characteristics of the population and suppose that <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span> and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span> are determined by the value of <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>.  Then we can find out how <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> changes in time in response to the conditions created by the population dynamics, and also how the other values such as <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span>, <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span>, <!-- 34c1d173d638ceb8fb5bec184c055549.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}" display="inline"><msub><mi>k</mi><mi>i</mi></msub></math></span>, change as <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> evolves.</p>

<p>The change in <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>, to make a long story short, is driven by how the population growth rate of a rare mutant varies with the mutant’s phenotype <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>.  That is, there’s an “invasion speed” <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic">ℐ</mi></math></span> that is closely related to the population growth rate <!-- 86b5a7e8226ee2b74185f34d3ffd018c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{i}}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>, and the change in <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> (that is, <!-- eee68d0a6be1ecbbba3e4ee86efb4d45.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{du}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>u</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>) is in proportion to <!-- 9f9f37ce4302d27f292b94f660c150d9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathcal{I}}{\partial u}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow></mfrac></math></span>.</p>

<p>To be precise:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?1fb9e7b1fe45400d41debb1dbac7ed9a.tex-inline › 1fb9e7b1fe45400d41debb1dbac7ed9a.tex-inline.latexml.html</p>
</fieldset>
<!-- 1fb9e7b1fe45400d41debb1dbac7ed9a.tex-inline.latexml.html --></p>

<p>defines the invasion speed (where <!-- 3a3ea00cfc35332cedf6e5e9a32e94da.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="E" display="inline"><mi>E</mi></math></span> is the environment that an individual population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> experiences, including the rest of population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and all other populations), and then</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?b7ea33080fe5f75b010a01b6bbb80ba3.tex-inline › b7ea33080fe5f75b010a01b6bbb80ba3.tex-inline.latexml.html</p>
</fieldset>
<!-- b7ea33080fe5f75b010a01b6bbb80ba3.tex-inline.latexml.html --></p>

<p>where <!-- ae539dfcc999c28e25a0f3ae65c1de79.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\gamma" display="inline"><mi>γ</mi></math></span> is a coefficient accounting for the frequency and size of available mutations.  In simple cases, it’s a constant, while when available mutations are not quite so simple and uniform, it may not be (as we will see).</p>

<h2 id="adaptive-geometry-of-ecological-parameters">Adaptive geometry of ecological parameters</h2>

<p>Now let’s go deeper into what happens in that evolutionary change.  We’re considering several different ways to describe the evolving population, and now I want to give them clearer notation:</p>

<ul>
  <li><!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span>, the “underlying phenotype”.  I’m going to be using a scalar <!-- eb00a04135562ae6f74786f084f54327.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u_{i}" display="inline"><msub><mi>u</mi><mi>i</mi></msub></math></span>, and in fact just one of them, so I can call it <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>, but in general it’s a vector of numbers, which is what I mean by writing it in boldface.</li>
  <li><!-- 68f37b772d10e67f44b4703b11469972.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}(\mathbf{u}_{i})=\begin{pmatrix}b_{i}(\mathbf{u}_{i})\\&#10;m_{i}(\mathbf{u}_{i})\\&#10;c_{i1}(\mathbf{u}_{i})\\&#10;\vdots\\&#10;c_{im}(\mathbf{u}_{i})\end{pmatrix}" display="inline"><mrow><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi>m</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>, the “ecological phenotype”</li>
  <li><!-- 8b47241acc8318d04c70a75c7e2d0103.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{1}),\ldots,%&#10;\mathbf{p}(\mathbf{u}_{n}))=\begin{pmatrix}k_{i}(\mathbf{p}(\mathbf{u}_{i}))\\&#10;a_{i1}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{1}))\\&#10;\vdots\\&#10;a_{in}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{n}))\end{pmatrix}" display="inline"><mrow><mrow><mi>𝐀</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr><mtr><mtd columnalign="center"><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd columnalign="center"><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>, the “interaction phenotype”</li>
</ul>

<p>These are vectors that are functions of one another.  Using a suitable vector notation in our calculus, we can write the adaptive dynamics of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> directly, ignoring the intermediate variables <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> and <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> for the moment:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?b93de29fb66674e066d5997af8a11723.tex-inline › b93de29fb66674e066d5997af8a11723.tex-inline.latexml.html</p>
</fieldset>
<!-- b93de29fb66674e066d5997af8a11723.tex-inline.latexml.html --></p>

<p>The <!-- b9ece18c950afbfa6b0fdbfa4ff731d3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="T" display="inline"><mi>T</mi></math></span> sign is for vector or matrix transposition: with the notation I’m using, <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> is a column vector - a point in a vector space of values - and <!-- d8501891973d41e3602c37e666614aaf.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathcal{I}}{\partial\mathbf{u}_{i}}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow></mfrac></math></span> is a row vector - a thing that operates on points.  Since <!-- 09bf178ed96118b8ae9b1c7a4c3230db.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{u}_{i}}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span> is a column, we need to transpose the derivative of <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic">ℐ</mi></math></span> to make it match.  The <!-- e12c3e8cad7503d41ec94f3907e448fa.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}" display="inline"><msub><mo>∂</mo><mn>1</mn></msub></math></span> sign is for the partial derivative with respect to the first argument.</p>

<p>Now we can use the chain rule to see how <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> changes:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?b09a46e6a84583c8b6d9d053a4c0422e.tex-inline › b09a46e6a84583c8b6d9d053a4c0422e.tex-inline.latexml.html</p>
</fieldset>
<!-- b09a46e6a84583c8b6d9d053a4c0422e.tex-inline.latexml.html --></p>

<p>Here we see the usefulness of this row-and-column-vector notation, because it lets us use the chain rule in a natural way: when we write <!-- c4b2b21d1241353e1596f0e4235e0ef7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{p}(\mathbf{u}_{i})}{dt}=\frac{\partial\mathbf{p}}{\partial%&#10;\mathbf{u}_{i}}\frac{d\mathbf{u}_{i}}{dt}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐩</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></mrow></math></span>, we’re multiplying a matrix by a column vector to get another column vector, in just the way we want.</p>

<p>I like to write <!-- 52757ce34005ebd7a3e836372bc98801.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{u})=\partial_{1}\mathcal{I}(\mathbf{u})^{T}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐮</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mi>𝐮</mi><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span> for the “selection gradient” of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> – the direction of increasing fitness in the space of possible <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> values.  I’m very interested in the role of this selection gradient in various spaces, as we’ll see.  Notice that in the derivation above I switched from <!-- eaec634933761e7cc1d3e3eb60ac9cd2.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{u}_{i})=\left(\frac{\partial\mathcal{I}(\mathbf{v}|\mathbf{u}_{1},%&#10;\ldots,\mathbf{u}_{n})}{\partial\mathbf{v}}\right)_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mo>(</mo><mfrac><mrow><mo>∂</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi><mrow><mo stretchy="false">(</mo><mi>𝐯</mi><mo stretchy="false">|</mo><msub><mi>𝐮</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>𝐮</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐯</mi></mrow></mfrac><mo>)</mo></mrow><mrow><mi>𝐯</mi><mo>=</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow></msub></mrow></math></span> to</p>

<p><!-- dae5e5e53e01830bcf273623e7b33ed8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p}(\mathbf{u}_{i}))=\left(\begin{array}[]{c}\frac{\partial\mathcal{I%&#10;}(\mathbf{v}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})}{\partial b(\mathbf{v})}\\&#10;\vdots\\&#10;\frac{\partial\mathcal{I}(\mathbf{v}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})}{%&#10;\partial c_{im}(\mathbf{v})}\end{array}\right)_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mo>(</mo><mtable displaystyle="true"><mtr><mtd columnalign="center"><mfrac><mrow><mo>∂</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi><mrow><mo stretchy="false">(</mo><mi>𝐯</mi><mo stretchy="false">|</mo><msub><mi>𝐮</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>𝐮</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>b</mi></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐯</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center"><mi mathvariant="normal">⋮</mi></mtd></mtr><mtr><mtd columnalign="center"><mfrac><mrow><mo>∂</mo><mi class="ltx_font_mathcaligraphic">ℐ</mi><mrow><mo stretchy="false">(</mo><mi>𝐯</mi><mo stretchy="false">|</mo><msub><mi>𝐮</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>𝐮</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi>m</mi></mrow></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐯</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mtd></mtr></mtable><mo>)</mo></mrow><mrow><mi>𝐯</mi><mo>=</mo><msub><mi>𝐮</mi><mi>i</mi></msub></mrow></msub></mrow></math></span>.
These different selection gradients are very different objects: they’re vectors expressing the direction of selection in different spaces – here, the space of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> values “vs.” the space of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> values.  Soon enough we’ll also be looking at the selection gradient in <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> space.</p>

<p>Using the above chain rule manipulations, we can write</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?c184f587c861415205ce6dab5f050529.tex-inline › c184f587c861415205ce6dab5f050529.tex-inline.latexml.html</p>
</fieldset>
<!-- c184f587c861415205ce6dab5f050529.tex-inline.latexml.html --></p>

<p>Like <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> or whatever other vector, <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> would evolve in the direction of <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐩</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> if it were to mutate in all directions equally.  However, it doesn’t do that: since <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> is a function of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span>, it only mutates in directions given by mutations in <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span>.  The matrix multiplying <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐩</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> in the dynamics of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> is a projection matrix, restricting the motion of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> to directions allowed by the mapping between <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> and <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span>.  (To be precise, <!-- 0f79fff7b9fbaa986c04a3377df1a32a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathbf{p}}{\partial\mathbf{u}}\frac{\partial\mathbf{p}}{%&#10;\partial\mathbf{u}}^{T}S(\mathbf{p})" display="inline"><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐩</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐮</mi></mrow></mfrac><mo>⁢</mo><msup><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐩</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐮</mi></mrow></mfrac><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐩</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> is not precisely the projection of <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐩</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> onto the subspace parametrized by <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> unless the columns of <!-- da7a98049c6af5c9d284ff0ce3d2eb33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathbf{p}}{\partial\mathbf{u}}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐩</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>𝐮</mi></mrow></mfrac></math></span> are unit-length; otherwise there’s some scaling by positive numbers involved.  But it definitely transforms the vector into a direction allowed by the restriction to points parametrized by <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span>.)</p>

<p>The motion of <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> is the same way, except that it is influenced by all the populations in the system, not just one, because two phenotypes are involved in each <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> value.  For that reason, the dynamics of <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> has some extra terms…</p>

<p>But before we go into that, let’s look at the selection gradient and the dynamics of <!-- 1f82f9b08ed981377ef238d2f45c514a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}(\mathbf{u})" display="inline"><mrow><mi>𝐩</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐮</mi><mo stretchy="false">)</mo></mrow></mrow></math></span>.</p>

<h2 id="adaptive-geometry-of-interaction-terms">Adaptive geometry of interaction terms</h2>

<p>Now, let’s get to how <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> and <!-- 34c1d173d638ceb8fb5bec184c055549.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}" display="inline"><msub><mi>k</mi><mi>i</mi></msub></math></span> “would like to evolve” and why they move in the directions they do.</p>

<p>Expanding out the dynamics of the <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> vector has more involved than doing it for the <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span> vector, because <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> depends on all the different phenotypes <!-- 61147e839a95b0f4bc1a65e12a116666.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{j}" display="inline"><msub><mi>𝐮</mi><mi>j</mi></msub></math></span>, not just one we’re concerned with.  Also, we have to keep careful track of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span>, because it appears in <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi>𝐀</mi></math></span> in two different ways: on the left-hand side of each <!-- dd980b2b295ad11972dc1b3314b70f4a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{a}_{ij}=a(\mathbf{u}_{i},\mathbf{u}_{j})" display="inline"><mrow><msub><mi>𝐚</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐮</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span> term, which describes how population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> (the “patient”) is affected by an encounter with population <!-- 363b122c528f54df4a0446b6bab05515.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline"><mi>j</mi></math></span> (the “agent”); and also on the right-hand side of the <!-- 07a4ca1d3386958dbb0000fd7381262e.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ii}=a(\mathbf{u}_{i},\mathbf{u}_{i})" display="inline"><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>i</mi></mrow></msub><mo>=</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span> term, as the “agent” in an encounter between <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>.  This distinction is important because every encounter has two effects, the effect on oneself and the effect on the other, and we’ll see that selection treats these two effects very differently.</p>

<p>So to be clear, we’ll work with the notation</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?373fa0a0ef70c2abf7565d7baf6d31bf.tex-inline › 373fa0a0ef70c2abf7565d7baf6d31bf.tex-inline.latexml.html</p>
</fieldset>
<!-- 373fa0a0ef70c2abf7565d7baf6d31bf.tex-inline.latexml.html --></p>

<p>to distinguish the two different roles of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> (suppressing the intermediate variable <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span>), and we’ll refer to the two different partial derivatives that relate to <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> as <fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?e741eaf2866360ca9e078fdbe941694c.tex-math › e741eaf2866360ca9e078fdbe941694c.tex-math.latexml.html</p>
</fieldset>
<!-- e741eaf2866360ca9e078fdbe941694c.tex-math.latexml.html --> and <fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?7e7f2405aff4bec1eab050324812ecd0.tex-math › 7e7f2405aff4bec1eab050324812ecd0.tex-math.latexml.html</p>
</fieldset>
<!-- 7e7f2405aff4bec1eab050324812ecd0.tex-math.latexml.html -->.</p>

<p>So first of all, if we use <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span> as an intermediate variable, the dynamics of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> is</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?bab8208baeb8827697156d0c7dd3c27d.tex-inline › bab8208baeb8827697156d0c7dd3c27d.tex-inline.latexml.html</p>
</fieldset>
<!-- bab8208baeb8827697156d0c7dd3c27d.tex-inline.latexml.html --></p>

<p>Then</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?829c5dfec8b9aa01ad016c8a7bd489d6.tex-inline › 829c5dfec8b9aa01ad016c8a7bd489d6.tex-inline.latexml.html</p>
</fieldset>
<!-- 829c5dfec8b9aa01ad016c8a7bd489d6.tex-inline.latexml.html --></p>

<p>This expression is made up of two somewhat complex terms.  The first term, the <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> term, expresses the change in the interactions experienced by population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> due to change in population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> in its patient role.  I refer to this as the <strong>direct effect</strong> of selection on population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>.  The second term, the sum of <!-- 3cd8abd42f5793e6e9880832b1b5fb45.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{j})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> vectors, expresses the change in population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>’s interactions due to change in all the different agents it encounters, including population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> itself in its agent role.  I refer to this as an <strong>indirect effect</strong> of selection on the various populations.</p>

<p>What would happen if there were no constraints on <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span>?  That is, if all the terms just mutate independently without being constrained by dependence on <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> variables.  In this case, we would simply have</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?f7289d40452af9fded333e6c4688502d.tex-inline › f7289d40452af9fded333e6c4688502d.tex-inline.latexml.html</p>
</fieldset>
<!-- f7289d40452af9fded333e6c4688502d.tex-inline.latexml.html --></p>

<p>In the constrained case, as with <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi>𝐩</mi></math></span>, the motion due to <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐀</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> is modified by a transformation matrix.  Here, though, there’s also another term dealing with the effect of changing <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi>𝐮</mi></math></span> values as the second argument to <!-- 08fdd9337547a3f93fea9d7aec33d0b0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a(\mathbf{u}_{i},\mathbf{u}_{j})" display="inline"><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐮</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>.  Let’s expand that out one step further:</p>

<p><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?8962015d5f3ebb8b7fc51ba3ef856340.tex-inline › 8962015d5f3ebb8b7fc51ba3ef856340.tex-inline.latexml.html</p>
</fieldset>
<!-- 8962015d5f3ebb8b7fc51ba3ef856340.tex-inline.latexml.html --></p>

<p>Here I’m using colors to distinguish three different vector quantities, which I’ll soon plot in the same colors:</p>

<ul>
  <li><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?a46f09b8110d91065f3b87107a7037d8.tex-math › a46f09b8110d91065f3b87107a7037d8.tex-math.latexml.html</p>
</fieldset>
<!-- a46f09b8110d91065f3b87107a7037d8.tex-math.latexml.html -->, the resultant change in <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi>𝐀</mi><mi>i</mi></msub></math></span>, blue.</li>
  <li><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?3c91d13861e3ed4e6c1271fbea7aeb24.tex-math › 3c91d13861e3ed4e6c1271fbea7aeb24.tex-math.latexml.html</p>
</fieldset>
<!-- 3c91d13861e3ed4e6c1271fbea7aeb24.tex-math.latexml.html -->, the direct effect of change in <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span> as patient, green.</li>
  <li><fieldset class="ww-messages"><legend>&lt;ww-messages-legend: &gt;</legend><p class='error'>Error: Project file not found: Standalone?db5886c9305699b0a64791cebf7521f4.tex-math › db5886c9305699b0a64791cebf7521f4.tex-math.latexml.html</p>
</fieldset>
<!-- db5886c9305699b0a64791cebf7521f4.tex-math.latexml.html -->, the indirect effect of change in all agents <!-- 61147e839a95b0f4bc1a65e12a116666.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{j}" display="inline"><msub><mi>𝐮</mi><mi>j</mi></msub></math></span> including <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi>𝐮</mi><mi>i</mi></msub></math></span>, purple.</li>
</ul>

<h2 id="supplementary-materials">Supplementary materials</h2>

<p>Here are the Sage classes that do the work for the Mac-Lev models. above.  They use generalized Sage machinery that’s stored at [[SageDynamics]].</p>

<p>Now here’s the MacArthur-Levins resource competition model.</p>

<p><!-- maclevmodels.py.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclevmodels.py.step</span></legend><div class="ww-collapsible-content"><pre>from sage.all import *
 
from dynamicalsystems import *

from sage.symbolic.relation import solve
from sage.symbolic.function_factory import function

# functional forms used in the definitions of ResourceCompetitionModel
# and MacArthurLevinsModel

def c_var(i, l):
    return SR.var( 'c_%s_%s'%(i,l), latex_name='c_{''%s%s}'%(i,l) )

def b_var(i):
    return SR.var( 'b_%s'%i )

def m_var(i):
    return SR.var( 'm_%s'%i )

class ResourceCompetitionModel(PopulationDynamicsSystem):
    &quot;&quot;&quot;The general resource competition model, with some number of
    populations and some number of resources.  The various parameters
    b_i, c_i_l, etc. may or may not be bound to numerical values.
    &quot;&quot;&quot;
    def __init__(self, x_indices=None, r_indices=None,
        X = indexer('X'),
        R = indexer('R'),
        b = indexer(b_var),
        m = indexer(m_var),
        w = indexer('w'),
        r = indexer('r'),
        K = indexer('K'),
        c = indexer_2d('c'),
        bindings=Bindings()):
        &quot;&quot;&quot;How to specify an instance of this model?

        x_indices: might, for instance, be [1, 2, 3], or might not.
        r_indices: likewise.
        X, R, b, etc: some kind of things that can implement operations
            such as, for example, X[i] where i is in x_indices.  These
            should return variables, functions, numbers, or other
            things that can be used in an expression.
        &quot;&quot;&quot;
        self._r_indices = r_indices
        self._indexers = dict( X=X, R=R, b=b, m=m, c=c, w=w, r=r, K=K )
        super(ResourceCompetitionModel, self).__init__(
            [R[l] for l in r_indices], x_indices, X,
            bindings = bindings )
    def flow(self):
        return self.make_flow(**self._indexers)
    def make_flow(self, X, R, b, c, m, r, w, K):
        X_flows = [ (X[i],
            b[i]*X[i]*(sum(c[i][l]*w[l]*R[l] for l in self._r_indices) - m[i]))
            for i in self._population_indices ]
        R_flows = [ (R[l],
            r[l]*(K[l] - R[l]) -
              sum(c[i][l]*X[i] for i in self._population_indices))
            for l in self._r_indices ]
        return dict(X_flows + R_flows)
    def plot_R_ZNGIs( self, with_perpendicular=True, **options ):
        &quot;&quot;&quot;This probably doesn't do anything helpful when the number of
        resources or populations isn't 2&quot;&quot;&quot;
        R_0, R_1 = ( self._indexers['R'][i] for i in (0,1) )
        X_0, X_1 = ( self._population_indexer[i] for i in (0,1) )
        P = Graphics()
        if with_perpendicular:
            P += point( self._bindings( vector( [ self._indexers['K'][i] for i in (0,1) ] ) ), color='gray', size=30 )
        # aux. line crossing R*
        for x_in in self.population_vars():
            zngi = solve( self._flow[x_in]/x_in == 0, R_1, solution_dict=True )[0][R_1]
            zngi_options = dict( options, color='gray', thickness=2, fill=True, fillcolor='gray', fillalpha=0.3, filename=None )
            del zngi_options['filename']
            r0max = solve( zngi, R_0, solution_dict=True )[0][R_0]
            #print 'plot zngi:', zngi
            #sys.stdout.flush()
            P += plot( zngi, (R_0, 0, r0max), **zngi_options )
            if with_perpendicular:
                elim_x = Bindings( { x_out: 0 for x_out in self.population_vars() if x_out != x_in } )
                # todo: plot parametrized by x_in, if needed for vertical case
                zri_soln = solve( [
                    elim_x( self._flow[R_0] == 0 ),
                    elim_x( self._flow[R_1] == 0 ) ],
                    [ x_in, R_1 ], solution_dict=True )[0]
                zri_r1 = zri_soln[R_1]
                #print 'plot zri:', zri_r1
                #sys.stdout.flush()
                zri_options = dict( options, thickness=1,
                   color = { X_0:'blue', X_1:'red' }[x_in] )
                del zri_options['filename']
                P += plot( zri_r1, (R_0,0,4), **zri_options )
                rstar_soln = solve( [ R_1 == zri_r1, R_1 == zngi ], [ R_0, R_1 ], solution_dict=True )[0]
                rstar = Bindings( rstar_soln )( vector( [ R_0, R_1 ] ) )
                P += point( rstar, color='gray', size=30 )
        if 'filename' in options:
            P.save( **options )
        return P

class MacArthurLevinsModel(PopulationDynamicsSystem):
    &quot;&quot;&quot;The MacArthur-Levins model is constructed by separating timescales
    to remove the R_l variables from the dynamics&quot;&quot;&quot;
    def __init__(self, rescomp_model=None, **named_args):
        &quot;&quot;&quot;Give me a ResourceCompetitionModel with nx populations and
        nr resources, I will crunch it down into a MacArthurLevinsModel
        with nx populations.&quot;&quot;&quot;
        #print 'MacArthurLevinsModel', (rescomp_model, named_args)
        if rescomp_model is None:
            rescomp_model = ResourceCompetitionModel(**named_args)
        self._rescomp_model = rescomp_model
        self._r_indices = rescomp_model._r_indices
        super(MacArthurLevinsModel, self).__init__(
          [],
          rescomp_model._population_indices,
          rescomp_model._population_indexer,
          bindings = rescomp_model._bindings )
    def flow(self):
        # find the equilibrium values of R_l given the current values X_i
        R = [self._rescomp_model._indexers['R'][l] for l in self._r_indices]
        Rsolns = { R_l:self.solve_for_R(R_l) for R_l in R }
        #print 'R solns:', Rsolns
        # now substitute those values of R into the X equations
        reduced_flow = dict( (X_i,
              self._rescomp_model._flow[X_i].substitute_expression(Rsolns) )
            for X_i in self.population_vars() )
        # that's the Macarthur-Levins model.
        return reduced_flow
    def solve_for_R(self, R_l):
        &quot;&quot;&quot;solve for the equilibrium value of one R_l given the X_i values&quot;&quot;&quot;
        Rhat_soln = solve( 0 == self._rescomp_model._flow[R_l], R_l, solution_dict=True )
	#print 'solve for', R_l, 'in', [ 0 == self._rescomp_model._flow[R_l] ], ' =&gt; ', Rhat_soln
        # there should be just one solution
        assert len(Rhat_soln) == 1
        #print &quot;R-hat: %s&quot; % Rhat_soln[0][R_l]
        # put it in the bindings in case we want to plot R_l or something
        self._bindings[R_l] = Rhat_soln[0][R_l]
        # it's also its own equilibrium
        self._bindings[hat(R_l)] = self._rescomp_model.add_hats( Rhat_soln[0][R_l] )
        return Rhat_soln[0][R_l]
    def set_population_indices(self,xi):
        # need to pass this through to the res-comp system
        self._rescomp_model.set_population_indices(xi)
        super(MacArthurLevinsModel, self).set_population_indices(xi)

</pre></div></fieldset></p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Lee Worden</h2>

    <div class="footer-col-1 column">
      <ul>
        <li><a href="mailto:worden.lee@gmail.com">worden.lee@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/worden-lee">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">worden-lee</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/leeworden">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">leeworden</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
	    <p class="text"><!-- Any additional text --></p>
    </div>

  </div>

</footer>


    </body>
</html>
