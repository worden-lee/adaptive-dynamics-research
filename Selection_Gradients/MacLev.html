<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Adaptive Geometry of Resource Competition</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Lee Worden prototype research website" />
        <link rel="canonical" href="/Selection_Gradients/MacLev.html/" />

        <!-- Custom CSS -->
	<link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="/css/auto-generated-from-ww.css">
	<link rel="stylesheet" href="/css/wmd.css">
	<!--
        <script type="text/x-mathjax-config">MathJax.Hub.Config({ jax: ["input/MathML", "output/HTML-CSS"] });</script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=MML_HTMLorMML"></script>
	-->

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">Lee Worden research prototype website</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/about">About</a>
        <a class="page-link" href="/projects">Projects</a>
      </div>
    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Adaptive Geometry of Resource Competition</h1>
  </header>

  <article class="post-content">
  <p>On these pages I am investigating the evolution of interactions in the MacArthur/Levins resource competition model.</p>

<p>This page explains the adaptive dynamics concepts and questions I’m using, and includes Sage source code for the models.</p>

<p>Child pages use this theory and code to investigate specific cases of the models: </p>

<ul>
  <li><a href="/Selection_Gradients/MacLev-1-1.html">Adaptive Geometry of Resource Competition: One Species, One Resource</a></li>
  <li><a href="/Selection_Gradients/MacLev-2-2.html">Adaptive Geometry of Resource Competition: Two Species, Two Resources</a></li>
</ul>

<h2 id="macarthur-levins-population-dynamics">MacArthur-Levins population dynamics</h2>

<p>We start with a population-resource model:</p>

<p><!-- 9d68dc3b025847f5d40f9322c232d748.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{i}}{dt}=b_{i}X_{i}(\sum_{\ell}c_{i\ell}w_{\ell}R_{\ell}-m_{i})" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM1w"><mrow xml:id="XM1r"><munder xml:id="XM1b"><mo largeop="true" movablelimits="false" symmetric="true" xml:id="XM1">∑</mo><mi mathvariant="normal" xml:id="XM1a">ℓ</mi></munder><mrow xml:id="XM1q"><msub xml:id="XM1h"><mi xml:id="XM1c">c</mi><mrow xml:id="XM1g"><mi xml:id="XM1d">i</mi><mo xml:id="XM1e">⁢</mo><mi mathvariant="normal" xml:id="XM1f">ℓ</mi></mrow></msub><mo xml:id="XM1i">⁢</mo><msub xml:id="XM1l"><mi xml:id="XM1j">w</mi><mi mathvariant="normal" xml:id="XM1k">ℓ</mi></msub><mo xml:id="XM1m">⁢</mo><msub xml:id="XM1p"><mi xml:id="XM1n">R</mi><mi mathvariant="normal" xml:id="XM1o">ℓ</mi></msub></mrow></mrow><mo xml:id="XM1s">-</mo><msub xml:id="XM1v"><mi xml:id="XM1t">m</mi><mi xml:id="XM1u">i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span></p>

<p><!-- 054c5a7aa8df5d33819cea0aaef6d1b8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dR_{\ell}}{dt}=r_{\ell}(K_{\ell}-R_{\ell})-\sum_{i}c_{i\ell}X_{i}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><msub><mi>r</mi><mi mathvariant="normal">ℓ</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM1g"><msub xml:id="XM1b"><mi xml:id="XM1">K</mi><mi mathvariant="normal" xml:id="XM1a">ℓ</mi></msub><mo xml:id="XM1c">-</mo><msub xml:id="XM1f"><mi xml:id="XM1d">R</mi><mi mathvariant="normal" xml:id="XM1e">ℓ</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>i</mi></munder><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></mrow></mrow></mrow></math></span></p>

<p>where <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span> is the density of population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>, <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> is the abundance of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span> and the parameters are <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, an intrinsic population growth rate, <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span>, mortality rate, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span>, the rate at which population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> captures resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span>, <!-- 1235855f8799d6d05eb99f4107d753b8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{\ell}" display="inline"><msub><mi>w</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, the amount a unit of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span> contributes to population growth, <!-- 2c957c70d4812dfa9765865177ed2dfd.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="r_{\ell}" display="inline"><msub><mi>r</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, the resupply rate of resource <!-- ee5e5c003694e7cd5ae404923c665edb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\ell" display="inline"><mi mathvariant="normal">ℓ</mi></math></span>, and <!-- 72addfe74695b542ed83e06a81124f5a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="K_{\ell}" display="inline"><msub><mi>K</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> its maximum possible abundance.</p>

<p>This is a fine model on its own, but I am interested in Lotka-Volterra models, which are models in which there is a simple number <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> describing how populations <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and <!-- 363b122c528f54df4a0446b6bab05515.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline"><mi>j</mi></math></span> interact with each other.  Using a Lotka-Volterra model will let us look at how these interaction terms <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> change, telling us how evolution drives these populations to become more competitive, antagonistic, or mutualistic.</p>

<p>In the above model the populations <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> interact indirectly by taking resources from each other, but we can make the interactions direct by making simplifying assumptions, and this is what MacArthur and Levins did.  </p>

<p>We do this by assuming that the resources come to equilibrium very quickly compared to the populations.  Under this assumptions, we can hold the population sizes <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span> fixed and solve the second equation above for <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> when <!-- 1bcdc124f525b3856d1710c4f3275da9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dR_{\ell}}{dt}=0" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></math></span>:</p>

<p><!-- a8705258bfb6b3178ec533cc372ffca7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\hat{R}_{\ell}=K_{\ell}-\frac{1}{r_{\ell}}\sum_{i}c_{i\ell}X_{i}" display="inline"><mrow><msub><mover accent="true"><mi>R</mi><mo stretchy="false">^</mo></mover><mi mathvariant="normal">ℓ</mi></msub><mo>=</mo><mrow><msub><mi>K</mi><mi mathvariant="normal">ℓ</mi></msub><mo>-</mo><mrow><mfrac><mn>1</mn><msub><mi>r</mi><mi mathvariant="normal">ℓ</mi></msub></mfrac><mo>⁢</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>i</mi></munder><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></mrow></mrow></mrow></mrow></math></span>.</p>

<p>Then we simply use that value of <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span> in the first equation, and we have a system of population sizes only:</p>

<p><!-- 73b216fcd5000b3db8d4ba579d4d8a84.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{i}}{dt}=b_{i}X_{i}(\sum_{\ell}c_{i\ell}w_{\ell}(K_{\ell}-\frac{1}{r_%&#10;{\ell}}\sum_{j}c_{j\ell}X_{j})-m_{i})" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM5w"><mrow xml:id="XM5r"><munder xml:id="XM5b"><mo largeop="true" movablelimits="false" symmetric="true" xml:id="XM5">∑</mo><mi mathvariant="normal" xml:id="XM5a">ℓ</mi></munder><mrow xml:id="XM5q"><msub xml:id="XM5h"><mi xml:id="XM5c">c</mi><mrow xml:id="XM5g"><mi xml:id="XM5d">i</mi><mo xml:id="XM5e">⁢</mo><mi mathvariant="normal" xml:id="XM5f">ℓ</mi></mrow></msub><mo xml:id="XM5i">⁢</mo><msub xml:id="XM5l"><mi xml:id="XM5j">w</mi><mi mathvariant="normal" xml:id="XM5k">ℓ</mi></msub><mo xml:id="XM5m">⁢</mo><mrow xml:id="XM5p"><mo stretchy="false" xml:id="XM5n">(</mo><mrow xml:id="XM4z"><msub xml:id="XM4b"><mi xml:id="XM4">K</mi><mi mathvariant="normal" xml:id="XM4a">ℓ</mi></msub><mo xml:id="XM4c">-</mo><mrow xml:id="XM4y"><mfrac xml:id="XM4h"><mn xml:id="XM4d">1</mn><msub xml:id="XM4g"><mi xml:id="XM4e">r</mi><mi mathvariant="normal" xml:id="XM4f">ℓ</mi></msub></mfrac><mo xml:id="XM4i">⁢</mo><mrow xml:id="XM4x"><munder xml:id="XM4l"><mo largeop="true" movablelimits="false" symmetric="true" xml:id="XM4j">∑</mo><mi xml:id="XM4k">j</mi></munder><mrow xml:id="XM4w"><msub xml:id="XM4r"><mi xml:id="XM4m">c</mi><mrow xml:id="XM4q"><mi xml:id="XM4n">j</mi><mo xml:id="XM4o">⁢</mo><mi mathvariant="normal" xml:id="XM4p">ℓ</mi></mrow></msub><mo xml:id="XM4s">⁢</mo><msub xml:id="XM4v"><mi xml:id="XM4t">X</mi><mi xml:id="XM4u">j</mi></msub></mrow></mrow></mrow></mrow><mo stretchy="false" xml:id="XM5o">)</mo></mrow></mrow></mrow><mo xml:id="XM5s">-</mo><msub xml:id="XM5v"><mi xml:id="XM5t">m</mi><mi xml:id="XM5u">i</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span>.</p>

<p>We can rearrange the terms of this to have the standard Lotka-Volterra form:</p>

<p><!-- 8bb2bab513d8ced4412d5e6bf9d68d57.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{i}}{dt}=k_{i}X_{i}+\sum_{j}a_{ij}X_{i}X_{j}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mo>+</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>j</mi></munder><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>X</mi><mi>j</mi></msub></mrow></mrow></mrow></mrow></math></span>,</p>

<p>where</p>

<p><!-- dd4504699b122c86d4d86ea3e44feed5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}=b_{i}(\sum_{\ell}c_{i\ell}w_{\ell}K_{\ell}-m_{1})" display="inline"><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM1w"><mrow xml:id="XM1r"><munder xml:id="XM1b"><mo largeop="true" movablelimits="false" symmetric="true" xml:id="XM1">∑</mo><mi mathvariant="normal" xml:id="XM1a">ℓ</mi></munder><mrow xml:id="XM1q"><msub xml:id="XM1h"><mi xml:id="XM1c">c</mi><mrow xml:id="XM1g"><mi xml:id="XM1d">i</mi><mo xml:id="XM1e">⁢</mo><mi mathvariant="normal" xml:id="XM1f">ℓ</mi></mrow></msub><mo xml:id="XM1i">⁢</mo><msub xml:id="XM1l"><mi xml:id="XM1j">w</mi><mi mathvariant="normal" xml:id="XM1k">ℓ</mi></msub><mo xml:id="XM1m">⁢</mo><msub xml:id="XM1p"><mi xml:id="XM1n">K</mi><mi mathvariant="normal" xml:id="XM1o">ℓ</mi></msub></mrow></mrow><mo xml:id="XM1s">-</mo><msub xml:id="XM1v"><mi xml:id="XM1t">m</mi><mn xml:id="XM1u">1</mn></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span> (ordinarily I’d call this <!-- af2593b49488f8bc44396795792c2d79.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="r_{i}" display="inline"><msub><mi>r</mi><mi>i</mi></msub></math></span>, but the name is already in use),</p>

<p><!-- d2b8abf02781228530e31ae1cc5b2346.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}=-b_{i}\sum_{\ell}\sum_{j}\frac{c_{i\ell}c_{j\ell}w_{\ell}}{r_{\ell}}" display="inline"><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo>-</mo><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>⁢</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi mathvariant="normal">ℓ</mi></munder><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>j</mi></munder><mfrac><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub><mo>⁢</mo><msub><mi>c</mi><mrow><mi>j</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub><mo>⁢</mo><msub><mi>w</mi><mi mathvariant="normal">ℓ</mi></msub></mrow><msub><mi>r</mi><mi mathvariant="normal">ℓ</mi></msub></mfrac></mrow></mrow></mrow></mrow></mrow></math></span>.</p>

<p>I’ll be interested in how the interaction terms <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> change as the populations coevolve, because this expresses whether competition becomes stronger or weaker.  When two coevolving populations compete for resources, we expect them to differentiate from each other and lessen the competition, but I’d like to look at both that and other cases, and do some detailed analysis about when it lessens and when it greatens.</p>

<h2 id="adaptive-dynamics-in-the-macarthur-levins-model">Adaptive dynamics in the Macarthur-Levins model</h2>

<p>And now here’s where we look at how that single population ‘‘evolves’’ in the Mac-Lev model.  I won’t review the details of how <a href="http://en.wikipedia.org/w/Evolutionary_invation_analysis">adaptive dynamics</a> is done, but in summary: suppose that certain aspects of the population dynamics depend on the characteristics of the population, and those characteristics are able to mutate.  Then over time, mutants will arise, and if they are better able to thrive in the environment they encounter than their forefathers, they will gradually replace them, and the characteristics of the population will slowly change.</p>

<p>In this model, it’s <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span>, and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span> that have to do with the populations, so we introduce a ‘‘phenotype’’ variable <!-- eb00a04135562ae6f74786f084f54327.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u_{i}" display="inline"><msub><mi>u</mi><mi>i</mi></msub></math></span> representing the characteristics of the population and suppose that <!-- fe3e01a305f27284ff5115f4c5ea0fa4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="b_{i}" display="inline"><msub><mi>b</mi><mi>i</mi></msub></math></span>, <!-- e9faee1f59b9695ec26f913247352530.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c_{i\ell}" display="inline"><msub><mi>c</mi><mrow><mi>i</mi><mo>⁢</mo><mi mathvariant="normal">ℓ</mi></mrow></msub></math></span> and <!-- 342e772474b691ac87dac30aeef596c0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="m_{i}" display="inline"><msub><mi>m</mi><mi>i</mi></msub></math></span> are determined by the value of <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>.  Then we can find out how <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> changes in time in response to the conditions created by the population dynamics, and also how the other values such as <!-- a97118fb9e8d7e006a466bfc0771f888.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="X_{i}" display="inline"><msub><mi>X</mi><mi>i</mi></msub></math></span>, <!-- 7b16b47f878e618242fc18621939c974.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="R_{\ell}" display="inline"><msub><mi>R</mi><mi mathvariant="normal">ℓ</mi></msub></math></span>, <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span>, <!-- 34c1d173d638ceb8fb5bec184c055549.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}" display="inline"><msub><mi>k</mi><mi>i</mi></msub></math></span>, change as <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> evolves.</p>

<p>The change in <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>, to make a long story short, is driven by how the population growth rate of a rare mutant varies with the mutant’s phenotype <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>.  That is, there’s an “invasion speed” <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></math></span> that is closely related to the population growth rate <!-- 86b5a7e8226ee2b74185f34d3ffd018c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{dX_{i}}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>, and the change in <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span> (that is, <!-- eee68d0a6be1ecbbba3e4ee86efb4d45.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{du}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi>u</mi></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>) is in proportion to <!-- 9f9f37ce4302d27f292b94f660c150d9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathcal{I}}{\partial u}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow></mfrac></math></span>.</p>

<p>To be precise:</p>

<p><!-- 2cbb083a466aa68a405913db25c95edf.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}(u_{i}|E)=\lim_{X_{i}\to 0}\frac{1}{X_{i}}\frac{dX_{i}}{dt}" display="inline"><mrow><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi><mrow><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><munder><mo movablelimits="false">lim</mo><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>→</mo><mn>0</mn></mrow></munder><mfrac><mn>1</mn><msub><mi>X</mi><mi>i</mi></msub></mfrac><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>X</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></math></span></p>

<p>defines the invasion speed (where <!-- 3a3ea00cfc35332cedf6e5e9a32e94da.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="E" display="inline"><mi>E</mi></math></span> is the environment that an individual population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> experiences, including the rest of population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and all other populations), and then</p>

<p><!-- a852284ef1781e2b314a17ae33dc2cda.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{du_{i}}{dt}=\left.\gamma\hat{X}_{i}\frac{\partial\mathcal{I}(v|u_{1},%&#10;\ldots,u_{n})}{\partial v}\right|_{v=u_{i}}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mrow><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">|</mo><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal" xml:id="XM2">…</mi><mo>,</mo><msub><mi>u</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>v</mi></mrow></mfrac></mrow><mo fence="true">|</mo></mrow><mrow><mi>v</mi><mo>=</mo><msub><mi>u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span>,</p>

<p>where <!-- ae539dfcc999c28e25a0f3ae65c1de79.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\gamma" display="inline"><mi>γ</mi></math></span> is a coefficient accounting for the frequency and size of available mutations.  In simple cases, it’s a constant, while when available mutations are not quite so simple and uniform, it may not be (as we will see).</p>

<h2 id="adaptive-geometry-of-ecological-parameters">Adaptive geometry of ecological parameters</h2>

<p>Now let’s go deeper into what happens in that evolutionary change.  We’re considering several different ways to describe the evolving population, and now I want to give them clearer notation:</p>

<ul>
  <li><!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span>, the “underlying phenotype”.  I’m going to be using a scalar <!-- eb00a04135562ae6f74786f084f54327.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u_{i}" display="inline"><msub><mi>u</mi><mi>i</mi></msub></math></span>, and in fact just one of them, so I can call it <!-- 7b774effe4a349c6dd82ad4f4f21d34c.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="u" display="inline"><mi>u</mi></math></span>, but in general it’s a vector of numbers, which is what I mean by writing it in boldface.</li>
  <li><!-- 68f37b772d10e67f44b4703b11469972.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}(\mathbf{u}_{i})=\begin{pmatrix}b_{i}(\mathbf{u}_{i})\\&#10;m_{i}(\mathbf{u}_{i})\\&#10;c_{i1}(\mathbf{u}_{i})\\&#10;\vdots\\&#10;c_{im}(\mathbf{u}_{i})\end{pmatrix}" display="inline"><mrow><mrow><mi mathvariant="bold">p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM6b"><mi mathvariant="bold" xml:id="XM6">u</mi><mi xml:id="XM6a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true" xml:id="Ex1.m1.xm1am"><mtr xml:id="Ex1.m1.xm1an"><mtd columnalign="center" xml:id="Ex1.m1.xm1ao"><mrow xml:id="Ex1.m1.xm1g"><msub xml:id="Ex1.m1.xm1b"><mi xml:id="Ex1.m1.xm1">b</mi><mi xml:id="Ex1.m1.xm1a">i</mi></msub><mo xml:id="Ex1.m1.xm1c">⁢</mo><mrow xml:id="Ex1.m1.xm1f"><mo stretchy="false" xml:id="Ex1.m1.xm1d">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false" xml:id="Ex1.m1.xm1e">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="Ex1.m1.xm1ap"><mtd columnalign="center" xml:id="Ex1.m1.xm1aq"><mrow xml:id="Ex1.m1.xm1o"><msub xml:id="Ex1.m1.xm1j"><mi xml:id="Ex1.m1.xm1h">m</mi><mi xml:id="Ex1.m1.xm1i">i</mi></msub><mo xml:id="Ex1.m1.xm1k">⁢</mo><mrow xml:id="Ex1.m1.xm1n"><mo stretchy="false" xml:id="Ex1.m1.xm1l">(</mo><msub xml:id="XM3b"><mi mathvariant="bold" xml:id="XM3">u</mi><mi xml:id="XM3a">i</mi></msub><mo stretchy="false" xml:id="Ex1.m1.xm1m">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="Ex1.m1.xm1ar"><mtd columnalign="center" xml:id="Ex1.m1.xm1as"><mrow xml:id="Ex1.m1.xm1z"><msub xml:id="Ex1.m1.xm1u"><mi xml:id="Ex1.m1.xm1p">c</mi><mrow xml:id="Ex1.m1.xm1t"><mi xml:id="Ex1.m1.xm1q">i</mi><mo xml:id="Ex1.m1.xm1r">⁢</mo><mn xml:id="Ex1.m1.xm1s">1</mn></mrow></msub><mo xml:id="Ex1.m1.xm1v">⁢</mo><mrow xml:id="Ex1.m1.xm1y"><mo stretchy="false" xml:id="Ex1.m1.xm1w">(</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">i</mi></msub><mo stretchy="false" xml:id="Ex1.m1.xm1x">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="Ex1.m1.xm1at"><mtd columnalign="center" xml:id="Ex1.m1.xm1au"><mi mathvariant="normal" xml:id="Ex1.m1.xm1aa">⋮</mi></mtd></mtr><mtr xml:id="Ex1.m1.xm1av"><mtd columnalign="center" xml:id="Ex1.m1.xm1aw"><mrow xml:id="Ex1.m1.xm1al"><msub xml:id="Ex1.m1.xm1ag"><mi xml:id="Ex1.m1.xm1ab">c</mi><mrow xml:id="Ex1.m1.xm1af"><mi xml:id="Ex1.m1.xm1ac">i</mi><mo xml:id="Ex1.m1.xm1ad">⁢</mo><mi xml:id="Ex1.m1.xm1ae">m</mi></mrow></msub><mo xml:id="Ex1.m1.xm1ah">⁢</mo><mrow xml:id="Ex1.m1.xm1ak"><mo stretchy="false" xml:id="Ex1.m1.xm1ai">(</mo><msub xml:id="XM5b"><mi mathvariant="bold" xml:id="XM5">u</mi><mi xml:id="XM5a">i</mi></msub><mo stretchy="false" xml:id="Ex1.m1.xm1aj">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>, the “ecological phenotype”</li>
  <li><!-- 8b47241acc8318d04c70a75c7e2d0103.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{1}),\ldots,%&#10;\mathbf{p}(\mathbf{u}_{n}))=\begin{pmatrix}k_{i}(\mathbf{p}(\mathbf{u}_{i}))\\&#10;a_{i1}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{1}))\\&#10;\vdots\\&#10;a_{in}(\mathbf{p}(\mathbf{u}_{i}),\mathbf{p}(\mathbf{u}_{n}))\end{pmatrix}" display="inline"><mrow><mrow><mi mathvariant="bold">A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM27e"><mi mathvariant="bold" xml:id="XM27">p</mi><mo xml:id="XM27a">⁢</mo><mrow xml:id="XM27d"><mo stretchy="false" xml:id="XM27b">(</mo><msub xml:id="XM24b"><mi mathvariant="bold" xml:id="XM24">u</mi><mi xml:id="XM24a">i</mi></msub><mo stretchy="false" xml:id="XM27c">)</mo></mrow></mrow><mo>,</mo><mrow xml:id="XM28e"><mi mathvariant="bold" xml:id="XM28">p</mi><mo xml:id="XM28a">⁢</mo><mrow xml:id="XM28d"><mo stretchy="false" xml:id="XM28b">(</mo><msub xml:id="XM25b"><mi mathvariant="bold" xml:id="XM25">u</mi><mn xml:id="XM25a">1</mn></msub><mo stretchy="false" xml:id="XM28c">)</mo></mrow></mrow><mo>,</mo><mi mathvariant="normal" xml:id="XM29">…</mi><mo>,</mo><mrow xml:id="XM30e"><mi mathvariant="bold" xml:id="XM30">p</mi><mo xml:id="XM30a">⁢</mo><mrow xml:id="XM30d"><mo stretchy="false" xml:id="XM30b">(</mo><msub xml:id="XM26b"><mi mathvariant="bold" xml:id="XM26">u</mi><mi xml:id="XM26a">n</mi></msub><mo stretchy="false" xml:id="XM30c">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>(</mo><mtable displaystyle="true" xml:id="Ex1.m1.xm1ag"><mtr xml:id="Ex1.m1.xm1ah"><mtd columnalign="center" xml:id="Ex1.m1.xm1ai"><mrow xml:id="Ex1.m1.xm1g"><msub xml:id="Ex1.m1.xm1b"><mi xml:id="Ex1.m1.xm1">k</mi><mi xml:id="Ex1.m1.xm1a">i</mi></msub><mo xml:id="Ex1.m1.xm1c">⁢</mo><mrow xml:id="Ex1.m1.xm1f"><mo stretchy="false" xml:id="Ex1.m1.xm1d">(</mo><mrow xml:id="XM5e"><mi mathvariant="bold" xml:id="XM5">p</mi><mo xml:id="XM5a">⁢</mo><mrow xml:id="XM5d"><mo stretchy="false" xml:id="XM5b">(</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">i</mi></msub><mo stretchy="false" xml:id="XM5c">)</mo></mrow></mrow><mo stretchy="false" xml:id="Ex1.m1.xm1e">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="Ex1.m1.xm1aj"><mtd columnalign="center" xml:id="Ex1.m1.xm1ak"><mrow xml:id="Ex1.m1.xm1s"><msub xml:id="Ex1.m1.xm1m"><mi xml:id="Ex1.m1.xm1h">a</mi><mrow xml:id="Ex1.m1.xm1l"><mi xml:id="Ex1.m1.xm1i">i</mi><mo xml:id="Ex1.m1.xm1j">⁢</mo><mn xml:id="Ex1.m1.xm1k">1</mn></mrow></msub><mo xml:id="Ex1.m1.xm1n">⁢</mo><mrow xml:id="Ex1.m1.xm1r"><mo stretchy="false" xml:id="Ex1.m1.xm1o">(</mo><mrow xml:id="XM11e"><mi mathvariant="bold" xml:id="XM11">p</mi><mo xml:id="XM11a">⁢</mo><mrow xml:id="XM11d"><mo stretchy="false" xml:id="XM11b">(</mo><msub xml:id="XM9b"><mi mathvariant="bold" xml:id="XM9">u</mi><mi xml:id="XM9a">i</mi></msub><mo stretchy="false" xml:id="XM11c">)</mo></mrow></mrow><mo xml:id="Ex1.m1.xm1p">,</mo><mrow xml:id="XM12e"><mi mathvariant="bold" xml:id="XM12">p</mi><mo xml:id="XM12a">⁢</mo><mrow xml:id="XM12d"><mo stretchy="false" xml:id="XM12b">(</mo><msub xml:id="XM10b"><mi mathvariant="bold" xml:id="XM10">u</mi><mn xml:id="XM10a">1</mn></msub><mo stretchy="false" xml:id="XM12c">)</mo></mrow></mrow><mo stretchy="false" xml:id="Ex1.m1.xm1q">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="Ex1.m1.xm1al"><mtd columnalign="center" xml:id="Ex1.m1.xm1am"><mi mathvariant="normal" xml:id="Ex1.m1.xm1t">⋮</mi></mtd></mtr><mtr xml:id="Ex1.m1.xm1an"><mtd columnalign="center" xml:id="Ex1.m1.xm1ao"><mrow xml:id="Ex1.m1.xm1af"><msub xml:id="Ex1.m1.xm1z"><mi xml:id="Ex1.m1.xm1u">a</mi><mrow xml:id="Ex1.m1.xm1y"><mi xml:id="Ex1.m1.xm1v">i</mi><mo xml:id="Ex1.m1.xm1w">⁢</mo><mi xml:id="Ex1.m1.xm1x">n</mi></mrow></msub><mo xml:id="Ex1.m1.xm1aa">⁢</mo><mrow xml:id="Ex1.m1.xm1ae"><mo stretchy="false" xml:id="Ex1.m1.xm1ab">(</mo><mrow xml:id="XM18e"><mi mathvariant="bold" xml:id="XM18">p</mi><mo xml:id="XM18a">⁢</mo><mrow xml:id="XM18d"><mo stretchy="false" xml:id="XM18b">(</mo><msub xml:id="XM16b"><mi mathvariant="bold" xml:id="XM16">u</mi><mi xml:id="XM16a">i</mi></msub><mo stretchy="false" xml:id="XM18c">)</mo></mrow></mrow><mo xml:id="Ex1.m1.xm1ac">,</mo><mrow xml:id="XM19e"><mi mathvariant="bold" xml:id="XM19">p</mi><mo xml:id="XM19a">⁢</mo><mrow xml:id="XM19d"><mo stretchy="false" xml:id="XM19b">(</mo><msub xml:id="XM17b"><mi mathvariant="bold" xml:id="XM17">u</mi><mi xml:id="XM17a">n</mi></msub><mo stretchy="false" xml:id="XM19c">)</mo></mrow></mrow><mo stretchy="false" xml:id="Ex1.m1.xm1ad">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow></mrow></math></span>, the “interaction phenotype”</li>
</ul>

<p>These are vectors that are functions of one another.  Using a suitable vector notation in our calculus, we can write the adaptive dynamics of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> directly, ignoring the intermediate variables <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> and <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> for the moment:</p>

<p><!-- c0240ece2799dfc9b699426fd3e007a9.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{u}_{i}}{dt}=\left.\gamma\hat{X}_{i}\frac{\partial\mathcal{I}(%&#10;\mathbf{v}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})}{\partial\mathbf{v}}\right|_{%&#10;\mathbf{v}=\mathbf{u}_{i}}=\gamma\hat{X}_{i}\partial_{1}\mathcal{I}(\mathbf{u}%&#10;_{i})^{T}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mrow><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">|</mo><msub><mi mathvariant="bold">u</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal" xml:id="XM2">…</mi><mo>,</mo><msub><mi mathvariant="bold">u</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">v</mi></mrow></mfrac></mrow><mo fence="true">|</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM8b"><mi mathvariant="bold" xml:id="XM8">u</mi><mi xml:id="XM8a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span>.</p>

<p>The <!-- b9ece18c950afbfa6b0fdbfa4ff731d3.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="T" display="inline"><mi>T</mi></math></span> sign is for vector or matrix transposition: with the notation I’m using, <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span> is a column vector - a point in a vector space of values - and <!-- d8501891973d41e3602c37e666614aaf.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathcal{I}}{\partial\mathbf{u}_{i}}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac></math></span> is a row vector - a thing that operates on points.  Since <!-- 09bf178ed96118b8ae9b1c7a4c3230db.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{u}_{i}}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span> is a column, we need to transpose the derivative of <!-- 92c4d1c8f2a2d4b920b3301ff5211d67.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathcal{I}" display="inline"><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></math></span> to make it match.  The <!-- e12c3e8cad7503d41ec94f3907e448fa.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}" display="inline"><msub><mo>∂</mo><mn>1</mn></msub></math></span> sign is for the partial derivative with respect to the first argument.</p>

<p>Now we can use the chain rule to see how <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> changes:</p>

<p><!-- c4b2b21d1241353e1596f0e4235e0ef7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{p}(\mathbf{u}_{i})}{dt}=\frac{\partial\mathbf{p}}{\partial%&#10;\mathbf{u}_{i}}\frac{d\mathbf{u}_{i}}{dt}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi mathvariant="bold">p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></mrow></math></span>
<!-- fcf4bfcb662578a6c4ef20a0896cfd87.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\frac{\partial\mathbf{p}}{\partial\mathbf{u}_{i}}\partial_{1%&#10;}\mathcal{I}(\mathbf{u}_{i})^{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span>
<!-- bead0e372edf00e428be044f7799cc4f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\frac{\partial\mathbf{p}}{\partial\mathbf{u}_{i}}(\partial_{%&#10;1}\mathcal{I}(\mathbf{p}(\mathbf{u}_{i}))\frac{d\mathbf{p}}{d\mathbf{u}_{i}})^%&#10;{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow xml:id="XM7v"><mrow xml:id="XM7d"><msub xml:id="XM7b"><mo xml:id="XM7">∂</mo><mn xml:id="XM7a">1</mn></msub><mo xml:id="XM7e">⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script" xml:id="XM7c">I</mi></mrow><mo xml:id="XM7f">⁢</mo><mrow xml:id="XM7i"><mo stretchy="false" xml:id="XM7g">(</mo><mrow xml:id="XM6e"><mi mathvariant="bold" xml:id="XM6">p</mi><mo xml:id="XM6a">⁢</mo><mrow xml:id="XM6d"><mo stretchy="false" xml:id="XM6b">(</mo><msub xml:id="XM5b"><mi mathvariant="bold" xml:id="XM5">u</mi><mi xml:id="XM5a">i</mi></msub><mo stretchy="false" xml:id="XM6c">)</mo></mrow></mrow><mo stretchy="false" xml:id="XM7h">)</mo></mrow><mo xml:id="XM7j">⁢</mo><mfrac xml:id="XM7u"><mrow xml:id="XM7n"><mi xml:id="XM7k">d</mi><mo xml:id="XM7l">⁢</mo><mi mathvariant="bold" xml:id="XM7m">p</mi></mrow><mrow xml:id="XM7t"><mi xml:id="XM7o">d</mi><mo xml:id="XM7p">⁢</mo><msub xml:id="XM7s"><mi mathvariant="bold" xml:id="XM7q">u</mi><mi xml:id="XM7r">i</mi></msub></mrow></mfrac></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span>
<!-- 1d197959f2e923aaba9c9eb07a8e8c03.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\frac{\partial\mathbf{p}}{\partial\mathbf{u}_{i}}\frac{%&#10;\partial\mathbf{p}}{\partial\mathbf{u}_{i}}^{T}\partial_{1}\mathcal{I}(\mathbf%&#10;{p}(\mathbf{u}_{i}))^{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><msup><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mi>T</mi></msup><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow xml:id="XM4e"><mi mathvariant="bold" xml:id="XM4">p</mi><mo xml:id="XM4a">⁢</mo><mrow xml:id="XM4d"><mo stretchy="false" xml:id="XM4b">(</mo><msub xml:id="XM3b"><mi mathvariant="bold" xml:id="XM3">u</mi><mi xml:id="XM3a">i</mi></msub><mo stretchy="false" xml:id="XM4c">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span>.</p>

<p>Here we see the usefulness of this row-and-column-vector notation, because it lets us use the chain rule in a natural way: when we write <!-- c4b2b21d1241353e1596f0e4235e0ef7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{p}(\mathbf{u}_{i})}{dt}=\frac{\partial\mathbf{p}}{\partial%&#10;\mathbf{u}_{i}}\frac{d\mathbf{u}_{i}}{dt}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi mathvariant="bold">p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></mrow></math></span>, we’re multiplying a matrix by a column vector to get another column vector, in just the way we want.</p>

<p>I like to write <!-- 52757ce34005ebd7a3e836372bc98801.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{u})=\partial_{1}\mathcal{I}(\mathbf{u})^{T}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM2">u</mi><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span> for the “selection gradient” of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> – the direction of increasing fitness in the space of possible <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> values.  I’m very interested in the role of this selection gradient in various spaces, as we’ll see.  Notice that in the derivation above I switched from <!-- eaec634933761e7cc1d3e3eb60ac9cd2.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{u}_{i})=\left(\frac{\partial\mathcal{I}(\mathbf{v}|\mathbf{u}_{1},%&#10;\ldots,\mathbf{u}_{n})}{\partial\mathbf{v}}\right)_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM8b"><mi mathvariant="bold" xml:id="XM8">u</mi><mi xml:id="XM8a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mo>(</mo><mfrac xml:id="XM9t"><mrow xml:id="XM9o"><mo xml:id="XM9">∂</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script" xml:id="XM9a">I</mi><mrow xml:id="XM9n"><mo stretchy="false" xml:id="XM9b">(</mo><mi mathvariant="bold" xml:id="XM9c">v</mi><mo stretchy="false" xml:id="XM9d">|</mo><msub xml:id="XM9g"><mi mathvariant="bold" xml:id="XM9e">u</mi><mn xml:id="XM9f">1</mn></msub><mo xml:id="XM9h">,</mo><mi mathvariant="normal" xml:id="XM2">…</mi><mo xml:id="XM9i">,</mo><msub xml:id="XM9l"><mi mathvariant="bold" xml:id="XM9j">u</mi><mi xml:id="XM9k">n</mi></msub><mo stretchy="false" xml:id="XM9m">)</mo></mrow></mrow><mrow xml:id="XM9r"><mo xml:id="XM9p">∂</mo><mo xml:id="XM9s">⁡</mo><mi mathvariant="bold" xml:id="XM9q">v</mi></mrow></mfrac><mo>)</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span> to </p>

<p><!-- dae5e5e53e01830bcf273623e7b33ed8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p}(\mathbf{u}_{i}))=\left(\begin{array}[]{c}\frac{\partial\mathcal{I%&#10;}(\mathbf{v}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})}{\partial b(\mathbf{v})}\\&#10;\vdots\\&#10;\frac{\partial\mathcal{I}(\mathbf{v}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})}{%&#10;\partial c_{im}(\mathbf{v})}\end{array}\right)_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow xml:id="XM20e"><mi mathvariant="bold" xml:id="XM20">p</mi><mo xml:id="XM20a">⁢</mo><mrow xml:id="XM20d"><mo stretchy="false" xml:id="XM20b">(</mo><msub xml:id="XM19b"><mi mathvariant="bold" xml:id="XM19">u</mi><mi xml:id="XM19a">i</mi></msub><mo stretchy="false" xml:id="XM20c">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mo>(</mo><mtable displaystyle="true" xml:id="XM21bf"><mtr xml:id="XM21bg"><mtd columnalign="center" xml:id="XM21bh"><mfrac xml:id="XM21y"><mrow xml:id="XM21o"><mo xml:id="XM21">∂</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script" xml:id="XM21a">I</mi><mrow xml:id="XM21n"><mo stretchy="false" xml:id="XM21b">(</mo><mi mathvariant="bold" xml:id="XM21c">v</mi><mo stretchy="false" xml:id="XM21d">|</mo><msub xml:id="XM21g"><mi mathvariant="bold" xml:id="XM21e">u</mi><mn xml:id="XM21f">1</mn></msub><mo xml:id="XM21h">,</mo><mi mathvariant="normal" xml:id="XM2">…</mi><mo xml:id="XM21i">,</mo><msub xml:id="XM21l"><mi mathvariant="bold" xml:id="XM21j">u</mi><mi xml:id="XM21k">n</mi></msub><mo stretchy="false" xml:id="XM21m">)</mo></mrow></mrow><mrow xml:id="XM21x"><mrow xml:id="XM21r"><mo xml:id="XM21p">∂</mo><mo xml:id="XM21s">⁡</mo><mi xml:id="XM21q">b</mi></mrow><mo xml:id="XM21t">⁢</mo><mrow xml:id="XM21w"><mo stretchy="false" xml:id="XM21u">(</mo><mi mathvariant="bold" xml:id="XM8">v</mi><mo stretchy="false" xml:id="XM21v">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr xml:id="XM21bi"><mtd columnalign="center" xml:id="XM21bj"><mi mathvariant="normal" xml:id="XM21z">⋮</mi></mtd></mtr><mtr xml:id="XM21bk"><mtd columnalign="center" xml:id="XM21bl"><mfrac xml:id="XM21be"><mrow xml:id="XM21ap"><mo xml:id="XM21aa">∂</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script" xml:id="XM21ab">I</mi><mrow xml:id="XM21ao"><mo stretchy="false" xml:id="XM21ac">(</mo><mi mathvariant="bold" xml:id="XM21ad">v</mi><mo stretchy="false" xml:id="XM21ae">|</mo><msub xml:id="XM21ah"><mi mathvariant="bold" xml:id="XM21af">u</mi><mn xml:id="XM21ag">1</mn></msub><mo xml:id="XM21ai">,</mo><mi mathvariant="normal" xml:id="XM10">…</mi><mo xml:id="XM21aj">,</mo><msub xml:id="XM21am"><mi mathvariant="bold" xml:id="XM21ak">u</mi><mi xml:id="XM21al">n</mi></msub><mo stretchy="false" xml:id="XM21an">)</mo></mrow></mrow><mrow xml:id="XM21bd"><mrow xml:id="XM21ax"><mo xml:id="XM21aq">∂</mo><mo xml:id="XM21ay">⁡</mo><msub xml:id="XM21aw"><mi xml:id="XM21ar">c</mi><mrow xml:id="XM21av"><mi xml:id="XM21as">i</mi><mo xml:id="XM21at">⁢</mo><mi xml:id="XM21au">m</mi></mrow></msub></mrow><mo xml:id="XM21az">⁢</mo><mrow xml:id="XM21bc"><mo stretchy="false" xml:id="XM21ba">(</mo><mi mathvariant="bold" xml:id="XM16">v</mi><mo stretchy="false" xml:id="XM21bb">)</mo></mrow></mrow></mfrac></mtd></mtr></mtable><mo>)</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span>.
These different selection gradients are very different objects: they’re vectors expressing the direction of selection in different spaces – here, the space of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> values ‘‘vs.’’ the space of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> values.  Soon enough we’ll also be looking at the selection gradient in <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> space.</p>

<p>Using the above chain rule manipulations, we can write</p>

<p><!-- 689bf4589a64cbfc05a30cad4fee472f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{u}_{i}}{dt}=\gamma\hat{X}_{i}S(\mathbf{u}_{i})" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span></p>

<p><!-- f157e096bb0c2ac93ead92979f58a8e7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{p}(\mathbf{u}_{i})}{dt}=\gamma\hat{X}_{i}\frac{\partial\mathbf{%&#10;p}}{\partial\mathbf{u}}\frac{\partial\mathbf{p}}{\partial\mathbf{u}}^{T}S(%&#10;\mathbf{p})" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><mi mathvariant="bold">p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">u</mi></mrow></mfrac><mo>⁢</mo><msup><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">u</mi></mrow></mfrac><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM2">p</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span>.</p>

<p>Like <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> or whatever other vector, <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> would evolve in the direction of <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">p</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> if it were to mutate in all directions equally.  However, it doesn’t do that: since <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> is a function of <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span>, it only mutates in directions given by mutations in <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span>.  The matrix multiplying <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">p</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> in the dynamics of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> is a projection matrix, restricting the motion of <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> to directions allowed by the mapping between <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> and <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span>.  (To be precise, <!-- 0f79fff7b9fbaa986c04a3377df1a32a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathbf{p}}{\partial\mathbf{u}}\frac{\partial\mathbf{p}}{%&#10;\partial\mathbf{u}}^{T}S(\mathbf{p})" display="inline"><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">u</mi></mrow></mfrac><mo>⁢</mo><msup><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">u</mi></mrow></mfrac><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">p</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> is not precisely the projection of <!-- 6a759f7df60bdd21aa8168592e636d4d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{p})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">p</mi><mo stretchy="false">)</mo></mrow></mrow></math></span> onto the subspace parametrized by <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> unless the columns of <!-- da7a98049c6af5c9d284ff0ce3d2eb33.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{\partial\mathbf{p}}{\partial\mathbf{u}}" display="inline"><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">p</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">u</mi></mrow></mfrac></math></span> are unit-length; otherwise there’s some scaling by positive numbers involved.  But it definitely transforms the vector into a direction allowed by the restriction to points parametrized by <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span>.)</p>

<p>The motion of <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> is the same way, except that it is influenced by all the populations in the system, not just one, because two phenotypes are involved in each <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> value.  For that reason, the dynamics of <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> has some extra terms…</p>

<p>But before we go into that, let’s look at the selection gradient and the dynamics of <!-- 1f82f9b08ed981377ef238d2f45c514a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}(\mathbf{u})" display="inline"><mrow><mi mathvariant="bold">p</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">u</mi><mo stretchy="false">)</mo></mrow></mrow></math></span>.</p>

<h2 id="adaptive-geometry-of-interaction-terms">Adaptive geometry of interaction terms</h2>

<p>Now, let’s get to how <!-- 9a59294d35ec9247478796ffb89359eb.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ij}" display="inline"><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math></span> and <!-- 34c1d173d638ceb8fb5bec184c055549.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k_{i}" display="inline"><msub><mi>k</mi><mi>i</mi></msub></math></span> “would like to evolve” and why they move in the directions they do.</p>

<p>Expanding out the dynamics of the <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> vector has more involved than doing it for the <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span> vector, because <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> depends on all the different phenotypes <!-- 61147e839a95b0f4bc1a65e12a116666.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{j}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>j</mi></msub></math></span>, not just one we’re concerned with.  Also, we have to keep careful track of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span>, because it appears in <!-- 982c0ac0ca870a4b6408355a2cbbc469.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}" display="inline"><mi mathvariant="bold">A</mi></math></span> in two different ways: on the left-hand side of each <!-- dd980b2b295ad11972dc1b3314b70f4a.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{a}_{ij}=a(\mathbf{u}_{i},\mathbf{u}_{j})" display="inline"><mrow><msub><mi mathvariant="bold">a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo>,</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span> term, which describes how population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> (the “patient”) is affected by an encounter with population <!-- 363b122c528f54df4a0446b6bab05515.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline"><mi>j</mi></math></span> (the “agent”); and also on the right-hand side of the <!-- 07a4ca1d3386958dbb0000fd7381262e.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a_{ii}=a(\mathbf{u}_{i},\mathbf{u}_{i})" display="inline"><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>⁢</mo><mi>i</mi></mrow></msub><mo>=</mo><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo>,</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span> term, as the “agent” in an encounter between <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> and <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>.  This distinction is important because every encounter has two effects, the effect on oneself and the effect on the other, and we’ll see that selection treats these two effects very differently.</p>

<p>So to be clear, we’ll work with the notation</p>

<p><!-- aba2f85a8592a07718e0e789cba52556.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}=\left.\mathbf{A}(\mathbf{v},\mathbf{u}_{1},\ldots,\mathbf{u}_{n%&#10;})\right|_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">A</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold" xml:id="XM1">v</mi><mo>,</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mn xml:id="XM2a">1</mn></msub><mo>,</mo><mi mathvariant="normal" xml:id="XM3">…</mi><mo>,</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">n</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo fence="true">|</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span> <!-- b181e7a0630fab085eb3bb44a7146071.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\left(\begin{array}[]{c}\mathbf{a}(\mathbf{v},\mathbf{u}_{1})\\&#10;\vdots\\&#10;\mathbf{a}(\mathbf{v},\mathbf{u}_{n})\\&#10;k(\mathbf{v})\end{array}\right)_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mi/><mo>=</mo><msub><mrow><mo>(</mo><mtable displaystyle="true" xml:id="XM6u"><mtr xml:id="XM6v"><mtd columnalign="center" xml:id="XM6w"><mrow xml:id="XM6f"><mi mathvariant="bold" xml:id="XM6">a</mi><mo xml:id="XM6a">⁢</mo><mrow xml:id="XM6e"><mo stretchy="false" xml:id="XM6b">(</mo><mi mathvariant="bold" xml:id="XM1">v</mi><mo xml:id="XM6c">,</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mn xml:id="XM2a">1</mn></msub><mo stretchy="false" xml:id="XM6d">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="XM6x"><mtd columnalign="center" xml:id="XM6y"><mi mathvariant="normal" xml:id="XM6g">⋮</mi></mtd></mtr><mtr xml:id="XM6z"><mtd columnalign="center" xml:id="XM6aa"><mrow xml:id="XM6n"><mi mathvariant="bold" xml:id="XM6h">a</mi><mo xml:id="XM6i">⁢</mo><mrow xml:id="XM6m"><mo stretchy="false" xml:id="XM6j">(</mo><mi mathvariant="bold" xml:id="XM3">v</mi><mo xml:id="XM6k">,</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">n</mi></msub><mo stretchy="false" xml:id="XM6l">)</mo></mrow></mrow></mtd></mtr><mtr xml:id="XM6ab"><mtd columnalign="center" xml:id="XM6ac"><mrow xml:id="XM6t"><mi xml:id="XM6o">k</mi><mo xml:id="XM6p">⁢</mo><mrow xml:id="XM6s"><mo stretchy="false" xml:id="XM6q">(</mo><mi mathvariant="bold" xml:id="XM5">v</mi><mo stretchy="false" xml:id="XM6r">)</mo></mrow></mrow></mtd></mtr></mtable><mo>)</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span>, </p>

<p>to distinguish the two different roles of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span> (suppressing the intermediate variable <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span>), and we’ll refer to the two different partial derivatives that relate to <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span> as <!-- 91c99d13b0900ad1158d1d9284a04372.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})=\left.\frac{\partial\mathbf{A}_{i}}%&#10;{\partial\mathbf{v}}\right|_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi mathvariant="bold">v</mi></mrow></mfrac><mo fence="true">|</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span> and <!-- 3872cc666f25d51ff05ebdbfe50052d8.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\partial_{2}\mathbf{A}_{i}(\mathbf{u}_{i})=\left.\frac{\partial\mathbf{A}_{i}}%&#10;{\partial\mathbf{u}_{i}}\right|_{\mathbf{v}=\mathbf{u}_{i}}" display="inline"><mrow><mrow><mrow><msub><mo>∂</mo><mn>2</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msub><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></mfrac><mo fence="true">|</mo></mrow><mrow><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow></msub></mrow></math></span>.</p>

<p>So first of all, if we use <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></math></span> as an intermediate variable, the dynamics of <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span> is</p>

<p><!-- 90f362ca22650ccd96c23cdb2bb06fb5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{u}_{i}}{dt}=\gamma\hat{X}_{i}\partial_{1}\mathscr{I}(\mathbf{u}%&#10;_{i})^{T}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathscript" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span></p>

<p><!-- b7d54b581c0c2b9ca3077735434a8e66.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}(\partial_{1}\mathscr{I}(\mathbf{A}_{i})\partial_{1}\mathbf{%&#10;A}_{i}(\mathbf{u}_{i}))^{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><mrow xml:id="XM3w"><mrow xml:id="XM3d"><msub xml:id="XM3b"><mo xml:id="XM3">∂</mo><mn xml:id="XM3a">1</mn></msub><mo xml:id="XM3e">⁡</mo><mi class="ltx_font_mathscript" mathvariant="script" xml:id="XM3c">I</mi></mrow><mo xml:id="XM3f">⁢</mo><mrow xml:id="XM3i"><mo stretchy="false" xml:id="XM3g">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">A</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false" xml:id="XM3h">)</mo></mrow><mo xml:id="XM3j">⁢</mo><mrow xml:id="XM3q"><msub xml:id="XM3m"><mo xml:id="XM3k">∂</mo><mn xml:id="XM3l">1</mn></msub><mo xml:id="XM3r">⁡</mo><msub xml:id="XM3p"><mi mathvariant="bold" xml:id="XM3n">A</mi><mi xml:id="XM3o">i</mi></msub></mrow><mo xml:id="XM3s">⁢</mo><mrow xml:id="XM3v"><mo stretchy="false" xml:id="XM3t">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false" xml:id="XM3u">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span></p>

<p><!-- 67d1d6428c6cec5641f6dce25d4e7e89.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})^{T}\partial_{1}%&#10;\mathscr{I}(\mathbf{A}_{i})^{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathscript" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">A</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></math></span>.</p>

<p>Then</p>

<p><!-- a11db3a699f1eef5bc5c388d11dc44db.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{A}_{i}}{dt}=\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})\frac{d%&#10;\mathbf{u}_{i}}{dt}+\sum_{j=1}^{n}\partial_{2}\mathbf{A}_{i}(\mathbf{u}_{j})%&#10;\frac{d\mathbf{u}_{j}}{dt}" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow><mo>+</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mrow><msub><mo>∂</mo><mn>2</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">j</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">u</mi><mi>j</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow></mrow></mrow></mrow></math></span></p>

<p><!-- 0c922044d40deff606c3d26992690a2f.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})\partial_{1}%&#10;\mathbf{A}_{i}(\mathbf{u}_{i})^{T}\partial_{1}\mathcal{I}(\mathbf{A}_{i})^{T}+%&#10;\sum_{j=1}^{n}\gamma\hat{X}_{j}\partial_{2}\mathbf{A}_{i}(\mathbf{u}_{j})%&#10;\partial_{1}\mathbf{A}_{j}(\mathbf{u}_{j})^{T}\partial_{1}\mathcal{I}(\mathbf{%&#10;A}_{j})^{T}" display="inline"><mrow><mi/><mo>=</mo><mrow><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM3b"><mi mathvariant="bold" xml:id="XM3">A</mi><mi xml:id="XM3a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow><mo>+</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>j</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>2</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">j</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>j</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM5b"><mi mathvariant="bold" xml:id="XM5">u</mi><mi xml:id="XM5a">j</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><mi class="ltx_font_mathcaligraphic" mathvariant="script">I</mi></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM6b"><mi mathvariant="bold" xml:id="XM6">A</mi><mi xml:id="XM6a">j</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup></mrow></mrow></mrow></mrow></math></span></p>

<p><!-- 780c03822b134c555ec35f8e114125e7.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="=\gamma\hat{X}_{i}\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})\partial_{1}%&#10;\mathbf{A}_{i}(\mathbf{u}_{i})^{T}S(\mathbf{A}_{i})+\sum_{j=1}^{n}\gamma\hat{X%&#10;}_{j}\partial_{2}\mathbf{A}_{i}(\mathbf{u}_{j})\partial_{1}\mathbf{A}_{j}(%&#10;\mathbf{u}_{j})^{T}S(\mathbf{A}_{j})" display="inline"><mrow><mi/><mo>=</mo><mrow><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">i</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM3b"><mi mathvariant="bold" xml:id="XM3">A</mi><mi xml:id="XM3a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>j</mi></msub><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>2</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM4b"><mi mathvariant="bold" xml:id="XM4">u</mi><mi xml:id="XM4a">j</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo>∂</mo><mn>1</mn></msub><mo>⁡</mo><msub><mi mathvariant="bold">A</mi><mi>j</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo stretchy="false">(</mo><msub xml:id="XM5b"><mi mathvariant="bold" xml:id="XM5">u</mi><mi xml:id="XM5a">j</mi></msub><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM6b"><mi mathvariant="bold" xml:id="XM6">A</mi><mi xml:id="XM6a">j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></math></span>.</p>

<p>This expression is made up of two somewhat complex terms.  The first term, the <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">A</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> term, expresses the change in the interactions experienced by population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> due to change in population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> in its patient role.  I refer to this as the ‘'’direct effect’’’ of selection on population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>.  The second term, the sum of <!-- 3cd8abd42f5793e6e9880832b1b5fb45.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{j})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">A</mi><mi xml:id="XM1a">j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> vectors, expresses the change in population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span>’s interactions due to change in all the different agents it encounters, including population <!-- 865c0c0b4ab0e063e5caa3387c1a8741.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="i" display="inline"><mi>i</mi></math></span> itself in its agent role.  I refer to this as an ‘'’indirect effect’’’ of selection on the various populations.</p>

<p>What would happen if there were no constraints on <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></math></span>?  That is, if all the terms just mutate independently without being constrained by dependence on <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> variables.  In this case, we would simply have</p>

<p><!-- 4f5d7571bbf4e82c606002748c75c0a4.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{A}_{i}}{dt}=\gamma\hat{X}_{i}S(\mathbf{A}_{i})" display="inline"><mrow><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mi>γ</mi><mo>⁢</mo><msub><mover accent="true"><mi>X</mi><mo stretchy="false">^</mo></mover><mi>i</mi></msub><mo>⁢</mo><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">A</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math></span>.</p>

<p>In the constrained case, as with <!-- ac9cc699ed1c171886cf92f2a6433917.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{p}" display="inline"><mi mathvariant="bold">p</mi></math></span>, the motion due to <!-- 9dbdd0e42a9f1219a70747a0f6dd5f93.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="S(\mathbf{A}_{i})" display="inline"><mrow><mi>S</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">A</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span> is modified by a transformation matrix.  Here, though, there’s also another term dealing with the effect of changing <!-- b103594657ee76b9b94b3b549bc7d2e5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}" display="inline"><mi mathvariant="bold">u</mi></math></span> values as the second argument to <!-- 08fdd9337547a3f93fea9d7aec33d0b0.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="a(\mathbf{u}_{i},\mathbf{u}_{j})" display="inline"><mrow><mi>a</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo>,</mo><msub xml:id="XM2b"><mi mathvariant="bold" xml:id="XM2">u</mi><mi xml:id="XM2a">j</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>.  Let’s expand that out one step further:</p>

<p><!-- 0281a12bf85776094882c7d52badd318.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}{\color{blue}\frac{d%&#10;\mathbf{A}_{i}}{dt}}={\color{green!70!black}\gamma\hat{X}_{i}\partial_{1}%&#10;\mathbf{A}_{i}(\mathbf{u}_{i})\partial_{1}\mathbf{A}_{i}(\mathbf{u}_{i})^{T}S(%&#10;\mathbf{A}_{i})+{\color{violet}\sum_{j=1}^{n}\gamma\hat{X}_{j}\partial_{2}%&#10;\mathbf{A}_{i}(\mathbf{u}_{j})\partial_{1}\mathbf{A}_{j}(\mathbf{u}_{j})^{T}S(%&#10;\mathbf{A}_{j})}\]\end{document}" display="inline"><mrow><mfrac mathcolor="#0000FF"><mrow><mi mathcolor="#0000FF">d</mi><mo mathcolor="#0000FF">⁢</mo><msub><mi mathcolor="#0000FF" mathvariant="bold">A</mi><mi mathcolor="#0000FF">i</mi></msub></mrow><mrow><mi mathcolor="#0000FF">d</mi><mo mathcolor="#0000FF">⁢</mo><mi mathcolor="#0000FF">t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mi mathcolor="#00B300">γ</mi><mo>⁢</mo><msub><mover accent="true"><mi mathcolor="#00B300">X</mi><mo mathcolor="#00B300" stretchy="false">^</mo></mover><mi mathcolor="#00B300">i</mi></msub><mo>⁢</mo><mrow><msub><mo mathcolor="#00B300">∂</mo><mn mathcolor="#00B300">1</mn></msub><mo>⁡</mo><msub><mi mathcolor="#00B300" mathvariant="bold">A</mi><mi mathcolor="#00B300">i</mi></msub></mrow><mo>⁢</mo><mrow><mo mathcolor="#00B300" stretchy="false">(</mo><msub xml:id="XM1b"><mi mathcolor="#00B300" mathvariant="bold" xml:id="XM1">u</mi><mi mathcolor="#00B300" xml:id="XM1a">i</mi></msub><mo mathcolor="#00B300" stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo mathcolor="#00B300">∂</mo><mn mathcolor="#00B300">1</mn></msub><mo>⁡</mo><msub><mi mathcolor="#00B300" mathvariant="bold">A</mi><mi mathcolor="#00B300">i</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo mathcolor="#00B300" stretchy="false">(</mo><msub xml:id="XM2b"><mi mathcolor="#00B300" mathvariant="bold" xml:id="XM2">u</mi><mi mathcolor="#00B300" xml:id="XM2a">i</mi></msub><mo mathcolor="#00B300" stretchy="false">)</mo></mrow><mi mathcolor="#00B300">T</mi></msup><mo>⁢</mo><mi mathcolor="#00B300">S</mi><mo>⁢</mo><mrow><mo mathcolor="#00B300" stretchy="false">(</mo><msub xml:id="XM3b"><mi mathcolor="#00B300" mathvariant="bold" xml:id="XM3">A</mi><mi mathcolor="#00B300" xml:id="XM3a">i</mi></msub><mo mathcolor="#00B300" stretchy="false">)</mo></mrow></mrow><mo mathcolor="#00B300">+</mo><mrow><munderover><mo largeop="true" mathcolor="#800080" movablelimits="false" symmetric="true">∑</mo><mrow><mi mathcolor="#800080">j</mi><mo mathcolor="#800080">=</mo><mn mathcolor="#800080">1</mn></mrow><mi mathcolor="#800080">n</mi></munderover><mrow><mi mathcolor="#800080">γ</mi><mo>⁢</mo><msub><mover accent="true"><mi mathcolor="#800080">X</mi><mo mathcolor="#800080" stretchy="false">^</mo></mover><mi mathcolor="#800080">j</mi></msub><mo>⁢</mo><mrow><msub><mo mathcolor="#800080">∂</mo><mn mathcolor="#800080">2</mn></msub><mo>⁡</mo><msub><mi mathcolor="#800080" mathvariant="bold">A</mi><mi mathcolor="#800080">i</mi></msub></mrow><mo>⁢</mo><mrow><mo mathcolor="#800080" stretchy="false">(</mo><msub xml:id="XM4b"><mi mathcolor="#800080" mathvariant="bold" xml:id="XM4">u</mi><mi mathcolor="#800080" xml:id="XM4a">j</mi></msub><mo mathcolor="#800080" stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><msub><mo mathcolor="#800080">∂</mo><mn mathcolor="#800080">1</mn></msub><mo>⁡</mo><msub><mi mathcolor="#800080" mathvariant="bold">A</mi><mi mathcolor="#800080">j</mi></msub></mrow><mo>⁢</mo><msup><mrow><mo mathcolor="#800080" stretchy="false">(</mo><msub xml:id="XM5b"><mi mathcolor="#800080" mathvariant="bold" xml:id="XM5">u</mi><mi mathcolor="#800080" xml:id="XM5a">j</mi></msub><mo mathcolor="#800080" stretchy="false">)</mo></mrow><mi mathcolor="#800080">T</mi></msup><mo>⁢</mo><mi mathcolor="#800080">S</mi><mo>⁢</mo><mrow><mo mathcolor="#800080" stretchy="false">(</mo><msub xml:id="XM6b"><mi mathcolor="#800080" mathvariant="bold" xml:id="XM6">A</mi><mi mathcolor="#800080" xml:id="XM6a">j</mi></msub><mo mathcolor="#800080" stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></math></span></p>

<p><!-- 380f8ad1abb2423dfe57bc5c25521c10.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}={\color{green!70!black%&#10;}D(\mathbf{u}_{i})}+{\color{violet}I(\mathbf{u}_{i}|\mathbf{u}_{1},\ldots,%&#10;\mathbf{u}_{n})}" display="inline"><mrow><mo>=</mo><mi mathcolor="#00B300">D</mi><mrow><mo mathcolor="#00B300" stretchy="false">(</mo><msub><mi mathcolor="#00B300" mathvariant="bold">u</mi><mi mathcolor="#00B300">i</mi></msub><mo mathcolor="#00B300" stretchy="false">)</mo></mrow><mo>+</mo><mi mathcolor="#800080">I</mi><mrow><mo mathcolor="#800080" stretchy="false">(</mo><msub><mi mathcolor="#800080" mathvariant="bold">u</mi><mi mathcolor="#800080">i</mi></msub><mo mathcolor="#800080" stretchy="false">|</mo><msub><mi mathcolor="#800080" mathvariant="bold">u</mi><mn mathcolor="#800080">1</mn></msub><mo mathcolor="#800080">,</mo><mi mathcolor="#800080" mathvariant="normal" xml:id="XM3">…</mi><mo mathcolor="#800080">,</mo><msub><mi mathcolor="#800080" mathvariant="bold">u</mi><mi mathcolor="#800080">n</mi></msub><mo mathcolor="#800080" stretchy="false">)</mo></mrow></mrow></math></span>.</p>

<p>Here I’m using colors to distinguish three different vector quantities, which I’ll soon plot in the same colors:</p>

<ul>
  <li><span style="color:blue"><!-- fc4648b6fd1bea89612d790aa093e8a6.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{d\mathbf{A}_{i}}{dt}" display="inline"><mfrac><mrow><mi>d</mi><mo>⁢</mo><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></math></span>, the resultant change in <!-- ab28b50eced0b82e898b218dc7447d3d.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{A}_{i}" display="inline"><msub><mi mathvariant="bold">A</mi><mi>i</mi></msub></math></span></span>, blue.</li>
  <li><span style="color:green"><!-- 960a723e9dfc83ee4c5a4dcbead02ba5.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="D(\mathbf{u}_{i})" display="inline"><mrow><mi>D</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub xml:id="XM1b"><mi mathvariant="bold" xml:id="XM1">u</mi><mi xml:id="XM1a">i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>, the direct effect of change in <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span> as patient</span>, green.</li>
  <li><span style="color:purple"><!-- 194eb932e7b0601e6406b37444ed77ac.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="I(\mathbf{u}_{i}|\mathbf{u}_{1},\ldots,\mathbf{u}_{n})" display="inline"><mrow><mi>I</mi><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub><mo stretchy="false">|</mo><msub><mi mathvariant="bold">u</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal" xml:id="XM2">…</mi><mo>,</mo><msub><mi mathvariant="bold">u</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math></span>, the indirect effect of change in all agents <!-- 61147e839a95b0f4bc1a65e12a116666.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{j}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>j</mi></msub></math></span> including <!-- 9d2ac7a9365d62c02e6fcd5494793525.tex-math.latexml.html --><span class="latexml"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{u}_{i}" display="inline"><msub><mi mathvariant="bold">u</mi><mi>i</mi></msub></math></span></span>, purple.</li>
</ul>

<h2 id="supplementary-materials">Supplementary materials</h2>

<p>Here are the Sage classes that do the work for the Mac-Lev models. above.  They use generalized Sage machinery that’s stored at [[SageDynamics]].</p>

<p>Now here’s the MacArthur-Levins resource competition model.</p>

<p><!-- maclevmodels.py.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>maclevmodels.py.step</span></legend><div class="ww-collapsible-content"><pre># requires: $(SageDynamics)/dynamicalsystems.py $(SageAdaptiveDynamics)/adaptivedynamics.py
from sage.all import *
import os
import sys
 
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
from dynamicalsystems import *
sys.path.append( os.environ['SageAdaptiveDynamics'] )
from adaptivedynamics import *

from sage.symbolic.relation import solve
from sage.symbolic.function_factory import function

# functional forms used in the definitions of ResourceCompetitionModel
# and MacArthurLevinsModel

def c_var(i, l):
    return SR.var( 'c_%s_%s'%(i,l), latex_name='c_{%s%s}'%(i,l) )

def b_var(i):
    return SR.var( 'b_%s'%i )

def m_var(i):
    return SR.var( 'm_%s'%i )

class ResourceCompetitionModel(PopulationDynamicsSystem):
    &quot;&quot;&quot;The general resource competition model, with some number of
    populations and some number of resources.  The various parameters
    b_i, c_i_l, etc. may or may not be bound to numerical values.
    &quot;&quot;&quot;
    def __init__(self, x_indices=None, r_indices=None,
        X = indexer('X'),
        R = indexer('R'),
        b = indexer(b_var),
        m = indexer(m_var),
        w = indexer('w'),
        r = indexer('r'),
        K = indexer('K'),
        c = indexer_2d('c'),
        bindings=Bindings()):
        &quot;&quot;&quot;How to specify an instance of this model?

        x_indices: might, for instance, be [1, 2, 3], or might not.
        r_indices: likewise.
        X, R, b, etc: some kind of things that can implement operations
            such as, for example, X[i] where i is in x_indices.  These
            should return variables, functions, numbers, or other
            things that can be used in an expression.
        &quot;&quot;&quot;
        self._r_indices = r_indices
        self._indexers = dict( X=X, R=R, b=b, m=m, c=c, w=w, r=r, K=K )
        super(ResourceCompetitionModel, self).__init__(
            [R[l] for l in r_indices], x_indices, X,
            bindings = bindings )
    def flow(self):
        return self.make_flow(**self._indexers)
    def make_flow(self, X, R, b, c, m, r, w, K):
        X_flows = [ (X[i],
            b[i]*X[i]*(sum(c[i][l]*w[l]*R[l] for l in self._r_indices) - m[i]))
            for i in self._population_indices ]
        R_flows = [ (R[l],
            r[l]*(K[l] - R[l]) -
              sum(c[i][l]*X[i] for i in self._population_indices))
            for l in self._r_indices ]
        return dict(X_flows + R_flows)

class MacArthurLevinsModel(PopulationDynamicsSystem):
    &quot;&quot;&quot;The MacArthur-Levins model is constructed by separating timescales
    to remove the R_l variables from the dynamics&quot;&quot;&quot;
    def __init__(self, rescomp_model=None, **named_args):
        &quot;&quot;&quot;Give me a ResourceCompetitionModel with nx populations and
        nr resources, I will crunch it down into a MacArthurLevinsModel
        with nx populations.&quot;&quot;&quot;
        #print 'MacArthurLevinsModel', (rescomp_model, named_args)
        if rescomp_model is None:
            rescomp_model = ResourceCompetitionModel(**named_args)
        self._rescomp_model = rescomp_model
        self._r_indices = rescomp_model._r_indices
        super(MacArthurLevinsModel, self).__init__(
          [],
          rescomp_model._population_indices,
          rescomp_model._population_indexer,
          bindings = rescomp_model._bindings )
    def flow(self):
        # find the equilibrium values of R_l given the current values X_i
        R = [self._rescomp_model._indexers['R'][l] for l in self._r_indices]
        Rsolns = { R_l:self.solve_for_R(R_l) for R_l in R }
        #print 'R solns:', Rsolns
        # now substitute those values of R into the X equations
        reduced_flow = dict( (X_i,
              self._rescomp_model._flow[X_i].substitute_expression(Rsolns) )
            for X_i in self.population_vars() )
        # that's the Macarthur-Levins model.
        return reduced_flow
    def solve_for_R(self, R_l):
        &quot;&quot;&quot;solve for the equilibrium value of one R_l given the X_i values&quot;&quot;&quot;
        Rhat_soln = solve( 0 == self._rescomp_model._flow[R_l], R_l, solution_dict=True )
        # there should be just one solution
        assert len(Rhat_soln) == 1
        #print &quot;R-hat: %s&quot; % Rhat_soln[0][R_l]
        # put it in the bindings in case we want to plot R_l or something
        self._bindings[R_l] = Rhat_soln[0][R_l]
        # it's also its own equilibrium
        self._bindings[hat(R_l)] = self._rescomp_model.add_hats( Rhat_soln[0][R_l] )
        return Rhat_soln[0][R_l]
    def set_population_indices(self,xi):
        # need to pass this through to the res-comp system
        self._rescomp_model.set_population_indices(xi)
        super(MacArthurLevinsModel, self).set_population_indices(xi)

</pre></div></fieldset></p>

<p><!-- lotkavolterra.py.step --><fieldset class="ww-project-file-source ww-collapsible"><legend><span>lotkavolterra.py.step</span></legend><div class="ww-collapsible-content"><pre># requires: $(SageDynamics)/dynamicalsystems.py
# requires: $(SageAdaptiveDynamics)/adaptivedynamics.py
from sage.all import *
import os
import sys
 
sys.path.append( os.environ['SageUtils'] )
sys.path.append( os.environ['SageDynamics'] )
from dynamicalsystems import *
sys.path.append( os.environ['SageAdaptiveDynamics'] )
from adaptivedynamics import *

from sage.symbolic.relation import solve
#from sage.symbolic.function_factory import function

class GeneralizedLotkaVolterraModel(PopulationDynamicsSystem):
    &quot;&quot;&quot;The GLV model is dX_i/dt = (r_i + sum_j a_i_j X_j) X_i&quot;&quot;&quot;
    def __init__(self, x_indices = [], X = indexer('X'), r = indexer('r'),
      a = indexer_2d('a'),
      bindings = Bindings()):
        self._indexers = {'r': r, 'a': a, 'X': X}
        super(GeneralizedLotkaVolterraModel,self).__init__(
            [ ], x_indices, X, bindings=bindings )
    def flow(self):
        return self.make_flow(**self._indexers)
    def make_flow(self, X, r, a):
        return dict( (X[i],
          X[i]*(r[i] + sum( a[i][j]*X[j] for j in self._population_indices )))
          for i in self._population_indices)
    def interior_equilibrium_bindings( self, phenotype_bindings=Bindings() ):
	eq = self.bind( phenotype_bindings ).interior_equilibria()[0]
	eb = Bindings( { vhat:eq[vhat] for vhat in (hat(v) for v in self._vars) } )
	#print 'equilibrium bindings:', eb
	return eb

class LotkaVolterraException(Exception):
    def __init__(self, message):
	self.value = message
    def __str__(self):
	return repr(self.value)

def get_coeff( expr, vars, power ):
    for c, p in expr.coefficients( vars ):
        if p == power:
	    return c

class DerivedLotkaVolterraModel( GeneralizedLotkaVolterraModel ):
    &quot;&quot;&quot;This is a LotkaVolterraModel made by decomposing the dynamics of
    some other population dynamics model into linear and quadratic terms.
    It has the attributes of a GeneralizedLotkaVolterraModel, plus some
    additional information about the original model.&quot;&quot;&quot;
    def __init__(self, model, a_name='a', r_name='r'):
	self._original_model = model
	self._a_name = a_name
	self._r_name = r_name
	r_indexer = indexer(r_name)
	a_indexer = indexer_2d(a_name)
        x_indexer = model._population_indexer
        aij_dict = {}
        vars = {v:1 for v in model._vars}
        for i in model._population_indices:
            xi = x_indexer[i]
	    lvi = model._flow[xi].expand()
            print 'Inferring LV coefficients from', xi, 'equation:', lvi
	    ri = xic = get_coeff( lvi, xi, 1 )
	    aij = aij_dict[a_indexer[i][i]] = get_coeff( lvi, xi, 2 )
            lvi -= aij * xi**2
	    for j in model._population_indices:
	        if j != i:
                    xj = x_indexer[j]
		    ri = get_coeff( ri, xj, 0 )
		    aij = aij_dict[a_indexer[i][j]] = get_coeff( xic, xj, 1 )
                    print a_indexer[i][j], ':', aij
                    lvi -= aij * xi * xj
            print r_indexer[i], ':', ri
	    aij_dict[r_indexer[i]] = ri
            lvi -= ri * xi
            if lvi != 0:
                raise LotkaVolterraException( &quot;Population dynamics has excess terms in &quot; + str(i) + &quot;'th component: &quot; + str(lvi) )
            del vars[xi]
        if len(vars) &gt; 0:
            raise LotkaVolterraException( &quot;Population dynamics has extra variables: &quot; + ', '.join(vars.keys()) )
	self._A_bindings = Bindings( aij_dict ) 
        super(DerivedLotkaVolterraModel,self).__init__(
            model._population_indices,
            r = r_indexer,
            a = a_indexer
	)

class LotkaVolterraAdaptiveDynamics( object ):
    '''Not an AdaptiveDynamicsModel class, but a helper that works with one.'''
    def __init__( self, ad, lv_model=None, r_name='r', a_name='a' ):
        self._adaptivedynamics = ad

	print 'ad bindings:', self._adaptivedynamics._bindings
	print 'model bindings:', self._adaptivedynamics._popdyn_model._bindings
	print '_early_bindings:', self._adaptivedynamics._early_bindings
	print '_late_bindings:', self._adaptivedynamics._late_bindings

	# make LV model here
	print 'make LV model'
	self._lv_model = DerivedLotkaVolterraModel( ad._popdyn_model, r_name=r_name, a_name=a_name )

	print '_A_bindings:', self._lv_model._A_bindings

	# for now, this only supports AD with a single phenotype variable
	u_indexer = self._adaptivedynamics._phenotype_indexers[0]

	# sanity check the a values' functional form
	# using extended system, in case it's only 1-d otherwise
	extended_lv_model = DerivedLotkaVolterraModel( ad._extended_system, r_name=r_name, a_name=a_name )
	a_to_u_bindings = self._adaptivedynamics._bindings + self._adaptivedynamics._late_bindings + extended_lv_model._A_bindings
	print 'a_to_u_bindings:', a_to_u_bindings
        a_func = a_to_u_bindings( extended_lv_model._indexers['a'][0]['i'] ).function( u_indexer[0], u_indexer['i'] )
	print 'a_func:', a_func
	r_func = a_to_u_bindings( extended_lv_model._indexers['r'][0] ).function( u_indexer[0] )
	print 'r_func:', r_func
	for i in ad._popdyn_model._population_indices:
	    for j in ad._popdyn_model._population_indices:
	        if a_to_u_bindings( extended_lv_model._indexers['a'][i][j] ) != a_func( u_indexer[i], u_indexer[j] ):
		    raise LotkaVolterraException(
			'Model does not have consistent form a(u_i,u_j): ' +
			str( a_to_u_bindings( extended_lv_model._indexers['a'][i][j] ) ) +
			' does not have the form of ' +
                        'a(%s, %s) = ' % (u_indexer[i], u_indexer[j]) +
			str( a_func( u_indexer[i], u_indexer[j] ) ) )
		if a_to_u_bindings( extended_lv_model._indexers['r'][i] ) != r_func( u_indexer[i] ):
		    raise LotkaVolterraException(
			'Model does not have consistent form r(u_i): ' +
			str( a_to_u_bindings( extended_lv_model._indexers['r'][i] ) ) +
			' does not have the form of ' +
			str( r_func( u_indexer[i] ) ) )
	        for k in ad._popdyn_model._population_indices:
		    if len( extended_lv_model._A_bindings( extended_lv_model._indexers['a'][i][j] ).coefficients( extended_lv_model._population_indexer[k] ) ) &gt; 1:
		        raise LotkaVolterraException( 'Model has super-quadratic terms in population variables' )
	self._A_function_expansion_bindings = Bindings( FunctionBindings( { a_name: a_func, r_name: r_func } ) )

	print 'make LV adaptive dynamics'
	class indexer_2d_backwards(indexer_2d):
	    def __getitem__(self, j):
		class subindexer(indexer):
		    def __init__(self, name, j):
			self._name = name
			self._j = j
		    def __getitem__(self, i):
			return SR.var( '{0}_{1}_{2}'.format( self._name, i, self._j ),
			    latex_name='%s_\{%s%s\}' % ( self._name, i, self._j ) )
		return subindexer( self._f, j )
        formal_equilibrium = Bindings( { v : hat(v) for v in self._lv_model.population_vars() } )
	self._lv_adap = AdaptiveDynamicsModel(
	    self._lv_model,
	    [ self._lv_model._indexers['r'] ] + [ indexer_2d_backwards('a')[j] for j in self._lv_model._population_indices ],
            equilibrium = formal_equilibrium )
	# todo: what to do with multiple phenotype indexers?
	print 'make LV evolution bindings'
	ui = self._adaptivedynamics._phenotype_indexers[0]
	# _A_to_function_bindings expands the LV equations
	# into functions of u_i, e.g. from a_i_j to a(u_i,u_j)
	# very necessary so that partial derivatives can be taken
	self._A_to_function_bindings = Bindings( dict( [
	  ( self._lv_model._indexers['a'][i][j], 
	    self._lv_model._A_bindings( function( a_name )( ui[i], ui[j] ) ) )
	  for i in self._lv_model._population_indices
	  for j in self._lv_model._population_indices ] + [
	  ( self._lv_model._indexers['r'][i],
	    self._lv_model._A_bindings( function( r_name )( ui[i] ) ) )
	  for i in self._lv_model._population_indices ] ) )
	#print '_A_to_function_bindings:', self._A_to_function_bindings
	#print '_A_function_expansion_bindings:', self._A_function_expansion_bindings
	# _phenotypes_to_fn_bindings: changes u_i to u_i(t)
	# is used in all the below methods, so that du_i(t)/dt works
	self._phenotypes_to_fn_bindings = Bindings( dict(
	    ( u[i], function( str(u[i]), self._adaptivedynamics._time_variable ) )
	    for i in self._lv_model._population_indices
	    for u in self._adaptivedynamics._phenotype_indexers ) )
	# _phenotypes_from_fn_bindings: the inverse, change u_i(t) to u_i
	self._phenotypes_from_fn_bindings = Bindings(
	    { v:k for k, v in self._phenotypes_to_fn_bindings.items() } )
	#print '_phenotypes_from_fn_bindings:', self._phenotypes_from_fn_bindings
    def A( self, i ):
        return column_vector(
            [ self._lv_model._indexers['r'][i] ] +
            [ self._lv_model._indexers['a'][i][j] for j in self._lv_model._population_indices ] )
    def S( self, A ):
        return column_vector( [ self._lv_adap._S[a] for a in A ] )
    def d1A( self, i ):
	'''&quot;Direct effect&quot;: derivative of A(u_i) wrt u_i with u_i in the &quot;patient&quot;
        position, as the first argument of a(.,.).'''
        A_ij = self._A_to_function_bindings( self.A(i) )
	ui = self._adaptivedynamics._phenotype_indexers[0][i]
	ux = self._adaptivedynamics._phenotype_indexers[0]['x']
	#print 'hack A_ij: from', A_ij
        A_ij_hacked = A_ij.apply_map( lambda x: x.subs_expr( function( self._lv_model._a_name )(ui,ui) == function( self._lv_model._a_name )(ui,ux) ) )
	#print 'to', A_ij_hacked
	#print 'd1A: derivative of $%s$ wrt $%s$' % (latex(A_ij_hacked), latex(ui))
        d1a = A_ij_hacked.derivative( ui )
	#print 'is $%s$' % latex( d1a )
	d = self._A_function_expansion_bindings( d1a.subs( ux == ui ) )
	#print ': $%s$' % latex( d )
	return d
    def direct_effect( self, i ):
	return self._phenotypes_to_fn_bindings( self.d1A(i) ).apply_map( lambda x: x * derivative(
	        self._phenotypes_to_fn_bindings( self._adaptivedynamics._phenotype_indexers[0][i] ),
	        self._adaptivedynamics._time_variable
	    ) )
    def d2A_component( self, i, j ):
        '''Component of &quot;Indirect effects&quot; on &quot;patient&quot; u_i, due to &quot;agent&quot; u_j.
        When j is i, this includes only the &quot;agent&quot; role of u_i, which is where
        it appears as the second argument of a().'''
        A_ij = self._A_to_function_bindings( self.A(i) )
	u = self._adaptivedynamics._phenotype_indexers[0]
        if j == i:
	    ui = u[i]
            ux = u['x']
            A_ij_hacked = A_ij.apply_map( lambda x: x.subs_expr( function( self._lv_model._a_name )(ui,ui) == function( self._lv_model._a_name )(ui,ux) ) )
	    #print 'd2A: derivative of $%s$ wrt $%s$' %(latex(A_ij_hacked), latex(ux))
            d2A_hacked = A_ij_hacked.derivative( ux )
	    #print 'is $%s$' % latex(d2A_hacked)
            d2A = d2A_hacked.subs( ux == ui )
            #ltx.write( 'on diagonal: $\partial_2 A = %s$\n\n' % latex( d2A ) )
        else:
	    #print 'd2A: derivative of $%s$ wrt $%s$' %(latex(A_ij), latex(u[j]))
            d2A = A_ij.derivative( u[j] )
	    #print 'is $%s$'% latex( d2A )
            #ltx.write( 'off diagonal: $\partial_2 A = %s$\n\n' % latex( d2A ) )
	return self._A_function_expansion_bindings( d2A )
    def indirect_effect( self, i ):
	components = [ self._phenotypes_to_fn_bindings( self.d2A_component( i, j ) ).apply_map( lambda x: x * derivative(
	        self._phenotypes_to_fn_bindings( self._adaptivedynamics._phenotype_indexers[0][j] ),
	        self._adaptivedynamics._time_variable
	    ) ) for j in self._lv_model._population_indices ]
	import operator
	return reduce( operator.add, components )
    def dudt_bindings( self ):
	# TODO: AD class should provide one of these, and
	# use it internally as well
	return Bindings( dict(
	    ( derivative( self._phenotypes_to_fn_bindings( self._adaptivedynamics._phenotype_indexers[0][i] ), self._adaptivedynamics._time_variable ),
	      ( SR('gamma') * hat( self._lv_model._population_indexer[i] ) *
		self.d1A(i).transpose().dot_product( self.S( self.A(i) ).transpose() ) )
	    ) for i in self._lv_model._population_indices ) )
    def dAdt( self, i ):
        Ai = self.A(i)
	Au = self._adaptivedynamics._bindings( self._lv_model._A_bindings( Ai ) )
	u = self._adaptivedynamics._phenotype_indexers[0]
	#import operator
        dAdus = [ self._phenotypes_to_fn_bindings( diff( Au, u[j] ) ) for j in self._lv_model._population_indices ]
        dudts = [ diff( self._phenotypes_to_fn_bindings( u[j] ), self._adaptivedynamics._time_variable ) for j in self._lv_model._population_indices ]
        # need: column_vector * scalar
        dAdts = [ column_vector( dAidu * dudt for dAidu in dAdu ) for dAdu, dudt in zip( dAdus, dudts ) ]
	d = reduce( operator.add, dAdts )
	#print 'dAdt: diff of Au is $%s$' % latex( d )
        sys.stdout.flush()
	return d
</pre></div></fieldset></p>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Lee Worden</h2>

    <div class="footer-col-1 column">
      <ul>
        <li><a href="mailto:worden.lee@gmail.com">worden.lee@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/worden-lee">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">worden-lee</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/leeworden">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">leeworden</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
	    <p class="text"><!-- Any additional text --></p>
    </div>

  </div>

</footer>


    </body>
</html>
