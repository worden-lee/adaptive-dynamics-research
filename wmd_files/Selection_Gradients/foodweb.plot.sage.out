flow at initial conditions: {u_0_b: 0.00615637396182532, u_0_a: 0.00684041551313924}
ad bindings: {gamma -> 1, m -> 1, Xhat_0_a -> 25/9/(2*cos(-u_0_a + u_0_b) + 5), Xhat_0_b -> 5/9*(9*cos(-u_0_a + u_0_b) + 10)/(2*cos(-u_0_a + u_0_b) + 5)^2, k -> 9/10, r -> 1, f(u,v) -> 4/5*cos(u - v) + 2}
model bindings: {m -> 1, r -> 1}
_early_bindings: {k -> 9/10, f(u,v) -> 4/5*cos(u - v) + 2}
_late_bindings: {}
make LV model
Inferring LV coefficients from X_0_b equation: X_0_a*X_0_b*k*f(u_0_b, u_0_a) - X_0_b
a_0_b_0_a : k*f(u_0_b, u_0_a)
r_0_b : -1
Inferring LV coefficients from X_0_a equation: -X_0_a*X_0_b*f(u_0_b, u_0_a) - X_0_a^2 + X_0_a
a_0_a_0_b : -f(u_0_b, u_0_a)
r_0_a : 1
aij_dict: {a_0_b_0_a: k*f(u_0_b, u_0_a), a_0_a_0_b: -f(u_0_b, u_0_a), a_0_b_0_b: 0, r_0_b: -1, r_0_a: 1, a_0_a_0_a: -1}
set_population_indices: [(b, 0), (a, 0)]
Inferring LV coefficients from X_0_b equation: X_0_a*X_0_b*k*f(u_0_b, u_0_a) - X_0_b
a_0_b_0_a : k*f(u_0_b, u_0_a)
r_0_b : -1
Inferring LV coefficients from X_0_a equation: -X_0_a*X_0_b*f(u_0_b, u_0_a) - X_0_a^2 + X_0_a
a_0_a_0_b : -f(u_0_b, u_0_a)
r_0_a : 1
aij_dict: {a_0_b_0_a: k*f(u_0_b, u_0_a), a_0_a_0_b: -f(u_0_b, u_0_a), a_0_b_0_b: 0, r_0_b: -1, r_0_a: 1, a_0_a_0_a: -1}
_A_bindings: {a_0_b_0_b -> 0, a_0_b_0_a -> k*f(u_0_b, u_0_a), a_0_a_0_b -> -f(u_0_b, u_0_a), r_0_a -> 1, r_0_b -> -1, a_0_a_0_a -> -1}
make LV adaptive dynamics
population vars [X_0_b, X_0_a]
population vars [X_0_b, X_0_a]
set_population_indices: [(b, 0), (a, 0), (b, 1)]
basal: [a]
set_population_indices: [(b, 0), (a, 0), (b, 1)]
Inferring LV coefficients from X_0_b equation: X_0_a*X_0_b*k*f(u_0_b, u_0_a) - X_0_b
a_0_b_0_a : k*f(u_0_b, u_0_a)
a_0_b_1_b : 0
r_0_b : -1
Inferring LV coefficients from X_0_a equation: -X_0_a*X_0_b*f(u_0_b, u_0_a) - X_0_a*X_1_b*f(u_1_b, u_0_a) - X_0_a^2 + X_0_a
a_0_a_0_b : -f(u_0_b, u_0_a)
a_0_a_1_b : -f(u_1_b, u_0_a)
r_0_a : 1
Inferring LV coefficients from X_1_b equation: X_0_a*X_1_b*k*f(u_1_b, u_0_a) - X_1_b
a_1_b_0_b : 0
a_1_b_0_a : k*f(u_1_b, u_0_a)
r_1_b : -1
aij_dict: {a_1_b_0_a: k*f(u_1_b, u_0_a), a_0_a_0_a: -1, a_0_a_0_b: -f(u_0_b, u_0_a), a_0_a_1_b: -f(u_1_b, u_0_a), a_0_b_1_b: 0, a_0_b_0_b: 0, a_1_b_0_b: 0, a_1_b_1_b: 0, r_0_b: -1, r_0_a: 1, r_1_b: -1, a_0_b_0_a: k*f(u_0_b, u_0_a)}
The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{1b}}\frac{dX_{1b}}{dt} &= X_{0a} a_{1b0a} + X_{0b} a_{1b0b} + X_{1b} a_{1b1b} + r_{1b} 
\end{align*}

limit as {a_1_b_0_a: a_0_b_0_a, a_1_b_0_b: a_0_b_0_b, r_1_b: r_0_b}
after those limits:
   1
  X_0_b
  X_0_a
set_population_indices: [(b, 0), (a, 0), (a, 1)]
basal: [a]
set_population_indices: [(b, 0), (a, 0), (a, 1)]
Inferring LV coefficients from X_0_b equation: X_0_a*X_0_b*k*f(u_0_b, u_0_a) + X_0_b*X_1_a*k*f(u_0_b, u_1_a) - X_0_b
a_0_b_0_a : k*f(u_0_b, u_0_a)
a_0_b_1_a : k*f(u_0_b, u_1_a)
r_0_b : -1
Inferring LV coefficients from X_0_a equation: -X_0_a*X_0_b*f(u_0_b, u_0_a) - X_0_a^2 - X_0_a*X_1_a + X_0_a
a_0_a_0_b : -f(u_0_b, u_0_a)
a_0_a_1_a : -1
r_0_a : 1
Inferring LV coefficients from X_1_a equation: -X_0_b*X_1_a*f(u_0_b, u_1_a) - X_0_a*X_1_a - X_1_a^2 + X_1_a
a_1_a_0_b : -f(u_0_b, u_1_a)
a_1_a_0_a : -1
r_1_a : 1
aij_dict: {a_0_b_0_a: k*f(u_0_b, u_0_a), a_0_a_0_b: -f(u_0_b, u_0_a), r_1_a: 1, a_0_b_1_a: k*f(u_0_b, u_1_a), a_1_a_0_b: -f(u_0_b, u_1_a), a_1_a_1_a: -1, a_0_b_0_b: 0, a_0_a_1_a: -1, r_0_b: -1, r_0_a: 1, a_1_a_0_a: -1, a_0_a_0_a: -1}
The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{1a}}\frac{dX_{1a}}{dt} &= X_{0a} a_{1a0a} + X_{0b} a_{1a0b} + X_{1a} a_{1a1a} + r_{1a} 
\end{align*}

limit as {a_1_a_0_a: a_0_a_0_a, a_1_a_0_b: a_0_a_0_b, r_1_a: r_0_a}
after those limits:
   1
  X_0_b
  X_0_a
Original pop-dyn system: 
\[\iflatexml
\begin{align*}
\frac{dX_{0b}}{dt} &= {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + r_{0b}\right)} X_{0b}\\
\frac{dX_{0a}}{dt} &= {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + r_{0a}\right)} X_{0a}
\end{align*}
\else
\begin{dgroup*}
\begin{dmath*}
\frac{dX_{0b}}{dt} = {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + r_{0b}\right)} X_{0b}\end{dmath*}
\begin{dmath*}
\frac{dX_{0a}}{dt} = {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + r_{0a}\right)} X_{0a}
\end{dmath*}
\end{dgroup*}
\fi
\]
Extended pop-dyn system: 
\[\iflatexml
\begin{align*}
\frac{dX_{0b}}{dt} &= {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + X_{1b} a_{0b1b} + r_{0b}\right)} X_{0b}\\
\frac{dX_{0a}}{dt} &= {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + X_{1b} a_{0a1b} + r_{0a}\right)} X_{0a}\\
\frac{dX_{1b}}{dt} &= {\left(X_{0a} a_{1b0a} + X_{0b} a_{1b0b} + X_{1b} a_{1b1b} + r_{1b}\right)} X_{1b}
\end{align*}
\else
\begin{dgroup*}
\begin{dmath*}
\frac{dX_{0b}}{dt} = {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + X_{1b} a_{0b1b} + r_{0b}\right)} X_{0b}\end{dmath*}
\begin{dmath*}
\frac{dX_{0a}}{dt} = {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + X_{1b} a_{0a1b} + r_{0a}\right)} X_{0a}\end{dmath*}
\begin{dmath*}
\frac{dX_{1b}}{dt} = {\left(X_{0a} a_{1b0a} + X_{0b} a_{1b0b} + X_{1b} a_{1b1b} + r_{1b}\right)} X_{1b}
\end{dmath*}
\end{dgroup*}
\fi
\]
 The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{1b}}\frac{dX_{1b}}{dt} &= X_{0a} a_{1b0a} + X_{0b} a_{1b0b} + X_{1b} a_{1b1b} + r_{1b} 
\end{align*}
 And the invasion exponent is
\begin{align*}
  \frac{\partial\mathscr I}{\partial r_{0b}} = \lim_{r_{1b}\to r_{0b},a_{1b0b}\to a_{0b0b},a_{1b0a}\to a_{0b0a},X_{1b}\to0}1\\
  \frac{\partial\mathscr I}{\partial a_{0b0b}} = \lim_{r_{1b}\to r_{0b},a_{1b0b}\to a_{0b0b},a_{1b0a}\to a_{0b0a},X_{1b}\to0}X_{0b}\\
  \frac{\partial\mathscr I}{\partial a_{0b0a}} = \lim_{r_{1b}\to r_{0b},a_{1b0b}\to a_{0b0b},a_{1b0a}\to a_{0b0a},X_{1b}\to0}X_{0a} .
\end{align*}
 Which comes out to
\begin{align*}
  \frac{\partial\mathscr I}{\partial r_{0b}} = 1\\
  \frac{\partial\mathscr I}{\partial a_{0b0b}} = X_{0b}\\
  \frac{\partial\mathscr I}{\partial a_{0b0a}} = X_{0a} .
\end{align*}
 Original pop-dyn system: 
\[ \iflatexml
\begin{align*}
\frac{dX_{0b}}{dt} &= {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + r_{0b}\right)} X_{0b}\\
\frac{dX_{0a}}{dt} &= {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + r_{0a}\right)} X_{0a}
\end{align*}
\else
\begin{dgroup*}
\begin{dmath*}
\frac{dX_{0b}}{dt} = {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + r_{0b}\right)} X_{0b}\end{dmath*}
\begin{dmath*}
\frac{dX_{0a}}{dt} = {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + r_{0a}\right)} X_{0a}
\end{dmath*}
\end{dgroup*}
\fi
 \]
 Extended pop-dyn system: 
\[ \iflatexml
\begin{align*}
\frac{dX_{0b}}{dt} &= {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + X_{1a} a_{0b1a} + r_{0b}\right)} X_{0b}\\
\frac{dX_{0a}}{dt} &= {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + X_{1a} a_{0a1a} + r_{0a}\right)} X_{0a}\\
\frac{dX_{1a}}{dt} &= {\left(X_{0a} a_{1a0a} + X_{0b} a_{1a0b} + X_{1a} a_{1a1a} + r_{1a}\right)} X_{1a}
\end{align*}
\else
\begin{dgroup*}
\begin{dmath*}
\frac{dX_{0b}}{dt} = {\left(X_{0a} a_{0b0a} + X_{0b} a_{0b0b} + X_{1a} a_{0b1a} + r_{0b}\right)} X_{0b}\end{dmath*}
\begin{dmath*}
\frac{dX_{0a}}{dt} = {\left(X_{0a} a_{0a0a} + X_{0b} a_{0a0b} + X_{1a} a_{0a1a} + r_{0a}\right)} X_{0a}\end{dmath*}
\begin{dmath*}
\frac{dX_{1a}}{dt} = {\left(X_{0a} a_{1a0a} + X_{0b} a_{1a0b} + X_{1a} a_{1a1a} + r_{1a}\right)} X_{1a}
\end{dmath*}
\end{dgroup*}
\fi
 \]
 The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{1a}}\frac{dX_{1a}}{dt} &= X_{0a} a_{1a0a} + X_{0b} a_{1a0b} + X_{1a} a_{1a1a} + r_{1a} 
\end{align*}
 And the invasion exponent is
\begin{align*}
  \frac{\partial\mathscr I}{\partial r_{0a}} = \lim_{r_{1a}\to r_{0a},a_{1a0b}\to a_{0a0b},a_{1a0a}\to a_{0a0a},X_{1a}\to0}1\\
  \frac{\partial\mathscr I}{\partial a_{0a0b}} = \lim_{r_{1a}\to r_{0a},a_{1a0b}\to a_{0a0b},a_{1a0a}\to a_{0a0a},X_{1a}\to0}X_{0b}\\
  \frac{\partial\mathscr I}{\partial a_{0a0a}} = \lim_{r_{1a}\to r_{0a},a_{1a0b}\to a_{0a0b},a_{1a0a}\to a_{0a0a},X_{1a}\to0}X_{0a} .
\end{align*}
 Which comes out to
\begin{align*}
  \frac{\partial\mathscr I}{\partial r_{0a}} = 1\\
  \frac{\partial\mathscr I}{\partial a_{0a0b}} = X_{0b}\\
  \frac{\partial\mathscr I}{\partial a_{0a0a}} = X_{0a} .
\end{align*}
 \[ \mathbf S \left(\begin{array}{c}
  a_{0b0b}\\
  a_{0b0a}\\
  r_{0b}\\
  r_{0a}\\
  a_{0a0b}\\
  a_{0a0a}
\end{array}\right) = \left(\begin{array}{c}
  \hat{X}_{0b}\\
  \hat{X}_{0a}\\
  1\\
  1\\
  \hat{X}_{0b}\\
  \hat{X}_{0a}
\end{array}\right) \]
 Equilibrium of the population dynamics: 
\[ \begin{align*}
  X_{0b} &\to \hat{X}_{0b} \\
  X_{0a} &\to \hat{X}_{0a}
\end{align*} \]
 The adaptive dynamics comes out to 
\[ \iflatexml
\begin{align*}
\frac{da_{0a0a}}{dt} &= \hat{X}_{0a}^{2} \gamma\\
\frac{da_{0a0b}}{dt} &= \hat{X}_{0a} \hat{X}_{0b} \gamma\\
\frac{da_{0b0b}}{dt} &= \hat{X}_{0b}^{2} \gamma\\
\frac{dr_{0b}}{dt} &= \hat{X}_{0b} \gamma\\
\frac{dr_{0a}}{dt} &= \hat{X}_{0a} \gamma\\
\frac{da_{0b0a}}{dt} &= \hat{X}_{0a} \hat{X}_{0b} \gamma
\end{align*}
\else
\begin{dgroup*}
\begin{dmath*}
\frac{da_{0a0a}}{dt} = \hat{X}_{0a}^{2} \gamma\end{dmath*}
\begin{dmath*}
\frac{da_{0a0b}}{dt} = \hat{X}_{0a} \hat{X}_{0b} \gamma\end{dmath*}
\begin{dmath*}
\frac{da_{0b0b}}{dt} = \hat{X}_{0b}^{2} \gamma\end{dmath*}
\begin{dmath*}
\frac{dr_{0b}}{dt} = \hat{X}_{0b} \gamma\end{dmath*}
\begin{dmath*}
\frac{dr_{0a}}{dt} = \hat{X}_{0a} \gamma\end{dmath*}
\begin{dmath*}
\frac{da_{0b0a}}{dt} = \hat{X}_{0a} \hat{X}_{0b} \gamma
\end{dmath*}
\end{dgroup*}
\fi
 \]

make LV evolution bindings
A: (0, 0)
S: (0.215524554425557, 0.215524554425557)
D: (0, 0)
D: (0, 0)
I: (0, 0)
I: (0, 0)
dAdt: (0, 0)
A: (2.51640299900018, -2.79600333222242)
S: (0.397392627650389, 0.215524554425557)
D: (324/625*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, 16/25*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
D: (0.000442520529670506, 0.000546321641568526)
I: (-72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, -72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
I: (-0.000491689477411673, -0.000491689477411673)
dAdt: (-0.0000491689477411673, 0.0000546321641568525)
A: (-2.79600333222242, 2.51640299900018)
S: (0.215524554425557, 0.397392627650389)
D: (16/25*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, 324/625*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
D: (0.000546321641568526, 0.000442520529670506)
I: (-72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, -72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
I: (-0.000491689477411673, -0.000491689477411673)
dAdt: (0.0000546321641568525, -0.0000491689477411673)
A: (-1, -1)
S: (0.397392627650389, 0.397392627650389)
D: (0, 0)
D: (0, 0)
I: (0, 0)
I: (0, 0)
dAdt: (0, 0)
A: (0, 0)
S: (0.215524554425557, 0.215524554425557)
D: (0, 0)
D: (0, 0)
I: (0, 0)
I: (0, 0)
dAdt: (0, 0)
A: (2.51640299900018, -2.79600333222242)
S: (0.397392627650389, 0.215524554425557)
D: (324/625*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, 16/25*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
D: (0.000442520529670506, 0.000546321641568526)
I: (-72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, -72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
I: (-0.000491689477411673, -0.000491689477411673)
dAdt: (-0.0000491689477411673, 0.0000546321641568525)
A: (-2.79600333222242, 2.51640299900018)
S: (0.215524554425557, 0.397392627650389)
D: (16/25*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, 324/625*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
D: (0.000546321641568526, 0.000442520529670506)
I: (-72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2, -72/125*Xhat_0_a*Xhat_0_b*gamma*sin(-u_0_a + u_0_b)^2)
I: (-0.000491689477411673, -0.000491689477411673)
dAdt: (0.0000546321641568525, -0.0000491689477411673)
A: (-1, -1)
S: (0.397392627650389, 0.397392627650389)
D: (0, 0)
D: (0, 0)
I: (0, 0)
I: (0, 0)
dAdt: (0, 0)
