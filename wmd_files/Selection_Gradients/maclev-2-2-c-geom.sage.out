ad bindings: {w_1 -> 1, b_3 -> 1, r_1 -> 1, Rhat_0 -> -Xhat_0*c_0_0 - Xhat_1*c_1_0 + 2, m_0 -> 1, R_0 -> -X_0*c_0_0 - X_1*c_1_0 + 2, b_0 -> 1, m_1 -> 1, m_3 -> 1, gamma -> 1, w_0 -> 1, b_2 -> 1, Rhat_1 -> -Xhat_0*c_0_1 - Xhat_1*c_1_1 + 2, b_1 -> 1, K_0 -> 2, r_0 -> 1, K_1 -> 2, m_2 -> 1, R_1 -> -X_0*c_0_1 - X_1*c_1_1 + 2}
model bindings: {R_0 -> -(X_0*c_0_0 + X_1*c_1_0 - K_0*r_0)/r_0, Rhat_1 -> -(Xhat_0*c_0_1 + Xhat_1*c_1_1 - K_1*r_1)/r_1, Rhat_0 -> -(Xhat_0*c_0_0 + Xhat_1*c_1_0 - K_0*r_0)/r_0, R_1 -> -(X_0*c_0_1 + X_1*c_1_1 - K_1*r_1)/r_1}
_early_bindings: {}
_late_bindings: {gamma -> 1, b_3 -> 1, r_1 -> 1, m_0 -> 1, m_3 -> 1, m_1 -> 1, b_0 -> 1, w_1 -> 1, w_0 -> 1, b_2 -> 1, b_1 -> 1, K_0 -> 2, r_0 -> 1, K_1 -> 2, m_2 -> 1}
make LV model
Inferring LV coefficients from X_0 equation: K_0*X_0*b_0*c_0_0*w_0 - X_0^2*b_0*c_0_0^2*w_0/r_0 - X_0*X_1*b_0*c_0_0*c_1_0*w_0/r_0 + K_1*X_0*b_0*c_0_1*w_1 - X_0^2*b_0*c_0_1^2*w_1/r_1 - X_0*X_1*b_0*c_0_1*c_1_1*w_1/r_1 - X_0*b_0*m_0
a_0_1 : -b_0*c_0_0*c_1_0*w_0/r_0 - b_0*c_0_1*c_1_1*w_1/r_1
k_0 : K_0*b_0*c_0_0*w_0 + K_1*b_0*c_0_1*w_1 - b_0*m_0
Inferring LV coefficients from X_1 equation: K_0*X_1*b_1*c_1_0*w_0 - X_0*X_1*b_1*c_0_0*c_1_0*w_0/r_0 - X_1^2*b_1*c_1_0^2*w_0/r_0 + K_1*X_1*b_1*c_1_1*w_1 - X_0*X_1*b_1*c_0_1*c_1_1*w_1/r_1 - X_1^2*b_1*c_1_1^2*w_1/r_1 - X_1*b_1*m_1
a_1_0 : -b_1*c_0_0*c_1_0*w_0/r_0 - b_1*c_0_1*c_1_1*w_1/r_1
k_1 : K_0*b_1*c_1_0*w_0 + K_1*b_1*c_1_1*w_1 - b_1*m_1
_A_bindings: {a_1_1 -> -b_1*c_1_0^2*w_0/r_0 - b_1*c_1_1^2*w_1/r_1, a_0_0 -> -b_0*c_0_0^2*w_0/r_0 - b_0*c_0_1^2*w_1/r_1, k_1 -> K_0*b_1*c_1_0*w_0 + K_1*b_1*c_1_1*w_1 - b_1*m_1, k_0 -> K_0*b_0*c_0_0*w_0 + K_1*b_0*c_0_1*w_1 - b_0*m_0, a_1_0 -> -b_1*c_0_0*c_1_0*w_0/r_0 - b_1*c_0_1*c_1_1*w_1/r_1, a_0_1 -> -b_0*c_0_0*c_1_0*w_0/r_0 - b_0*c_0_1*c_1_1*w_1/r_1}
Inferring LV coefficients from X_0 equation: K_0*X_0*b_0*c_0_0*w_0 - X_0^2*b_0*c_0_0^2*w_0/r_0 - X_0*X_1*b_0*c_0_0*c_1_0*w_0/r_0 - X_0*X_2*b_0*c_0_0*c_2_0*w_0/r_0 + K_1*X_0*b_0*c_0_1*w_1 - X_0^2*b_0*c_0_1^2*w_1/r_1 - X_0*X_1*b_0*c_0_1*c_1_1*w_1/r_1 - X_0*X_2*b_0*c_0_1*c_2_1*w_1/r_1 - X_0*b_0*m_0
a_0_1 : -b_0*c_0_0*c_1_0*w_0/r_0 - b_0*c_0_1*c_1_1*w_1/r_1
a_0_2 : -b_0*c_0_0*c_2_0*w_0/r_0 - b_0*c_0_1*c_2_1*w_1/r_1
k_0 : K_0*b_0*c_0_0*w_0 + K_1*b_0*c_0_1*w_1 - b_0*m_0
Inferring LV coefficients from X_1 equation: K_0*X_1*b_1*c_1_0*w_0 - X_0*X_1*b_1*c_0_0*c_1_0*w_0/r_0 - X_1^2*b_1*c_1_0^2*w_0/r_0 - X_1*X_2*b_1*c_1_0*c_2_0*w_0/r_0 + K_1*X_1*b_1*c_1_1*w_1 - X_0*X_1*b_1*c_0_1*c_1_1*w_1/r_1 - X_1^2*b_1*c_1_1^2*w_1/r_1 - X_1*X_2*b_1*c_1_1*c_2_1*w_1/r_1 - X_1*b_1*m_1
a_1_0 : -b_1*c_0_0*c_1_0*w_0/r_0 - b_1*c_0_1*c_1_1*w_1/r_1
a_1_2 : -b_1*c_1_0*c_2_0*w_0/r_0 - b_1*c_1_1*c_2_1*w_1/r_1
k_1 : K_0*b_1*c_1_0*w_0 + K_1*b_1*c_1_1*w_1 - b_1*m_1
Inferring LV coefficients from X_2 equation: K_0*X_2*b_2*c_2_0*w_0 - X_0*X_2*b_2*c_0_0*c_2_0*w_0/r_0 - X_1*X_2*b_2*c_1_0*c_2_0*w_0/r_0 - X_2^2*b_2*c_2_0^2*w_0/r_0 + K_1*X_2*b_2*c_2_1*w_1 - X_0*X_2*b_2*c_0_1*c_2_1*w_1/r_1 - X_1*X_2*b_2*c_1_1*c_2_1*w_1/r_1 - X_2^2*b_2*c_2_1^2*w_1/r_1 - X_2*b_2*m_2
a_2_0 : -b_2*c_0_0*c_2_0*w_0/r_0 - b_2*c_0_1*c_2_1*w_1/r_1
a_2_1 : -b_2*c_1_0*c_2_0*w_0/r_0 - b_2*c_1_1*c_2_1*w_1/r_1
k_2 : K_0*b_2*c_2_0*w_0 + K_1*b_2*c_2_1*w_1 - b_2*m_2
a_to_u_bindings: {a_2_0 -> -c_0_0*c_2_0 - c_0_1*c_2_1, r_1 -> 1, k_0 -> 2*c_0_0 + 2*c_0_1 - 1, m_0 -> 1, R_0 -> -X_0*c_0_0 - X_1*c_1_0 + 2, K_0 -> 2, m_1 -> 1, b_0 -> 1, a_0_1 -> -c_0_0*c_1_0 - c_0_1*c_1_1, a_1_0 -> -c_0_0*c_1_0 - c_0_1*c_1_1, a_1_1 -> -c_1_0^2 - c_1_1^2, w_0 -> 1, Rhat_1 -> -Xhat_0*c_0_1 - Xhat_1*c_1_1 + 2, b_1 -> 1, K_1 -> 2, m_2 -> 1, R_1 -> -X_0*c_0_1 - X_1*c_1_1 + 2, w_1 -> 1, b_3 -> 1, Rhat_0 -> -Xhat_0*c_0_0 - Xhat_1*c_1_0 + 2, a_2_2 -> -c_2_0^2 - c_2_1^2, k_2 -> 2*c_2_0 + 2*c_2_1 - 1, m_3 -> 1, a_0_0 -> -c_0_0^2 - c_0_1^2, gamma -> 1, a_0_2 -> -c_0_0*c_2_0 - c_0_1*c_2_1, b_2 -> 1, a_2_1 -> -c_1_0*c_2_0 - c_1_1*c_2_1, r_0 -> 1, a_1_2 -> -c_1_0*c_2_0 - c_1_1*c_2_1, k_1 -> 2*c_1_0 + 2*c_1_1 - 1}
a_func: (c_0_0, c_0_1, c_2_0, c_2_1) |--> -c_0_0*c_2_0 - c_0_1*c_2_1
r_func: (c_0_0, c_0_1) |--> 2*c_0_0 + 2*c_0_1 - 1
make LV adaptive dynamics
The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{2}}\frac{dX_{2}}{dt} &= X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2} 
\end{align*}

limit as {a_2_1: a_0_1, k_2: k_0, a_2_0: a_0_0}
after those limits:
   1
  X_0
  X_1
                                       1
limit as                                  _SAGE_VAR_X_2 -> 0
 -->                                        1
The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{2}}\frac{dX_{2}}{dt} &= X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2} 
\end{align*}

limit as {a_2_1: a_1_1, k_2: k_1, a_2_0: a_1_0}
after those limits:
   1
  X_0
  X_1
                                       1
limit as                                  _SAGE_VAR_X_2 -> 0
 -->                                        1
Original pop-dyn system: 
\[\begin{align*}
\frac{dX_{0}}{dt} &= {\left(X_{0} a_{00} + X_{1} a_{01} + k_{0}\right)} X_{0}\\
\frac{dX_{1}}{dt} &= {\left(X_{0} a_{10} + X_{1} a_{11} + k_{1}\right)} X_{1}
\end{align*}\]
Extended pop-dyn system: 
\[\begin{align*}
\frac{dX_{0}}{dt} &= {\left(X_{0} a_{00} + X_{1} a_{01} + X_{2} a_{02} + k_{0}\right)} X_{0}\\
\frac{dX_{1}}{dt} &= {\left(X_{0} a_{10} + X_{1} a_{11} + X_{2} a_{12} + k_{1}\right)} X_{1}\\
\frac{dX_{2}}{dt} &= {\left(X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2}\right)} X_{2}
\end{align*}\]
 The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{2}}\frac{dX_{2}}{dt} &= X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2} 
\end{align*}
 And the invasion exponent is
\begin{align*}
  \frac{\partial\mathscr I}{\partial k_{0}} = \lim_{k_{2}\to k_{0},a_{20}\to a_{00},a_{21}\to a_{01},X_{2}\to0}1\\
  \frac{\partial\mathscr I}{\partial a_{00}} = \lim_{k_{2}\to k_{0},a_{20}\to a_{00},a_{21}\to a_{01},X_{2}\to0}X_{0}\\
  \frac{\partial\mathscr I}{\partial a_{01}} = \lim_{k_{2}\to k_{0},a_{20}\to a_{00},a_{21}\to a_{01},X_{2}\to0}X_{1} .
\end{align*}
 Which comes out to
\begin{align*}
  \frac{\partial\mathscr I}{\partial k_{0}} = 1\\
  \frac{\partial\mathscr I}{\partial a_{00}} = X_{0}\\
  \frac{\partial\mathscr I}{\partial a_{01}} = X_{1} .
\end{align*}
 Original pop-dyn system: 
\[ \begin{align*}
\frac{dX_{0}}{dt} &= {\left(X_{0} a_{00} + X_{1} a_{01} + k_{0}\right)} X_{0}\\
\frac{dX_{1}}{dt} &= {\left(X_{0} a_{10} + X_{1} a_{11} + k_{1}\right)} X_{1}
\end{align*} \]
 Extended pop-dyn system: 
\[ \begin{align*}
\frac{dX_{0}}{dt} &= {\left(X_{0} a_{00} + X_{1} a_{01} + X_{2} a_{02} + k_{0}\right)} X_{0}\\
\frac{dX_{1}}{dt} &= {\left(X_{0} a_{10} + X_{1} a_{11} + X_{2} a_{12} + k_{1}\right)} X_{1}\\
\frac{dX_{2}}{dt} &= {\left(X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2}\right)} X_{2}
\end{align*} \]
 The invasion rate for mutant population is:
\begin{align*}
  \mathscr I = \frac{1}{X_{2}}\frac{dX_{2}}{dt} &= X_{0} a_{20} + X_{1} a_{21} + X_{2} a_{22} + k_{2} 
\end{align*}
 And the invasion exponent is
\begin{align*}
  \frac{\partial\mathscr I}{\partial k_{1}} = \lim_{k_{2}\to k_{1},a_{20}\to a_{10},a_{21}\to a_{11},X_{2}\to0}1\\
  \frac{\partial\mathscr I}{\partial a_{10}} = \lim_{k_{2}\to k_{1},a_{20}\to a_{10},a_{21}\to a_{11},X_{2}\to0}X_{0}\\
  \frac{\partial\mathscr I}{\partial a_{11}} = \lim_{k_{2}\to k_{1},a_{20}\to a_{10},a_{21}\to a_{11},X_{2}\to0}X_{1} .
\end{align*}
 Which comes out to
\begin{align*}
  \frac{\partial\mathscr I}{\partial k_{1}} = 1\\
  \frac{\partial\mathscr I}{\partial a_{10}} = X_{0}\\
  \frac{\partial\mathscr I}{\partial a_{11}} = X_{1} .
\end{align*}
 \[ \mathbf S \left(\begin{array}{c}
  a_{11}\\
  a_{00}\\
  k_{1}\\
  k_{0}\\
  a_{10}\\
  a_{01}
\end{array}\right) = \left(\begin{array}{c}
  \hat{X}_{1}\\
  \hat{X}_{0}\\
  1\\
  1\\
  \hat{X}_{0}\\
  \hat{X}_{1}
\end{array}\right) \]
 Equilibrium of the population dynamics: 
\[ \begin{align*}
  X_{1} &\to \hat{X}_{1} \\
  X_{0} &\to \hat{X}_{0}
\end{align*} \]
 The adaptive dynamics comes out to 
\[ \begin{align*}
\frac{da_{10}}{dt} &= \hat{X}_{0} \hat{X}_{1} \gamma\\
\frac{da_{01}}{dt} &= \hat{X}_{0} \hat{X}_{1} \gamma\\
\frac{da_{11}}{dt} &= \hat{X}_{1}^{2} \gamma\\
\frac{da_{00}}{dt} &= \hat{X}_{0}^{2} \gamma\\
\frac{dk_{1}}{dt} &= \hat{X}_{1} \gamma\\
\frac{dk_{0}}{dt} &= \hat{X}_{0} \gamma
\end{align*} \]

make LV evolution bindings
dudts: {0: (-Xhat_0^2*c_0_0*gamma - Xhat_0*Xhat_1*c_1_0*gamma + 2*Xhat_0*gamma, -Xhat_0^2*c_0_1*gamma - Xhat_0*Xhat_1*c_1_1*gamma + 2*Xhat_0*gamma), 1: (-Xhat_0*Xhat_1*c_0_0*gamma - Xhat_1^2*c_1_0*gamma + 2*Xhat_1*gamma, -Xhat_0*Xhat_1*c_0_1*gamma - Xhat_1^2*c_1_1*gamma + 2*Xhat_1*gamma)}
printing things in LaTeX
plot k vs. t
k_0: 2*c_0_0 + 2*c_0_1 - 1
k_1: 2*c_1_0 + 2*c_1_1 - 1
plot a vs. t
plot X vs. t
plot R vs. t
plot a vs. a
plot a vs. a with arrows
